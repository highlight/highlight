# CLIENT GRAPH

scalar Any
scalar Timestamp
scalar Int64

type Session {
    id: ID!
    secure_id: String!
    organization_id: ID!
    project_id: ID!
}

input StackFrameInput {
    functionName: String
    args: [Any]
    fileName: String
    lineNumber: Int
    columnNumber: Int
    isEval: Boolean
    isNative: Boolean
    source: String
}

input ErrorObjectInput {
    event: String!
    type: String!
    url: String!
    source: String!
    lineNumber: Int!
    columnNumber: Int!
    stackTrace: [StackFrameInput]!
    timestamp: Timestamp!
    payload: String
}

input BackendErrorObjectInput {
    session_secure_id: String!
    request_id: String!
    event: String!
    type: String!
    url: String!
    source: String!
    stackTrace: String!
    timestamp: Timestamp!
    payload: String
}

enum MetricType {
    WebVital
    Device
    Backend
}

input MetricInput {
    session_secure_id: String!
    name: String!
    value: Float!
    type: MetricType!
    url: String!
    timestamp: Timestamp!
    request_id: String
}

input DeviceMetricInput {
    name: String!
    value: Float!
}

input ReplayEventInput {
    type: Int!
    timestamp: Float!
    _sid: Float!
    data: Any!
}

input ReplayEventsInput {
    events: [ReplayEventInput]!
}

type Mutation {
    initializeSession(
        organization_verbose_id: String!
        enable_strict_privacy: Boolean!
        enable_recording_network_contents: Boolean!
        clientVersion: String!
        firstloadVersion: String!
        clientConfig: String!
        environment: String!
        appVersion: String
        fingerprint: String!
        session_secure_id: String
    ): Session
    identifySession(
        session_id: ID!
        user_identifier: String!
        user_object: Any
    ): ID
    addTrackProperties(session_id: ID!, properties_object: Any): ID
    addSessionProperties(session_id: ID!, properties_object: Any): ID
    pushPayload(
        session_id: ID!
        events: ReplayEventsInput!
        messages: String!
        resources: String!
        errors: [ErrorObjectInput]!
        is_beacon: Boolean
        has_session_unloaded: Boolean
        highlight_logs: String
    ): Int!
    pushBackendPayload(errors: [BackendErrorObjectInput]!): Any
    pushMetrics(metrics: [MetricInput]!): ID!
    markBackendSetup(session_secure_id: String!): ID!
    addSessionFeedback(
        session_id: ID!
        user_name: String
        user_email: String
        verbatim: String!
        timestamp: Timestamp!
    ): ID!
    # TODO(vkorolik) deprecate as clients migrate to pushMetrics
    addWebVitals(session_id: ID!, metric: WebVitalMetricInput!): ID!
    addDeviceMetric(session_id: ID!, metric: DeviceMetricInput!): ID!
}

# TODO(vkorolik) deprecate as clients migrate to pushMetrics
input WebVitalMetricInput {
    name: String!
    value: Float!
}

type Query {
    ignore(id: ID!): Any
}
