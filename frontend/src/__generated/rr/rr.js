var Vn=Object.defineProperty;var hi=(t,e)=>{for(var r in e)Vn(t,r,{get:e[r],enumerable:!0})};var O;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(O||(O={}));function Ii(t){return t.nodeType===t.ELEMENT_NODE}function je(t){var e=t?.host;return e?.shadowRoot===t}function ze(t){return Object.prototype.toString.call(t)==="[object ShadowRoot]"}function Gn(t){return t.includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t}function cr(t){try{var e=t.rules||t.cssRules;return e?Gn(Array.from(e).map(hr).join("")):null}catch{return null}}function hr(t){var e=t.cssText;if(Hn(t))try{e=cr(t.styleSheet)||e}catch{}return e}function Hn(t){return"styleSheet"in t}var fr=function(){function t(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return t.prototype.getId=function(e){var r;if(!e)return-1;var i=(r=this.getMeta(e))===null||r===void 0?void 0:r.id;return i??-1},t.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},t.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},t.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},t.prototype.removeNodeFromMap=function(e){var r=this,i=this.getId(e);this.idNodeMap.delete(i),e.childNodes&&e.childNodes.forEach(function(n){return r.removeNodeFromMap(n)})},t.prototype.has=function(e){return this.idNodeMap.has(e)},t.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},t.prototype.add=function(e,r){var i=r.id;this.idNodeMap.set(i,e),this.nodeMetaMap.set(e,r)},t.prototype.replace=function(e,r){var i=this.getNode(e);if(i){var n=this.nodeMetaMap.get(i);n&&this.nodeMetaMap.set(r,n)}this.idNodeMap.set(e,r)},t.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},t}();function _t(){return new fr}function lt(t){var e=t.maskInputOptions,r=t.tagName,i=t.type,n=t.value,s=t.maskInputFn,o=n||"",a=i&&i.toLowerCase();return(e[r.toLowerCase()]||a&&e[a])&&(s?o=s(o):o="*".repeat(o.length)),o}var fi="__rrweb_original__";function Yn(t){var e=t.getContext("2d");if(!e)return!0;for(var r=50,i=0;i<t.width;i+=r)for(var n=0;n<t.height;n+=r){var s=e.getImageData,o=fi in s?s[fi]:s,a=new Uint32Array(o.call(e,i,n,Math.min(r,t.width-i),Math.min(r,t.height-n)).data.buffer);if(a.some(function(l){return l!==0}))return!1}return!0}function Zn(t,e){return!t||!e||t.type!==e.type?!1:t.type===O.Document?t.compatMode===e.compatMode:t.type===O.DocumentType?t.name===e.name&&t.publicId===e.publicId&&t.systemId===e.systemId:t.type===O.Comment||t.type===O.Text||t.type===O.CDATA?t.textContent===e.textContent:t.type===O.Element?t.tagName===e.tagName&&JSON.stringify(t.attributes)===JSON.stringify(e.attributes)&&t.isSVG===e.isSVG&&t.needBlock===e.needBlock:!1}function ct(t){var e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?e.toLowerCase():null}function dt(t){return t=t.replace(/[^ -~]+/g,""),t=t?.split(" ").map(function(e){return Math.random().toString(20).substr(2,e.length)}).join(" ")||"",t}function dr(t){return t==="img"||t==="video"||t==="audio"||t==="source"}var zn=1,Kn=new RegExp("[^a-z0-9-_:]"),Ke=-2;function pr(){return zn++}function jn(t){if(t instanceof HTMLFormElement)return"form";var e=t.tagName.toLowerCase().trim();return Kn.test(e)?"div":e}function Xn(t){return t.cssRules?Array.from(t.cssRules).map(function(e){return e.cssText||""}).join(""):""}function qn(t){var e="";return t.indexOf("//")>-1?e=t.split("/").slice(0,3).join("/"):e=t.split("/")[0],e=e.split("?")[0],e}var et,pi,Qn=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Jn=/^(?:[a-z+]+:)?\/\//i,$n=/^www\..*/i,es=/^(data:)([^,]*),(.*)/i;function Mt(t,e){return(t||"").replace(Qn,function(r,i,n,s,o,a){var l=n||o||a,c=i||s||"";if(!l)return r;if(Jn.test(l)||$n.test(l)||es.test(l))return"url(".concat(c).concat(l).concat(c,")");if(l[0]==="/")return"url(".concat(c).concat(qn(e)+l).concat(c,")");var d=e.split("/"),u=l.split("/");d.pop();for(var h=0,f=u;h<f.length;h++){var p=f[h];p!=="."&&(p===".."?d.pop():d.push(p))}return"url(".concat(c).concat(d.join("/")).concat(c,")")})}var ts=/^[^ \t\n\r\u000c]+/,rs=/^[, \t\n\r\u000c]+/;function is(t,e){if(e.trim()==="")return e;var r=0;function i(c){var d,u=c.exec(e.substring(r));return u?(d=u[0],r+=d.length,d):""}for(var n=[];i(rs),!(r>=e.length);){var s=i(ts);if(s.slice(-1)===",")s=tt(t,s.substring(0,s.length-1)),n.push(s);else{var o="";s=tt(t,s);for(var a=!1;;){var l=e.charAt(r);if(l===""){n.push((s+o).trim());break}else if(a)l===")"&&(a=!1);else if(l===","){r+=1,n.push((s+o).trim());break}else l==="("&&(a=!0);o+=l,r+=1}}}return n.join(", ")}function tt(t,e){if(!e||e.trim()==="")return e;var r=t.createElement("a");return r.href=e,r.href}function ns(t){return!!(t.tagName==="svg"||t.ownerSVGElement)}function mr(){var t=document.createElement("a");return t.href="",t.href}function gr(t,e,r,i){return i&&(r==="src"||r==="href"&&!(e==="use"&&i[0]==="#")||r==="xlink:href"&&i[0]!=="#"||r==="background"&&(e==="table"||e==="td"||e==="th")?tt(t,i):r==="srcset"?is(t,i):r==="style"?Mt(i,mr()):e==="object"&&r==="data"?tt(t,i):i)}function vr(t,e,r){return(t==="video"||t==="audio")&&e==="autoplay"}function mi(t,e,r){try{if(typeof e=="string"){if(t.classList.contains(e))return!0}else for(var i=t.classList.length;i--;){var n=t.classList[i];if(e.test(n))return!0}if(r)return t.matches(r)}catch{}return!1}function at(t,e,r){if(!t)return!1;if(t.nodeType!==t.ELEMENT_NODE)return r?at(t.parentNode,e,r):!1;for(var i=t.classList.length;i--;){var n=t.classList[i];if(e.test(n))return!0}return r?at(t.parentNode,e,r):!1}function yr(t,e,r){try{var i=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(i===null)return!1;if(typeof e=="string"){if(i.classList.contains(e)||i.closest(".".concat(e)))return!0}else if(at(i,e,!0))return!0;if(r&&(i.matches(r)||i.closest(r)))return!0}catch{}return!1}function ss(t,e,r){var i=t.contentWindow;if(i){var n=!1,s;try{s=i.document.readyState}catch{return}if(s!=="complete"){var o=setTimeout(function(){n||(e(),n=!0)},r);t.addEventListener("load",function(){clearTimeout(o),n=!0,e()});return}var a="about:blank";if(i.location.href!==a||t.src===a||t.src==="")return setTimeout(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}}function os(t,e,r){var i=!1,n;try{n=t.sheet}catch{return}if(!n){var s=setTimeout(function(){i||(e(),i=!0)},r);t.addEventListener("load",function(){clearTimeout(s),i=!0,e()})}}function as(t,e){var r=e.doc,i=e.mirror,n=e.blockClass,s=e.blockSelector,o=e.maskTextClass,a=e.maskTextSelector,l=e.inlineStylesheet,c=e.maskInputOptions,d=c===void 0?{}:c,u=e.maskTextFn,h=e.maskInputFn,f=e.dataURLOptions,p=f===void 0?{}:f,g=e.inlineImages,v=e.recordCanvas,m=e.keepIframeSrcFn,y=e.newlyAddedElement,E=y===void 0?!1:y,S=e.enableStrictPrivacy,A=ls(r,i);switch(t.nodeType){case t.DOCUMENT_NODE:return t.compatMode!=="CSS1Compat"?{type:O.Document,childNodes:[],compatMode:t.compatMode}:{type:O.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:O.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:A};case t.ELEMENT_NODE:return ds(t,{doc:r,blockClass:n,blockSelector:s,inlineStylesheet:l,maskInputOptions:d,maskInputFn:h,maskTextClass:o,dataURLOptions:p,inlineImages:g,recordCanvas:v,keepIframeSrcFn:m,newlyAddedElement:E,enableStrictPrivacy:S,rootId:A});case t.TEXT_NODE:return cs(t,{maskTextClass:o,maskTextSelector:a,maskTextFn:u,enableStrictPrivacy:S,rootId:A});case t.CDATA_SECTION_NODE:return{type:O.CDATA,textContent:"",rootId:A};case t.COMMENT_NODE:return{type:O.Comment,textContent:t.textContent||"",rootId:A};default:return!1}}function ls(t,e){if(e.hasNode(t)){var r=e.getId(t);return r===1?void 0:r}}function cs(t,e){var r,i=e.maskTextClass,n=e.maskTextSelector,s=e.maskTextFn,o=e.enableStrictPrivacy,a=e.rootId,l=t.parentNode&&t.parentNode.tagName,c=t.textContent,d=l==="STYLE"?!0:void 0,u=l==="SCRIPT"?!0:void 0,h=!1;if(d&&c){try{t.nextSibling||t.previousSibling||!((r=t.parentNode.sheet)===null||r===void 0)&&r.cssRules&&(c=Xn(t.parentNode.sheet))}catch(p){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(p),t)}c=Mt(c,mr()),h=!0}if(u?(c="SCRIPT_PLACEHOLDER",h=!0):l==="NOSCRIPT"&&(c="",h=!0),!d&&!u&&c&&yr(t,i,n)&&(c=s?s(c):c.replace(/[\S]/g,"*")),o&&!h&&l){var f=new Set(["HEAD","TITLE","STYLE","SCRIPT","HTML","BODY","NOSCRIPT"]);!f.has(l)&&c&&(c=dt(c))}return{type:O.Text,textContent:c||"",isStyle:d,rootId:a}}function ds(t,e){for(var r=e.doc,i=e.blockClass,n=e.blockSelector,s=e.inlineStylesheet,o=e.maskInputOptions,a=o===void 0?{}:o,l=e.maskInputFn,c=e.maskTextClass,d=e.dataURLOptions,u=d===void 0?{}:d,h=e.inlineImages,f=e.recordCanvas,p=e.keepIframeSrcFn,g=e.newlyAddedElement,v=g===void 0?!1:g,m=e.enableStrictPrivacy,y=e.rootId,E=mi(t,i,n),S=mi(t,c,null),A=jn(t),C={},T=t.attributes.length,b=0;b<T;b++){var x=t.attributes[b];vr(A,x.name,x.value)||(C[x.name]=gr(r,A,x.name,x.value))}if(A==="link"&&s){var L=Array.from(r.styleSheets).find(function(ce){return ce.href===t.href}),P=null;L&&(P=cr(L)),P&&(delete C.rel,delete C.href,C._cssText=Mt(P,L.href))}if(A==="style"&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){var P=cr(t.sheet);P&&(C._cssText=Mt(P,mr()))}if(A==="input"||A==="textarea"||A==="select"){var Z=t.value,G=t.checked;if(C.type!=="radio"&&C.type!=="checkbox"&&C.type!=="submit"&&C.type!=="button"&&Z){var V=ct(t);C.value=lt({type:V,tagName:A,value:Z,maskInputOptions:a,maskInputFn:l})}else G&&(C.checked=G)}if(A==="option"&&(t.selected&&!a.select?C.selected=!0:delete C.selected),A==="canvas"&&f){if(t.__context==="2d")Yn(t)||(C.rr_dataURL=t.toDataURL(u.type,u.quality));else if(!("__context"in t)){var D=t.toDataURL(u.type,u.quality),F=document.createElement("canvas");F.width=t.width,F.height=t.height;var H=F.toDataURL(u.type,u.quality);D!==H&&(C.rr_dataURL=D)}}if(A==="img"&&h&&!E&&!S&&!m){et||(et=r.createElement("canvas"),pi=et.getContext("2d"));var B=t,w=B.crossOrigin;B.crossOrigin="anonymous";var I=function(){B.removeEventListener("load",I);try{et.width=B.naturalWidth,et.height=B.naturalHeight,pi.drawImage(B,0,0),C.rr_dataURL=et.toDataURL(u.type,u.quality)}catch(ce){console.warn("Cannot inline img src=".concat(B.currentSrc,"! Error: ").concat(ce))}w?C.crossOrigin=w:B.removeAttribute("crossorigin")};B.complete&&B.naturalWidth!==0?I():B.addEventListener("load",I)}if((A==="audio"||A==="video")&&(C.rr_mediaState=t.paused?"paused":"played",C.rr_mediaCurrentTime=t.currentTime),v||(t.scrollLeft&&(C.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(C.rr_scrollTop=t.scrollTop)),E||S||m&&dr(A)){var M=t.getBoundingClientRect(),k=M.width,_=M.height;C={class:C.class,rr_width:"".concat(k,"px"),rr_height:"".concat(_,"px")}}if(m&&dr(A)&&(E=!0),A==="iframe"&&!p(C.src)&&(t.contentDocument||(C.rr_src=C.src),delete C.src),h&&A==="video"){var X=t;if(X.src===""||X.src.indexOf("blob:")!==-1){var q=t.getBoundingClientRect(),k=q.width,_=q.height;C={rr_width:"".concat(k,"px"),rr_height:"".concat(_,"px"),rr_inlined_video:!0},A="canvas"}}return{type:O.Element,tagName:A,attributes:C,childNodes:[],isSVG:ns(t)||void 0,needBlock:E,needMask:S,rootId:y}}function Q(t){return t==null?"":t.toLowerCase()}function us(t,e){if(e.comment&&t.type===O.Comment)return!0;if(t.type===O.Element){if(e.script&&(t.tagName==="script"||t.tagName==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||t.tagName==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&t.attributes.href.endsWith(".js")))return!0;if(e.headFavicon&&(t.tagName==="link"&&t.attributes.rel==="shortcut icon"||t.tagName==="meta"&&(Q(t.attributes.name).match(/^msapplication-tile(image|color)$/)||Q(t.attributes.name)==="application-name"||Q(t.attributes.rel)==="icon"||Q(t.attributes.rel)==="apple-touch-icon"||Q(t.attributes.rel)==="shortcut icon")))return!0;if(t.tagName==="meta"){if(e.headMetaDescKeywords&&Q(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(Q(t.attributes.property).match(/^(og|twitter|fb):/)||Q(t.attributes.name).match(/^(og|twitter):/)||Q(t.attributes.name)==="pinterest"))return!0;if(e.headMetaRobots&&(Q(t.attributes.name)==="robots"||Q(t.attributes.name)==="googlebot"||Q(t.attributes.name)==="bingbot"))return!0;if(e.headMetaHttpEquiv&&t.attributes["http-equiv"]!==void 0)return!0;if(e.headMetaAuthorship&&(Q(t.attributes.name)==="author"||Q(t.attributes.name)==="generator"||Q(t.attributes.name)==="framework"||Q(t.attributes.name)==="publisher"||Q(t.attributes.name)==="progid"||Q(t.attributes.property).match(/^article:/)||Q(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&(Q(t.attributes.name)==="google-site-verification"||Q(t.attributes.name)==="yandex-verification"||Q(t.attributes.name)==="csrf-token"||Q(t.attributes.name)==="p:domain_verify"||Q(t.attributes.name)==="verify-v1"||Q(t.attributes.name)==="verification"||Q(t.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function Ze(t,e){var r=e.doc,i=e.mirror,n=e.blockClass,s=e.blockSelector,o=e.maskTextClass,a=e.maskTextSelector,l=e.skipChild,c=l===void 0?!1:l,d=e.inlineStylesheet,u=d===void 0?!0:d,h=e.maskInputOptions,f=h===void 0?{}:h,p=e.maskTextFn,g=e.maskInputFn,v=e.slimDOMOptions,m=e.dataURLOptions,y=m===void 0?{}:m,E=e.inlineImages,S=E===void 0?!1:E,A=e.recordCanvas,C=A===void 0?!1:A,T=e.onSerialize,b=e.onIframeLoad,x=e.iframeLoadTimeout,L=x===void 0?5e3:x,P=e.onStylesheetLoad,Z=e.stylesheetLoadTimeout,G=Z===void 0?5e3:Z,V=e.keepIframeSrcFn,D=V===void 0?function(){return!1}:V,F=e.newlyAddedElement,H=F===void 0?!1:F,B=e.enableStrictPrivacy,w=e.preserveWhiteSpace,I=w===void 0?!0:w,M=as(t,{doc:r,mirror:i,blockClass:n,blockSelector:s,maskTextClass:o,maskTextSelector:a,inlineStylesheet:u,maskInputOptions:f,maskTextFn:p,maskInputFn:g,dataURLOptions:y,inlineImages:S,recordCanvas:C,keepIframeSrcFn:D,newlyAddedElement:H,enableStrictPrivacy:B});if(!M)return console.warn(t,"not serialized"),null;var k;i.hasNode(t)?k=i.getId(t):us(M,v)||!I&&M.type===O.Text&&!M.isStyle&&!M.textContent.replace(/^\s+|\s+$/gm,"").length?k=Ke:k=pr();var _=Object.assign(M,{id:k});if(i.add(t,_),k===Ke)return null;T&&T(t);var X=!c,q=B;if(_.type===O.Element){if(X=X&&!_.needBlock,q=B||!!_.needBlock||!!_.needMask,q&&dr(_.tagName)){var ce=t.cloneNode();ce.src="",i.add(ce,_)}delete _.needBlock,delete _.needMask;var ve=t.shadowRoot;ve&&ze(ve)&&(_.isShadowHost=!0)}if((_.type===O.Document||_.type===O.Element)&&X){v.headWhitespace&&_.type===O.Element&&_.tagName==="head"&&(I=!1);for(var fe={doc:r,mirror:i,blockClass:n,blockSelector:s,maskTextClass:o,maskTextSelector:a,skipChild:c,inlineStylesheet:u,maskInputOptions:f,maskTextFn:p,maskInputFn:g,slimDOMOptions:v,dataURLOptions:y,inlineImages:S,recordCanvas:C,preserveWhiteSpace:I,onSerialize:T,onIframeLoad:b,iframeLoadTimeout:L,onStylesheetLoad:P,stylesheetLoadTimeout:G,keepIframeSrcFn:D,enableStrictPrivacy:q},xe=0,Le=Array.from(t.childNodes);xe<Le.length;xe++){var Fe=Le[xe],oe=Ze(Fe,fe);oe&&_.childNodes.push(oe)}if(Ii(t)&&t.shadowRoot)for(var ye=0,Te=Array.from(t.shadowRoot.childNodes);ye<Te.length;ye++){var Fe=Te[ye],oe=Ze(Fe,fe);oe&&(ze(t.shadowRoot)&&(oe.isShadow=!0),_.childNodes.push(oe))}}return t.parentNode&&je(t.parentNode)&&ze(t.parentNode)&&(_.isShadow=!0),_.type===O.Element&&_.tagName==="iframe"&&ss(t,function(){var Ie=t.contentDocument;if(Ie&&b){var U=Ze(Ie,{doc:Ie,mirror:i,blockClass:n,blockSelector:s,maskTextClass:o,maskTextSelector:a,skipChild:!1,inlineStylesheet:u,maskInputOptions:f,maskTextFn:p,maskInputFn:g,slimDOMOptions:v,dataURLOptions:y,inlineImages:S,recordCanvas:C,preserveWhiteSpace:I,onSerialize:T,onIframeLoad:b,iframeLoadTimeout:L,onStylesheetLoad:P,stylesheetLoadTimeout:G,keepIframeSrcFn:D,enableStrictPrivacy:B});U&&b(t,U)}},L),_.type===O.Element&&_.tagName==="link"&&_.attributes.rel==="stylesheet"&&os(t,function(){if(P){var Ie=Ze(t,{doc:r,mirror:i,blockClass:n,blockSelector:s,maskTextClass:o,maskTextSelector:a,skipChild:!1,inlineStylesheet:u,maskInputOptions:f,maskTextFn:p,maskInputFn:g,slimDOMOptions:v,dataURLOptions:y,inlineImages:S,recordCanvas:C,preserveWhiteSpace:I,onSerialize:T,onIframeLoad:b,iframeLoadTimeout:L,onStylesheetLoad:P,stylesheetLoadTimeout:G,keepIframeSrcFn:D,enableStrictPrivacy:B});Ie&&P(t,Ie)}},G),_}function Ci(t,e){var r=e||{},i=r.mirror,n=i===void 0?new fr:i,s=r.blockClass,o=s===void 0?"highlight-block":s,a=r.blockSelector,l=a===void 0?null:a,c=r.maskTextClass,d=c===void 0?"highlight-mask":c,u=r.maskTextSelector,h=u===void 0?null:u,f=r.inlineStylesheet,p=f===void 0?!0:f,g=r.inlineImages,v=g===void 0?!1:g,m=r.recordCanvas,y=m===void 0?!1:m,E=r.maskAllInputs,S=E===void 0?!1:E,A=r.maskTextFn,C=r.maskInputFn,T=r.slimDOM,b=T===void 0?!1:T,x=r.dataURLOptions,L=r.preserveWhiteSpace,P=r.onSerialize,Z=r.onIframeLoad,G=r.iframeLoadTimeout,V=r.onStylesheetLoad,D=r.stylesheetLoadTimeout,F=r.keepIframeSrcFn,H=F===void 0?function(){return!1}:F,B=r.enableStrictPrivacy,w=B===void 0?!1:B,I=S===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:S===!1?{password:!0}:S,M=b||b==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:b==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:b||{};return Ze(t,{doc:t,mirror:n,blockClass:o,blockSelector:l,maskTextClass:d,maskTextSelector:h,skipChild:!1,inlineStylesheet:p,maskInputOptions:I,maskTextFn:A,maskInputFn:C,slimDOMOptions:M,dataURLOptions:x,inlineImages:v,recordCanvas:y,preserveWhiteSpace:L,onSerialize:P,onIframeLoad:Z,iframeLoadTimeout:G,onStylesheetLoad:V,stylesheetLoadTimeout:D,keepIframeSrcFn:H,newlyAddedElement:!1,enableStrictPrivacy:w})}var gi=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function hs(t,e){e===void 0&&(e={});var r=1,i=1;function n(w){var I=w.match(/\n/g);I&&(r+=I.length);var M=w.lastIndexOf(`
`);i=M===-1?i+w.length:w.length-M}function s(){var w={line:r,column:i};return function(I){return I.position=new o(w),p(),I}}var o=function(){function w(I){this.start=I,this.end={line:r,column:i},this.source=e.source}return w}();o.prototype.content=t;var a=[];function l(w){var I=new Error("".concat(e.source||"",":").concat(r,":").concat(i,": ").concat(w));if(I.reason=w,I.filename=e.source,I.line=r,I.column=i,I.source=t,e.silent)a.push(I);else throw I}function c(){var w=h();return{type:"stylesheet",stylesheet:{source:e.source,rules:w,parsingErrors:a}}}function d(){return f(/^{\s*/)}function u(){return f(/^}/)}function h(){var w,I=[];for(p(),g(I);t.length&&t.charAt(0)!=="}"&&(w=H()||B());)w!==!1&&(I.push(w),g(I));return I}function f(w){var I=w.exec(t);if(I){var M=I[0];return n(M),t=t.slice(M.length),I}}function p(){f(/^\s*/)}function g(w){w===void 0&&(w=[]);for(var I;I=v();)I!==!1&&w.push(I),I=v();return w}function v(){var w=s();if(!(t.charAt(0)!=="/"||t.charAt(1)!=="*")){for(var I=2;t.charAt(I)!==""&&(t.charAt(I)!=="*"||t.charAt(I+1)!=="/");)++I;if(I+=2,t.charAt(I-1)==="")return l("End of comment missing");var M=t.slice(2,I-2);return i+=2,n(M),t=t.slice(I),i+=2,w({type:"comment",comment:M})}}function m(){var w=f(/^([^{]+)/);if(w)return Me(w[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(I){return I.replace(/,/g,"\u200C")}).split(/\s*(?![^(]*\)),\s*/).map(function(I){return I.replace(/\u200C/g,",")})}function y(){var w=s(),I=f(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(I){var M=Me(I[0]);if(!f(/^:\s*/))return l("property missing ':'");var k=f(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),_=w({type:"declaration",property:M.replace(gi,""),value:k?Me(k[0]).replace(gi,""):""});return f(/^[;\s]*/),_}}function E(){var w=[];if(!d())return l("missing '{'");g(w);for(var I;I=y();)I!==!1&&(w.push(I),g(w)),I=y();return u()?w:l("missing '}'")}function S(){for(var w,I=[],M=s();w=f(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)I.push(w[1]),f(/^,\s*/);if(I.length)return M({type:"keyframe",values:I,declarations:E()})}function A(){var w=s(),I=f(/^@([-\w]+)?keyframes\s*/);if(I){var M=I[1];if(I=f(/^([-\w]+)\s*/),!I)return l("@keyframes missing name");var k=I[1];if(!d())return l("@keyframes missing '{'");for(var _,X=g();_=S();)X.push(_),X=X.concat(g());return u()?w({type:"keyframes",name:k,vendor:M,keyframes:X}):l("@keyframes missing '}'")}}function C(){var w=s(),I=f(/^@supports *([^{]+)/);if(I){var M=Me(I[1]);if(!d())return l("@supports missing '{'");var k=g().concat(h());return u()?w({type:"supports",supports:M,rules:k}):l("@supports missing '}'")}}function T(){var w=s(),I=f(/^@host\s*/);if(I){if(!d())return l("@host missing '{'");var M=g().concat(h());return u()?w({type:"host",rules:M}):l("@host missing '}'")}}function b(){var w=s(),I=f(/^@media *([^{]+)/);if(I){var M=Me(I[1]);if(!d())return l("@media missing '{'");var k=g().concat(h());return u()?w({type:"media",media:M,rules:k}):l("@media missing '}'")}}function x(){var w=s(),I=f(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(I)return w({type:"custom-media",name:Me(I[1]),media:Me(I[2])})}function L(){var w=s(),I=f(/^@page */);if(I){var M=m()||[];if(!d())return l("@page missing '{'");for(var k=g(),_;_=y();)k.push(_),k=k.concat(g());return u()?w({type:"page",selectors:M,declarations:k}):l("@page missing '}'")}}function P(){var w=s(),I=f(/^@([-\w]+)?document *([^{]+)/);if(I){var M=Me(I[1]),k=Me(I[2]);if(!d())return l("@document missing '{'");var _=g().concat(h());return u()?w({type:"document",document:k,vendor:M,rules:_}):l("@document missing '}'")}}function Z(){var w=s(),I=f(/^@font-face\s*/);if(I){if(!d())return l("@font-face missing '{'");for(var M=g(),k;k=y();)M.push(k),M=M.concat(g());return u()?w({type:"font-face",declarations:M}):l("@font-face missing '}'")}}var G=F("import"),V=F("charset"),D=F("namespace");function F(w){var I=new RegExp("^@"+w+"\\s*([^;]+);");return function(){var M=s(),k=f(I);if(k){var _={type:w};return _[w]=k[1].trim(),M(_)}}}function H(){if(t[0]==="@")return A()||b()||x()||C()||G()||V()||D()||P()||L()||T()||Z()}function B(){var w=s(),I=m();return I?(g(),w({type:"rule",selectors:I,declarations:E()})):l("selector missing")}return ur(c())}function Me(t){return t?t.replace(/^\s+|\s+$/g,""):""}function ur(t,e){for(var r=t&&typeof t.type=="string",i=r?t:e,n=0,s=Object.keys(t);n<s.length;n++){var o=s[n],a=t[o];Array.isArray(a)?a.forEach(function(l){ur(l,i)}):a&&typeof a=="object"&&ur(a,i)}return r&&Object.defineProperty(t,"parent",{configurable:!0,writable:!0,enumerable:!1,value:e||null}),t}var vi={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function fs(t){var e=vi[t.tagName]?vi[t.tagName]:t.tagName;return e==="link"&&t.attributes._cssText&&(e="style"),e}function ps(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var Si=/([^\\]):hover/,ms=new RegExp(Si.source,"g");function yi(t,e){var r;if(!(!((r=window?.HIG_CONFIGURATION)===null||r===void 0)&&r.enableOnHoverClass))return t;var i=e?.stylesWithHoverClass.get(t);if(i)return i;var n=hs(t,{silent:!0});if(!n.stylesheet)return t;var s=[];if(n.stylesheet.rules.forEach(function(l){"selectors"in l&&(l.selectors||[]).forEach(function(c){Si.test(c)&&s.push(c)})}),s.length===0)return t;var o=new RegExp(s.filter(function(l,c){return s.indexOf(l)===c}).sort(function(l,c){return c.length-l.length}).map(function(l){return ps(l)}).join("|"),"g"),a=t.replace(o,function(l){var c=l.replace(ms,"$1.\\:hover");return"".concat(l,", ").concat(c)});return e?.stylesWithHoverClass.set(t,a),a}function Ir(){var t=new Map;return{stylesWithHoverClass:t}}function gs(t,e){var r=e.doc,i=e.hackCss,n=e.cache;switch(t.type){case O.Document:return r.implementation.createDocument(null,"",null);case O.DocumentType:return r.implementation.createDocumentType(t.name||"html",t.publicId,t.systemId);case O.Element:{var s=fs(t),o;t.isSVG?o=r.createElementNS("http://www.w3.org/2000/svg",s):o=r.createElement(s);var a={},l=function(h){if(!Object.prototype.hasOwnProperty.call(t.attributes,h))return"continue";var f=t.attributes[h];if(s==="option"&&h==="selected"&&f===!1||f===null)return"continue";if(f===!0&&(f=""),h.startsWith("rr_"))return a[h]=f,"continue";var p=s==="textarea"&&h==="value",g=s==="style"&&h==="_cssText";if(g&&i&&typeof f=="string"&&(f=yi(f,n),typeof f=="string")){for(var v=/url\("https:\/\/\S*(.eot|.woff2|.ttf|.woff)\S*"\)/gm,m=void 0,y=[],E="https://replay-cors-proxy.highlightrun.workers.dev";(m=v.exec(f))!==null;)m.index===v.lastIndex&&v.lastIndex++,m.forEach(function(b,x){if(x===0){var L=b.slice(5,b.length-2);y.push({originalUrl:L,proxyUrl:L.replace(L,"".concat(E,"?url=").concat(L))})}});y.forEach(function(b){f=f.replace(b.originalUrl,b.proxyUrl)})}if((p||g)&&typeof f=="string"){for(var S=r.createTextNode(f),A=0,C=Array.from(o.childNodes);A<C.length;A++){var T=C[A];T.nodeType===o.TEXT_NODE&&o.removeChild(T)}return o.appendChild(S),"continue"}try{if(t.isSVG&&h==="xlink:href")o.setAttributeNS("http://www.w3.org/1999/xlink",h,f.toString());else if(h==="onload"||h==="onclick"||h.substring(0,7)==="onmouse")o.setAttribute("_"+h,f.toString());else{if(s==="meta"&&t.attributes["http-equiv"]==="Content-Security-Policy"&&h==="content")return o.setAttribute("csp-content",f.toString()),"continue";s==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||s==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&t.attributes.href.endsWith(".js")||(s==="img"&&t.attributes.srcset&&t.attributes.rr_dataURL?o.setAttribute("rrweb-original-srcset",t.attributes.srcset):o.setAttribute(h,f.toString()))}}catch{}};for(var c in t.attributes)l(c);var d=function(h){var f=a[h];if(s==="canvas"&&h==="rr_dataURL"){var p=document.createElement("img");p.onload=function(){var v=o.getContext("2d");v&&v.drawImage(p,0,0,p.width,p.height)},p.src=f.toString(),o.RRNodeType&&(o.rr_dataURL=f.toString())}else if(s==="img"&&h==="rr_dataURL"){var g=o;g.currentSrc.startsWith("data:")||(g.setAttribute("rrweb-original-src",t.attributes.src),g.src=f.toString())}if(h==="rr_width")o.style.width=f.toString();else if(h==="rr_height")o.style.height=f.toString();else if(h==="rr_mediaCurrentTime"&&typeof f=="number")o.currentTime=f;else if(h==="rr_mediaState")switch(f){case"played":o.play().catch(function(v){return console.warn("media playback error",v)});break;case"paused":o.pause();break}};for(var u in a)d(u);if(t.isShadowHost)if(!o.shadowRoot)o.attachShadow({mode:"open"});else for(;o.shadowRoot.firstChild;)o.shadowRoot.removeChild(o.shadowRoot.firstChild);return o}case O.Text:return r.createTextNode(t.isStyle&&i?yi(t.textContent,n):t.textContent);case O.CDATA:return r.createCDATASection(t.textContent);case O.Comment:return r.createComment(t.textContent);default:return null}}function rt(t,e){var r=e.doc,i=e.mirror,n=e.skipChild,s=n===void 0?!1:n,o=e.hackCss,a=o===void 0?!0:o,l=e.afterAppend,c=e.cache;if(i.has(t.id)){var d=i.getNode(t.id),u=i.getMeta(d);if(Zn(u,t))return i.getNode(t.id)}var h=gs(t,{doc:r,hackCss:a,cache:c});if(!h)return null;if(t.rootId&&i.getNode(t.rootId)!==r&&i.replace(t.rootId,r),t.type===O.Document&&(r.close(),r.open(),t.compatMode==="BackCompat"&&t.childNodes&&t.childNodes[0].type!==O.DocumentType&&(t.childNodes[0].type===O.Element&&"xmlns"in t.childNodes[0].attributes&&t.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),h=r),i.add(h,t),(t.type===O.Document||t.type===O.Element)&&!s)for(var f=function(m){var y=rt(m,{doc:r,mirror:i,skipChild:!1,hackCss:a,afterAppend:l,cache:c});if(!y)return console.warn("Failed to rebuild",m),"continue";if(m.isShadow&&Ii(h)&&h.shadowRoot)h.shadowRoot.appendChild(y);else if(t.type===O.Document&&m.type==O.Element){var E=y,S=null;E.childNodes.forEach(function(A){A.nodeName==="BODY"&&(S=A)}),S?(E.removeChild(S),h.appendChild(y),E.appendChild(S)):h.appendChild(y)}else h.appendChild(y);l&&l(y,m.id)},p=0,g=t.childNodes;p<g.length;p++){var v=g[p];f(v)}return h}function vs(t,e){function r(o){e(o)}for(var i=0,n=t.getIds();i<n.length;i++){var s=n[i];t.has(s)&&r(t.getNode(s))}}function ys(t,e){var r=e.getMeta(t);if(r?.type===O.Element){var i=t;for(var n in r.attributes)if(Object.prototype.hasOwnProperty.call(r.attributes,n)&&n.startsWith("rr_")){var s=r.attributes[n];n==="rr_scrollLeft"&&(i.scrollLeft=s),n==="rr_scrollTop"&&(i.scrollTop=s)}}}function bi(t,e){var r=e.doc,i=e.onVisit,n=e.hackCss,s=n===void 0?!0:n,o=e.afterAppend,a=e.cache,l=e.mirror,c=l===void 0?new fr:l,d=rt(t,{doc:r,mirror:c,skipChild:!1,hackCss:s,afterAppend:o,cache:a});return vs(c,function(u){i&&i(u),ys(u,c)}),d}var wi={};hi(wi,{StyleSheetMirror:()=>Xe,_mirror:()=>Dt,getBaseDimension:()=>Lt,getNestedRule:()=>Qe,getPositionsAndIndex:()=>Ft,getRootShadowHost:()=>Ei,getShadowHost:()=>Pt,getWindowHeight:()=>ht,getWindowScroll:()=>ut,getWindowWidth:()=>ft,hasShadowRoot:()=>Se,hookSetter:()=>Pe,inDom:()=>vt,isAncestorRemoved:()=>kt,isBlocked:()=>te,isCanvasNode:()=>Cr,isIgnored:()=>pt,isSerialized:()=>Sr,isSerializedIframe:()=>_e,isSerializedStylesheet:()=>gt,isTouchEvent:()=>Ot,iterateResolveTree:()=>xt,on:()=>se,patch:()=>me,polyfill:()=>mt,queueToResolveTrees:()=>br,shadowHostInDom:()=>Ai,throttle:()=>qe,uniqueTextMutations:()=>Er});function se(t,e,r=document){let i={capture:!0};return r.addEventListener(t,e,i),()=>r.removeEventListener(t,e,i)}var it=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`,Dt={map:{},getId(){return console.error(it),-1},getNode(){return console.error(it),null},removeNodeFromMap(){console.error(it)},has(){return console.error(it),!1},reset(){console.error(it)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(Dt=new Proxy(Dt,{get(t,e,r){return e==="map"&&console.error(it),Reflect.get(t,e,r)}}));function qe(t,e,r={}){let i=null,n=0;return function(...s){let o=Date.now();!n&&r.leading===!1&&(n=o);let a=e-(o-n),l=this;a<=0||a>e?(i&&(clearTimeout(i),i=null),n=o,t.apply(l,s)):!i&&r.trailing!==!1&&(i=setTimeout(()=>{n=r.leading===!1?0:Date.now(),i=null,t.apply(l,s)},a))}}function Pe(t,e,r,i,n=window){let s=n.Object.getOwnPropertyDescriptor(t,e);return n.Object.defineProperty(t,e,i?r:{set(o){setTimeout(()=>{r.set.call(this,o)},0),s&&s.set&&s.set.call(this,o)}}),()=>Pe(t,e,s||{},!0)}function me(t,e,r){try{if(!(e in t))return()=>{};let i=t[e],n=r(i);return typeof n=="function"&&(n.prototype=n.prototype||{},Object.defineProperties(n,{__rrweb_original__:{enumerable:!1,value:i}})),t[e]=n,()=>{t[e]=i}}catch{return()=>{}}}function ut(t){var e,r,i,n,s,o;let a=t.document;return{left:a.scrollingElement?a.scrollingElement.scrollLeft:t.pageXOffset!==void 0?t.pageXOffset:a?.documentElement.scrollLeft||((r=(e=a?.body)===null||e===void 0?void 0:e.parentElement)===null||r===void 0?void 0:r.scrollLeft)||((i=a?.body)===null||i===void 0?void 0:i.scrollLeft)||0,top:a.scrollingElement?a.scrollingElement.scrollTop:t.pageYOffset!==void 0?t.pageYOffset:a?.documentElement.scrollTop||((s=(n=a?.body)===null||n===void 0?void 0:n.parentElement)===null||s===void 0?void 0:s.scrollTop)||((o=a?.body)===null||o===void 0?void 0:o.scrollTop)||0}}function ht(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function ft(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}var Cr=t=>{try{if(t instanceof HTMLElement)return t.tagName==="CANVAS"}catch{return!1}return!1};function te(t,e,r,i){if(!t)return!1;let n=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(!n)return!1;try{if(typeof e=="string"){if(n.classList.contains(e)||i&&n.closest("."+e)!==null)return!0}else if(at(n,e,i))return!0}catch{}return!!(r&&(n.matches(r)||i&&n.closest(r)!==null))}function Sr(t,e){return e.getId(t)!==-1}function pt(t,e){return e.getId(t)===Ke}function kt(t,e){if(je(t))return!1;let r=e.getId(t);return e.has(r)?t.parentNode&&t.parentNode.nodeType===t.DOCUMENT_NODE?!1:t.parentNode?kt(t.parentNode,e):!0:!0}function Ot(t){return!!t.changedTouches}function mt(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let r=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do if(this===r)return!0;while(r=r&&r.parentNode);return!1})}function br(t){let e={},r=(n,s)=>{let o={value:n,parent:s,children:[]};return e[n.node.id]=o,o},i=[];for(let n of t){let{nextId:s,parentId:o}=n;if(s&&s in e){let a=e[s];if(a.parent){let l=a.parent.children.indexOf(a);a.parent.children.splice(l,0,r(n,a.parent))}else{let l=i.indexOf(a);i.splice(l,0,r(n,null))}continue}if(o in e){let a=e[o];a.children.push(r(n,a));continue}i.push(r(n,null))}return i}function xt(t,e){e(t.value);for(let r=t.children.length-1;r>=0;r--)xt(t.children[r],e)}function _e(t,e){return!!(t.nodeName==="IFRAME"&&e.getMeta(t))}function gt(t,e){return!!(t.nodeName==="LINK"&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&t.getAttribute("rel")==="stylesheet"&&e.getMeta(t))}function Lt(t,e){var r,i;let n=(i=(r=t.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||i===void 0?void 0:i.frameElement;if(!n||n===e)return{x:0,y:0,relativeScale:1,absoluteScale:1};let s=n.getBoundingClientRect(),o=Lt(n,e),a=s.height/n.clientHeight;return{x:s.x*o.relativeScale+o.x,y:s.y*o.relativeScale+o.y,relativeScale:a,absoluteScale:o.absoluteScale*a}}function Se(t){return!!t?.shadowRoot}function Qe(t,e){let r=t[e[0]];return e.length===1?r:Qe(r.cssRules[e[1]].cssRules,e.slice(2))}function Ft(t){let e=[...t],r=e.pop();return{positions:e,index:r}}function Er(t){let e=new Set,r=[];for(let i=t.length;i--;){let n=t[i];e.has(n.id)||(r.push(n),e.add(n.id))}return r}var Xe=class{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var r;return(r=this.styleIDMap.get(e))!==null&&r!==void 0?r:-1}has(e){return this.styleIDMap.has(e)}add(e,r){if(this.has(e))return this.getId(e);let i;return r===void 0?i=this.id++:i=r,this.styleIDMap.set(e,i),this.idStyleMap.set(i,e),i}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}};function Pt(t){var e,r;let i=null;return((r=(e=t.getRootNode)===null||e===void 0?void 0:e.call(t))===null||r===void 0?void 0:r.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host&&(i=t.getRootNode().host),i}function Ei(t){let e=t,r;for(;r=Pt(e);)e=r;return e}function Ai(t){let e=t.ownerDocument;if(!e)return!1;let r=Ei(t);return e.contains(r)}function vt(t){let e=t.ownerDocument;return e?e.contains(t)||Ai(t):!1}var R=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(R||{}),N=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t))(N||{}),J=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(J||{}),pe=(t=>(t[t["2D"]=0]="2D",t[t.WebGL=1]="WebGL",t[t.WebGL2=2]="WebGL2",t))(pe||{}),z=(t=>(t.Start="start",t.Pause="pause",t.Resume="resume",t.Resize="resize",t.Finish="finish",t.FullsnapshotRebuilded="fullsnapshot-rebuilded",t.LoadStylesheetStart="load-stylesheet-start",t.LoadStylesheetEnd="load-stylesheet-end",t.SkipStart="skip-start",t.SkipEnd="skip-end",t.MouseInteraction="mouse-interaction",t.EventCast="event-cast",t.CustomEvent="custom-event",t.Flush="flush",t.StateChange="state-change",t.PlayBack="play-back",t.Destroy="destroy",t))(z||{});function Ni(t){return"__ln"in t}var Ar=class{constructor(){this.length=0,this.head=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let r=this.head;for(let i=0;i<e;i++)r=r?.next||null;return r}addNode(e){let r={value:e,previous:null,next:null};if(e.__ln=r,e.previousSibling&&Ni(e.previousSibling)){let i=e.previousSibling.__ln.next;r.next=i,r.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=r,i&&(i.previous=r)}else if(e.nextSibling&&Ni(e.nextSibling)&&e.nextSibling.__ln.previous){let i=e.nextSibling.__ln.previous;r.previous=i,r.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=r,i&&(i.next=r)}else this.head&&(this.head.previous=r),r.next=this.head,this.head=r;this.length++}removeNode(e){let r=e.__ln;this.head&&(r.previous?(r.previous.next=r.next,r.next&&(r.next.previous=r.previous)):(this.head=r.next,this.head&&(this.head.previous=null)),e.__ln&&delete e.__ln,this.length--)}},Ti=(t,e)=>`${t}@${e}`,Bt=class{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;let e=[],r=new Ar,i=a=>{let l=a,c=Ke;for(;c===Ke;)l=l&&l.nextSibling,c=l&&this.mirror.getId(l);return c},n=a=>{if(!a.parentNode||!vt(a))return;let l=je(a.parentNode)?this.mirror.getId(Pt(a)):this.mirror.getId(a.parentNode),c=i(a);if(l===-1||c===-1)return r.addNode(a);let d=Ze(a,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,enableStrictPrivacy:this.enableStrictPrivacy,onSerialize:u=>{_e(u,this.mirror)&&this.iframeManager.addIframe(u),gt(u,this.mirror)&&this.stylesheetManager.trackLinkElement(u),Se(a)&&this.shadowDomManager.addShadowRoot(a.shadowRoot,this.doc)},onIframeLoad:(u,h)=>{this.iframeManager.attachIframe(u,h),this.shadowDomManager.observeAttachShadow(u)},onStylesheetLoad:(u,h)=>{this.stylesheetManager.attachLinkElement(u,h)}});d&&e.push({parentId:l,nextId:c,node:d})};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(let a of this.movedSet)Ri(this.removes,a,this.mirror)&&!this.movedSet.has(a.parentNode)||n(a);for(let a of this.addedSet)!Mi(this.droppedSet,a)&&!Ri(this.removes,a,this.mirror)||Mi(this.movedSet,a)?n(a):this.droppedSet.add(a);let s=null;for(;r.length;){let a=null;if(s){let l=this.mirror.getId(s.value.parentNode),c=i(s.value);l!==-1&&c!==-1&&(a=s)}if(!a)for(let l=r.length-1;l>=0;l--){let c=r.get(l);if(c){let d=this.mirror.getId(c.value.parentNode);if(i(c.value)===-1)continue;if(d!==-1){a=c;break}else{let h=c.value;if(h.parentNode&&h.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){let f=h.parentNode.host;if(this.mirror.getId(f)!==-1){a=c;break}}}}}if(!a){for(;r.head;)r.removeNode(r.head.value);break}s=a.previous,r.removeNode(a.value),n(a.value)}let o={texts:this.texts.map(a=>{let l=a.value;return this.enableStrictPrivacy&&l&&(l=dt(l)),{id:this.mirror.getId(a.node),value:l}}).filter(a=>this.mirror.has(a.id)),attributes:this.attributes.map(a=>({id:this.mirror.getId(a.node),attributes:a.attributes})).filter(a=>this.mirror.has(a.id)),removes:this.removes,adds:e};!o.texts.length&&!o.attributes.length&&!o.removes.length&&!o.adds.length||(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(o))},this.processMutation=e=>{if(!pt(e.target,this.mirror))switch(e.type){case"characterData":{let r=e.target.textContent;!te(e.target,this.blockClass,this.blockSelector,!1)&&r!==e.oldValue&&this.texts.push({value:yr(e.target,this.maskTextClass,this.maskTextSelector)&&r?this.maskTextFn?this.maskTextFn(r):r.replace(/[\S]/g,"*"):r,node:e.target});break}case"attributes":{let r=e.target,i=e.attributeName,n=e.target.getAttribute(i);if(i==="value"){let o=ct(r);n=lt({maskInputOptions:this.maskInputOptions,tagName:r.tagName,type:o,value:n,maskInputFn:this.maskInputFn})}if(te(e.target,this.blockClass,this.blockSelector,!1)||n===e.oldValue)return;let s=this.attributes.find(o=>o.node===e.target);if(r.tagName==="IFRAME"&&i==="src"&&!this.keepIframeSrcFn(n))if(!r.contentDocument)i="rr_src";else return;if(s||(s={node:e.target,attributes:{}},this.attributes.push(s)),i==="type"&&r.tagName==="INPUT"&&(e.oldValue||"").toLowerCase()==="password"&&r.setAttribute("data-rr-is-password","true"),i==="style"){let o=this.doc.createElement("span");e.oldValue&&o.setAttribute("style",e.oldValue),(s.attributes.style===void 0||s.attributes.style===null)&&(s.attributes.style={});let a=s.attributes.style;for(let l of Array.from(r.style)){let c=r.style.getPropertyValue(l),d=r.style.getPropertyPriority(l);(c!==o.style.getPropertyValue(l)||d!==o.style.getPropertyPriority(l))&&(d===""?a[l]=c:a[l]=[c,d])}for(let l of Array.from(o.style))r.style.getPropertyValue(l)===""&&(a[l]=!1)}else if(!vr(r.tagName,i)){if(e.target.tagName==="INPUT"){let a=e.target;if(a.type==="password"){s.attributes.value="*".repeat(a.value.length);break}}s.attributes[i]=gr(this.doc,r.tagName,i,n)}break}case"childList":{if(te(e.target,this.blockClass,this.blockSelector,!0))return;e.addedNodes.forEach(r=>this.genAdds(r,e.target)),e.removedNodes.forEach(r=>{let i=this.mirror.getId(r),n=je(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);te(e.target,this.blockClass,this.blockSelector,!1)||pt(r,this.mirror)||!Sr(r,this.mirror)||(this.addedSet.has(r)?(wr(this.addedSet,r),this.droppedSet.add(r)):this.addedSet.has(e.target)&&i===-1||kt(e.target,this.mirror)||(this.movedSet.has(r)&&this.movedMap[Ti(i,n)]?wr(this.movedSet,r):this.removes.push({parentId:n,id:i,isShadow:je(e.target)&&ze(e.target)?!0:void 0})),this.mapRemoves.push(r))});break}}},this.genAdds=(e,r)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)){if(this.mirror.hasNode(e)){if(pt(e,this.mirror))return;this.movedSet.add(e);let i=null;r&&this.mirror.hasNode(r)&&(i=this.mirror.getId(r)),i&&i!==-1&&(this.movedMap[Ti(this.mirror.getId(e),i)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);te(e,this.blockClass,this.blockSelector,!1)||(e.childNodes.forEach(i=>this.genAdds(i)),Se(e)&&e.shadowRoot.childNodes.forEach(i=>{this.processedNodeManager.add(i,this),this.genAdds(i,e)}))}}}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","enableStrictPrivacy","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(r=>{this[r]=e[r]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}};function wr(t,e){t.delete(e),e.childNodes.forEach(r=>wr(t,r))}function Ri(t,e,r){return t.length===0?!1:_i(t,e,r)}function _i(t,e,r){let{parentNode:i}=e;if(!i)return!1;let n=r.getId(i);return t.some(s=>s.id===n)?!0:_i(t,i,r)}function Mi(t,e){return t.size===0?!1:Di(t,e)}function Di(t,e){let{parentNode:r}=e;return r?t.has(r)?!0:Di(t,r):!1}var yt;function ki(t){yt=t}function Oi(){yt=void 0}var W=t=>yt?(...r)=>{try{return t(...r)}catch(i){if(yt&&yt(i)===!0)return;throw i}}:t;var Ue=[];function It(t){try{if("composedPath"in t){let e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0];return t.target}catch{return t.target}}function Nr(t,e){var r,i;let n=new Bt;Ue.push(n),n.init(t);let s=window.MutationObserver||window.__rrMutationObserver,o=(i=(r=window?.Zone)===null||r===void 0?void 0:r.__symbol__)===null||i===void 0?void 0:i.call(r,"MutationObserver");o&&window[o]&&(s=window[o]);let a=new s(W(n.processMutations.bind(n)));return a.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function Is({mousemoveCb:t,sampling:e,doc:r,mirror:i}){if(e.mousemove===!1)return()=>{};let n=typeof e.mousemove=="number"?e.mousemove:50,s=typeof e.mousemoveCallback=="number"?e.mousemoveCallback:500,o=[],a,l=qe(W(u=>{let h=Date.now()-a;t(o.map(f=>(f.timeOffset-=h,f)),u),o=[],a=null}),s),c=W(qe(W(u=>{let h=It(u),{clientX:f,clientY:p}=Ot(u)?u.changedTouches[0]:u;a||(a=Date.now()),o.push({x:f,y:p,id:i.getId(h),timeOffset:Date.now()-a}),l(typeof DragEvent<"u"&&u instanceof DragEvent?N.Drag:u instanceof MouseEvent?N.MouseMove:N.TouchMove)}),n,{trailing:!1})),d=[se("mousemove",c,r),se("touchmove",c,r),se("drag",c,r)];return W(()=>{d.forEach(u=>u())})}function Cs({mouseInteractionCb:t,doc:e,mirror:r,blockClass:i,blockSelector:n,sampling:s}){if(s.mouseInteraction===!1)return()=>{};let o=s.mouseInteraction===!0||s.mouseInteraction===void 0?{}:s.mouseInteraction,a=[],l=c=>d=>{let u=It(d);if(te(u,i,n,!0)||Cr(u))return;let h=Ot(d)?d.changedTouches[0]:d;if(!h)return;let f=r.getId(u),{clientX:p,clientY:g}=h;W(t)({type:J[c],id:f,x:p,y:g})};return Object.keys(J).filter(c=>Number.isNaN(Number(c))&&!c.endsWith("_Departed")&&o[c]!==!1).forEach(c=>{let d=c.toLowerCase(),u=l(c);a.push(se(d,u,e))}),W(()=>{a.forEach(c=>c())})}function Tr({scrollCb:t,doc:e,mirror:r,blockClass:i,blockSelector:n,sampling:s}){let o=W(qe(W(a=>{let l=It(a);if(!l||te(l,i,n,!0))return;let c=r.getId(l);if(l===e&&e.defaultView){let d=ut(e.defaultView);t({id:c,x:d.left,y:d.top})}else t({id:c,x:l.scrollLeft,y:l.scrollTop})}),s.scroll||100));return se("scroll",o,e)}function Ss({viewportResizeCb:t}){let e=-1,r=-1,i=W(qe(W(()=>{let n=ht(),s=ft();(e!==n||r!==s)&&(t({width:Number(s),height:Number(n)}),e=n,r=s)}),200));return se("resize",i,window)}function xi(t,e){let r=Object.assign({},t);return e||delete r.userTriggered,r}var bs=["INPUT","TEXTAREA","SELECT"],Li=new WeakMap;function Es({inputCb:t,doc:e,mirror:r,blockClass:i,blockSelector:n,ignoreClass:s,maskInputOptions:o,maskInputFn:a,sampling:l,userTriggeredOnInput:c}){function d(m){let y=It(m),E=m.isTrusted,S=y&&y.tagName;if(y&&S==="OPTION"&&(y=y.parentElement),!y||!S||bs.indexOf(S)<0||te(y,i,n,!0)||y.classList.contains(s))return;let A=y.value,C=!1,T=ct(y)||"";T==="radio"||T==="checkbox"?C=y.checked:(o[S.toLowerCase()]||o[T])&&(A=lt({maskInputOptions:o,tagName:S,type:T,value:A,maskInputFn:a})),u(y,W(xi)({text:A,isChecked:C,userTriggered:E},c));let b=y.name;T==="radio"&&b&&C&&e.querySelectorAll(`input[type="radio"][name="${b}"]`).forEach(x=>{x!==y&&u(x,W(xi)({text:x.value,isChecked:!C,userTriggered:!1},c))})}function u(m,y){let E=Li.get(m);if(!E||E.text!==y.text||E.isChecked!==y.isChecked){Li.set(m,y);let S=r.getId(m);W(t)(Object.assign(Object.assign({},y),{id:S}))}}let f=(l.input==="last"?["change"]:["input","change"]).map(m=>se(m,W(d),e)),p=e.defaultView;if(!p)return()=>{f.forEach(m=>m())};let g=p.Object.getOwnPropertyDescriptor(p.HTMLInputElement.prototype,"value"),v=[[p.HTMLInputElement.prototype,"value"],[p.HTMLInputElement.prototype,"checked"],[p.HTMLSelectElement.prototype,"value"],[p.HTMLTextAreaElement.prototype,"value"],[p.HTMLSelectElement.prototype,"selectedIndex"],[p.HTMLOptionElement.prototype,"selected"]];return g&&g.set&&f.push(...v.map(m=>Pe(m[0],m[1],{set(){W(d)({target:this,isTrusted:!1})}},!1,p))),W(()=>{f.forEach(m=>m())})}function Vt(t){let e=[];function r(i,n){if(Ut("CSSGroupingRule")&&i.parentRule instanceof CSSGroupingRule||Ut("CSSMediaRule")&&i.parentRule instanceof CSSMediaRule||Ut("CSSSupportsRule")&&i.parentRule instanceof CSSSupportsRule||Ut("CSSConditionRule")&&i.parentRule instanceof CSSConditionRule){let o=Array.from(i.parentRule.cssRules).indexOf(i);n.unshift(o)}else if(i.parentStyleSheet){let o=Array.from(i.parentStyleSheet.cssRules).indexOf(i);n.unshift(o)}return n}return r(t,e)}function Be(t,e,r){let i,n;return t?(t.ownerNode?i=e.getId(t.ownerNode):n=r.getId(t),{styleId:n,id:i}):{}}function As({styleSheetRuleCb:t,mirror:e,stylesheetManager:r},{win:i}){if(!i.CSSStyleSheet||!i.CSSStyleSheet.prototype)return()=>{};let n=i.CSSStyleSheet.prototype.insertRule;i.CSSStyleSheet.prototype.insertRule=new Proxy(n,{apply:W((d,u,h)=>{let[f,p]=h,{id:g,styleId:v}=Be(u,e,r.styleMirror);return(g&&g!==-1||v&&v!==-1)&&t({id:g,styleId:v,adds:[{rule:f,index:p}]}),d.apply(u,h)})});let s=i.CSSStyleSheet.prototype.deleteRule;i.CSSStyleSheet.prototype.deleteRule=new Proxy(s,{apply:W((d,u,h)=>{let[f]=h,{id:p,styleId:g}=Be(u,e,r.styleMirror);return(p&&p!==-1||g&&g!==-1)&&t({id:p,styleId:g,removes:[{index:f}]}),d.apply(u,h)})});let o;i.CSSStyleSheet.prototype.replace&&(o=i.CSSStyleSheet.prototype.replace,i.CSSStyleSheet.prototype.replace=new Proxy(o,{apply:W((d,u,h)=>{let[f]=h,{id:p,styleId:g}=Be(u,e,r.styleMirror);return(p&&p!==-1||g&&g!==-1)&&t({id:p,styleId:g,replace:f}),d.apply(u,h)})}));let a;i.CSSStyleSheet.prototype.replaceSync&&(a=i.CSSStyleSheet.prototype.replaceSync,i.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:W((d,u,h)=>{let[f]=h,{id:p,styleId:g}=Be(u,e,r.styleMirror);return(p&&p!==-1||g&&g!==-1)&&t({id:p,styleId:g,replaceSync:f}),d.apply(u,h)})}));let l={};Wt("CSSGroupingRule")?l.CSSGroupingRule=i.CSSGroupingRule:(Wt("CSSMediaRule")&&(l.CSSMediaRule=i.CSSMediaRule),Wt("CSSConditionRule")&&(l.CSSConditionRule=i.CSSConditionRule),Wt("CSSSupportsRule")&&(l.CSSSupportsRule=i.CSSSupportsRule));let c={};return Object.entries(l).forEach(([d,u])=>{c[d]={insertRule:u.prototype.insertRule,deleteRule:u.prototype.deleteRule},u.prototype.insertRule=new Proxy(c[d].insertRule,{apply:W((h,f,p)=>{let[g,v]=p,{id:m,styleId:y}=Be(f.parentStyleSheet,e,r.styleMirror);return(m&&m!==-1||y&&y!==-1)&&t({id:m,styleId:y,adds:[{rule:g,index:[...Vt(f),v||0]}]}),h.apply(f,p)})}),u.prototype.deleteRule=new Proxy(c[d].deleteRule,{apply:W((h,f,p)=>{let[g]=p,{id:v,styleId:m}=Be(f.parentStyleSheet,e,r.styleMirror);return(v&&v!==-1||m&&m!==-1)&&t({id:v,styleId:m,removes:[{index:[...Vt(f),g]}]}),h.apply(f,p)})})}),W(()=>{i.CSSStyleSheet.prototype.insertRule=n,i.CSSStyleSheet.prototype.deleteRule=s,o&&(i.CSSStyleSheet.prototype.replace=o),a&&(i.CSSStyleSheet.prototype.replaceSync=a),Object.entries(l).forEach(([d,u])=>{u.prototype.insertRule=c[d].insertRule,u.prototype.deleteRule=c[d].deleteRule})})}function Rr({mirror:t,stylesheetManager:e},r){var i,n,s;let o=null;r.nodeName==="#document"?o=t.getId(r):o=t.getId(r.host);let a=r.nodeName==="#document"?(i=r.defaultView)===null||i===void 0?void 0:i.Document:(s=(n=r.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||s===void 0?void 0:s.ShadowRoot,l=Object.getOwnPropertyDescriptor(a?.prototype,"adoptedStyleSheets");return o===null||o===-1||!a||!l?()=>{}:(Object.defineProperty(r,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get(){var c;return(c=l.get)===null||c===void 0?void 0:c.call(this)},set(c){var d;let u=(d=l.set)===null||d===void 0?void 0:d.call(this,c);if(o!==null&&o!==-1)try{e.adoptStyleSheets(c,o)}catch{}return u}}),W(()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get:l.get,set:l.set})}))}function ws({styleDeclarationCb:t,mirror:e,ignoreCSSAttributes:r,stylesheetManager:i},{win:n}){let s=n.CSSStyleDeclaration.prototype.setProperty;n.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:W((a,l,c)=>{var d;let[u,h,f]=c;if(r.has(u))return s.apply(l,[u,h,f]);let{id:p,styleId:g}=Be((d=l.parentRule)===null||d===void 0?void 0:d.parentStyleSheet,e,i.styleMirror);return(p&&p!==-1||g&&g!==-1)&&t({id:p,styleId:g,set:{property:u,value:h,priority:f},index:Vt(l.parentRule)}),a.apply(l,c)})});let o=n.CSSStyleDeclaration.prototype.removeProperty;return n.CSSStyleDeclaration.prototype.removeProperty=new Proxy(o,{apply:W((a,l,c)=>{var d;let[u]=c;if(r.has(u))return o.apply(l,[u]);let{id:h,styleId:f}=Be((d=l.parentRule)===null||d===void 0?void 0:d.parentStyleSheet,e,i.styleMirror);return(h&&h!==-1||f&&f!==-1)&&t({id:h,styleId:f,remove:{property:u},index:Vt(l.parentRule)}),a.apply(l,c)})}),W(()=>{n.CSSStyleDeclaration.prototype.setProperty=s,n.CSSStyleDeclaration.prototype.removeProperty=o})}function Ns({mediaInteractionCb:t,blockClass:e,blockSelector:r,mirror:i,sampling:n}){let s=W(a=>qe(W(l=>{let c=It(l);if(!c||te(c,e,r,!0))return;let{currentTime:d,volume:u,muted:h,playbackRate:f}=c;t({type:a,id:i.getId(c),currentTime:d,volume:u,muted:h,playbackRate:f})}),n.media||500)),o=[se("play",s(0)),se("pause",s(1)),se("seeked",s(2)),se("volumechange",s(3)),se("ratechange",s(4))];return W(()=>{o.forEach(a=>a())})}function Ts({fontCb:t,doc:e}){let r=e.defaultView;if(!r)return()=>{};let i=[],n=new WeakMap,s=r.FontFace;r.FontFace=function(l,c,d){let u=new s(l,c,d);return n.set(u,{family:l,buffer:typeof c!="string",descriptors:d,fontSource:typeof c=="string"?c:JSON.stringify(Array.from(new Uint8Array(c)))}),u};let o=me(e.fonts,"add",function(a){return function(l){return setTimeout(W(()=>{let c=n.get(l);c&&(t(c),n.delete(l))}),0),a.apply(this,[l])}});return i.push(()=>{r.FontFace=s}),i.push(o),W(()=>{i.forEach(a=>a())})}function Rs(t){let{doc:e,mirror:r,blockClass:i,blockSelector:n,selectionCb:s}=t,o=!0,a=W(()=>{let l=e.getSelection();if(!l||o&&l?.isCollapsed)return;o=l.isCollapsed||!1;let c=[],d=l.rangeCount||0;for(let u=0;u<d;u++){let h=l.getRangeAt(u),{startContainer:f,startOffset:p,endContainer:g,endOffset:v}=h;te(f,i,n,!0)||te(g,i,n,!0)||c.push({start:r.getId(f),startOffset:p,end:r.getId(g),endOffset:v})}s({ranges:c})});return a(),se("selectionchange",a)}function Ms(t,e){let{mutationCb:r,mousemoveCb:i,mouseInteractionCb:n,scrollCb:s,viewportResizeCb:o,inputCb:a,mediaInteractionCb:l,styleSheetRuleCb:c,styleDeclarationCb:d,canvasMutationCb:u,fontCb:h,selectionCb:f}=t;t.mutationCb=(...p)=>{e.mutation&&e.mutation(...p),r(...p)},t.mousemoveCb=(...p)=>{e.mousemove&&e.mousemove(...p),i(...p)},t.mouseInteractionCb=(...p)=>{e.mouseInteraction&&e.mouseInteraction(...p),n(...p)},t.scrollCb=(...p)=>{e.scroll&&e.scroll(...p),s(...p)},t.viewportResizeCb=(...p)=>{e.viewportResize&&e.viewportResize(...p),o(...p)},t.inputCb=(...p)=>{e.input&&e.input(...p),a(...p)},t.mediaInteractionCb=(...p)=>{e.mediaInteaction&&e.mediaInteaction(...p),l(...p)},t.styleSheetRuleCb=(...p)=>{e.styleSheetRule&&e.styleSheetRule(...p),c(...p)},t.styleDeclarationCb=(...p)=>{e.styleDeclaration&&e.styleDeclaration(...p),d(...p)},t.canvasMutationCb=(...p)=>{e.canvasMutation&&e.canvasMutation(...p),u(...p)},t.fontCb=(...p)=>{e.font&&e.font(...p),h(...p)},t.selectionCb=(...p)=>{e.selection&&e.selection(...p),f(...p)}}function Fi(t,e={}){let r=t.doc.defaultView;if(!r)return()=>{};Ms(t,e);let i=Nr(t,t.doc),n=Is(t),s=Cs(t),o=Tr(t),a=Ss(t),l=Es(t),c=Ns(t),d=As(t,{win:r}),u=Rr(t,t.doc),h=ws(t,{win:r}),f=t.collectFonts?Ts(t):()=>{},p=Rs(t),g=[];for(let v of t.plugins)g.push(v.observer(v.callback,r,v.options));return W(()=>{Ue.forEach(v=>v.reset()),i.disconnect(),n(),s(),o(),a(),l(),c(),d(),u(),h(),f(),p(),g.forEach(v=>v())})}function Ut(t){return typeof window[t]<"u"}function Wt(t){return!!(typeof window[t]<"u"&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}var Ct=class{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,r,i,n){let s=i||this.getIdToRemoteIdMap(e),o=n||this.getRemoteIdToIdMap(e),a=s.get(r);return a||(a=this.generateIdFn(),s.set(r,a),o.set(a,r)),a}getIds(e,r){let i=this.getIdToRemoteIdMap(e),n=this.getRemoteIdToIdMap(e);return r.map(s=>this.getId(e,s,i,n))}getRemoteId(e,r,i){let n=i||this.getRemoteIdToIdMap(e);if(typeof r!="number")return r;let s=n.get(r);return s||-1}getRemoteIds(e,r){let i=this.getRemoteIdToIdMap(e);return r.map(n=>this.getRemoteId(e,n,i))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let r=this.iframeIdToRemoteIdMap.get(e);return r||(r=new Map,this.iframeIdToRemoteIdMap.set(e,r)),r}getRemoteIdToIdMap(e){let r=this.iframeRemoteIdToIdMap.get(e);return r||(r=new Map,this.iframeRemoteIdToIdMap.set(e,r)),r}};var Gt=class{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Ct(pr),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Ct(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,r){var i;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:r}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(i=this.loadListener)===null||i===void 0||i.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){let r=e;if(r.data.type!=="rrweb"||r.origin!==r.data.origin)return;let i=e.source;if(!i)return;let n=this.crossOriginIframeMap.get(i);if(!n)return;let s=this.transformCrossOriginEvent(n,r.data.event);s&&this.wrappedEmit(s,r.data.isCheckout)}transformCrossOriginEvent(e,r){var i;switch(r.type){case R.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(r.data.node,e);let n=r.data.node.id;return this.crossOriginIframeRootIdMap.set(e,n),this.patchRootIdOnNode(r.data.node,n),{timestamp:r.timestamp,type:R.IncrementalSnapshot,data:{source:N.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:r.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case R.Meta:case R.Load:case R.DomContentLoaded:return!1;case R.Plugin:return r;case R.Custom:return this.replaceIds(r.data.payload,e,["id","parentId","previousId","nextId"]),r;case R.IncrementalSnapshot:switch(r.data.source){case N.Mutation:return r.data.adds.forEach(n=>{this.replaceIds(n,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(n.node,e);let s=this.crossOriginIframeRootIdMap.get(e);s&&this.patchRootIdOnNode(n.node,s)}),r.data.removes.forEach(n=>{this.replaceIds(n,e,["parentId","id"])}),r.data.attributes.forEach(n=>{this.replaceIds(n,e,["id"])}),r.data.texts.forEach(n=>{this.replaceIds(n,e,["id"])}),r;case N.Drag:case N.TouchMove:case N.MouseMove:return r.data.positions.forEach(n=>{this.replaceIds(n,e,["id"])}),r;case N.ViewportResize:return!1;case N.MediaInteraction:case N.MouseInteraction:case N.Scroll:case N.CanvasMutation:case N.Input:return this.replaceIds(r.data,e,["id"]),r;case N.StyleSheetRule:case N.StyleDeclaration:return this.replaceIds(r.data,e,["id"]),this.replaceStyleIds(r.data,e,["styleId"]),r;case N.Font:return r;case N.Selection:return r.data.ranges.forEach(n=>{this.replaceIds(n,e,["start","end"])}),r;case N.AdoptedStyleSheet:return this.replaceIds(r.data,e,["id"]),this.replaceStyleIds(r.data,e,["styleIds"]),(i=r.data.styles)===null||i===void 0||i.forEach(n=>{this.replaceStyleIds(n,e,["styleId"])}),r}}}replace(e,r,i,n){for(let s of n)!Array.isArray(r[s])&&typeof r[s]!="number"||(Array.isArray(r[s])?r[s]=e.getIds(i,r[s]):r[s]=e.getId(i,r[s]));return r}replaceIds(e,r,i){return this.replace(this.crossOriginIframeMirror,e,r,i)}replaceStyleIds(e,r,i){return this.replace(this.crossOriginIframeStyleMirror,e,r,i)}replaceIdOnNode(e,r){this.replaceIds(e,r,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(i=>{this.replaceIdOnNode(i,r)})}patchRootIdOnNode(e,r){e.type!==O.Document&&!e.rootId&&(e.rootId=r),"childNodes"in e&&e.childNodes.forEach(i=>{this.patchRootIdOnNode(i,r)})}};var Ht=class{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,r){if(!ze(e)||this.shadowDoms.has(e))return;this.shadowDoms.add(e);let i=Nr(Object.assign(Object.assign({},this.bypassOptions),{doc:r,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e);this.restoreHandlers.push(()=>i.disconnect()),this.restoreHandlers.push(Tr(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(Rr({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){!e.contentWindow||!e.contentDocument||this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,r){let i=this;this.restoreHandlers.push(me(e.prototype,"attachShadow",function(n){return function(s){let o=n.call(this,s);return this.shadowRoot&&vt(this)&&i.addShadowRoot(this.shadowRoot,r),o}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}};function Pi(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function le(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(d){try{c(i.next(d))}catch(u){o(u)}}function l(d){try{c(i.throw(d))}catch(u){o(u)}}function c(d){d.done?s(d.value):n(d.value).then(a,l)}c((i=i.apply(t,e||[])).next())})}var nt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(St=0;St<nt.length;St++)bt[nt.charCodeAt(St)]=St;var St,Bi=function(t){var e=new Uint8Array(t),r,i=e.length,n="";for(r=0;r<i;r+=3)n+=nt[e[r]>>2],n+=nt[(e[r]&3)<<4|e[r+1]>>4],n+=nt[(e[r+1]&15)<<2|e[r+2]>>6],n+=nt[e[r+2]&63];return i%3===2?n=n.substring(0,n.length-1)+"=":i%3===1&&(n=n.substring(0,n.length-2)+"=="),n},Ui=function(t){var e=t.length*.75,r=t.length,i,n=0,s,o,a,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var c=new ArrayBuffer(e),d=new Uint8Array(c);for(i=0;i<r;i+=4)s=bt[t.charCodeAt(i)],o=bt[t.charCodeAt(i+1)],a=bt[t.charCodeAt(i+2)],l=bt[t.charCodeAt(i+3)],d[n++]=s<<2|o>>4,d[n++]=(o&15)<<4|a>>2,d[n++]=(a&3)<<6|l&63;return c};var Wi=new Map;function _s(t,e){let r=Wi.get(t);return r||(r=new Map,Wi.set(t,r)),r.has(e)||r.set(e,[]),r.get(e)}var Mr=(t,e,r)=>{if(!t||!(Vi(t,e)||typeof t=="object"))return;let i=t.constructor.name,n=_s(r,i),s=n.indexOf(t);return s===-1&&(s=n.length,n.push(t)),s};function Yt(t,e,r){if(t instanceof Array)return t.map(i=>Yt(i,e,r));if(t===null)return t;if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray)return{rr_type:t.constructor.name,args:[Object.values(t)]};if(t instanceof ArrayBuffer){let i=t.constructor.name,n=Bi(t);return{rr_type:i,base64:n}}else{if(t instanceof DataView)return{rr_type:t.constructor.name,args:[Yt(t.buffer,e,r),t.byteOffset,t.byteLength]};if(t instanceof HTMLImageElement){let i=t.constructor.name,{src:n}=t;return{rr_type:i,src:n}}else if(t instanceof HTMLCanvasElement){let i="HTMLImageElement",n=t.toDataURL();return{rr_type:i,src:n}}else{if(t instanceof ImageData)return{rr_type:t.constructor.name,args:[Yt(t.data,e,r),t.width,t.height]};if(Vi(t,e)||typeof t=="object"){let i=t.constructor.name,n=Mr(t,e,r);return{rr_type:i,index:n}}}}return t}var Zt=(t,e,r)=>[...t].map(i=>Yt(i,e,r)),Vi=(t,e)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(n=>typeof e[n]=="function").find(n=>t instanceof e[n]);function Gi(t,e,r,i){let n=[],s=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype);for(let o of s)try{if(typeof e.CanvasRenderingContext2D.prototype[o]!="function")continue;let a=me(e.CanvasRenderingContext2D.prototype,o,function(l){return function(...c){return te(this.canvas,r,i,!0)||setTimeout(()=>{let d=Zt([...c],e,this);t(this.canvas,{type:pe["2D"],property:o,args:d})},0),l.apply(this,c)}});n.push(a)}catch{let l=Pe(e.CanvasRenderingContext2D.prototype,o,{set(c){t(this.canvas,{type:pe["2D"],property:o,args:[c],setter:!0})}});n.push(l)}return()=>{n.forEach(o=>o())}}function _r(t,e,r){let i=[];try{let n=me(t.HTMLCanvasElement.prototype,"getContext",function(s){return function(o,...a){return te(this,e,r,!0)||this.__context||(this.__context=o),s.apply(this,[o,...a])}});i.push(n)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{i.forEach(n=>n())}}function Hi(t,e,r,i,n,s,o){let a=[],l=Object.getOwnPropertyNames(t);for(let c of l)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(c))try{if(typeof t[c]!="function")continue;let d=me(t,c,function(u){return function(...h){let f=u.apply(this,h);if(Mr(f,o,this),!te(this.canvas,i,n,!0)){let p=Zt([...h],o,this),g={type:e,property:c,args:p};r(this.canvas,g)}return f}});a.push(d)}catch{let u=Pe(t,c,{set(h){r(this.canvas,{type:e,property:c,args:[h],setter:!0})}});a.push(u)}return a}function Yi(t,e,r,i,n){let s=[];return s.push(...Hi(e.WebGLRenderingContext.prototype,pe.WebGL,t,r,i,n,e)),typeof e.WebGL2RenderingContext<"u"&&s.push(...Hi(e.WebGL2RenderingContext.prototype,pe.WebGL2,t,r,i,n,e)),()=>{s.forEach(o=>o())}}function Ds(t,e){var r=atob(t);if(e){for(var i=new Uint8Array(r.length),n=0,s=r.length;n<s;++n)i[n]=r.charCodeAt(n);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return r}function ks(t,e,r){var i=e===void 0?null:e,n=r===void 0?!1:r,s=Ds(t,n),o=s.indexOf(`
`,10)+1,a=s.substring(o)+(i?"//# sourceMappingURL="+i:""),l=new Blob([a],{type:"application/javascript"});return URL.createObjectURL(l)}function Zi(t,e,r){var i;return function(s){return i=i||ks(t,e,r),new Worker(i,s)}}var zi=Zi("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCiAgICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4NCg0KICAgIFBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueQ0KICAgIHB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC4NCg0KICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIDQogICAgUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZDQogICAgQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULA0KICAgIElORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTQ0KICAgIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SDQogICAgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUg0KICAgIFBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuDQogICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi8NCg0KICAgIGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHsNCiAgICAgICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9DQogICAgICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KICAgICAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQ0KICAgICAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbInRocm93Il0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQ0KICAgICAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH0NCiAgICAgICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTsNCiAgICAgICAgfSk7DQogICAgfQoKICAgIC8qCiAgICAgKiBiYXNlNjQtYXJyYXlidWZmZXIgMS4wLjEgPGh0dHBzOi8vZ2l0aHViLmNvbS9uaWtsYXN2aC9iYXNlNjQtYXJyYXlidWZmZXI+CiAgICAgKiBDb3B5cmlnaHQgKGMpIDIwMjEgTmlrbGFzIHZvbiBIZXJ0emVuIDxodHRwczovL2hlcnR6ZW4uY29tPgogICAgICogUmVsZWFzZWQgdW5kZXIgTUlUIExpY2Vuc2UKICAgICAqLwogICAgdmFyIGNoYXJzID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nOwogICAgLy8gVXNlIGEgbG9va3VwIHRhYmxlIHRvIGZpbmQgdGhlIGluZGV4LgogICAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAndW5kZWZpbmVkJyA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogICAgfQogICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChhcnJheWJ1ZmZlcikgewogICAgICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaSwgbGVuID0gYnl0ZXMubGVuZ3RoLCBiYXNlNjQgPSAnJzsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDMpIHsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2ldID4+IDJdOwogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbKChieXRlc1tpXSAmIDMpIDw8IDQpIHwgKGJ5dGVzW2kgKyAxXSA+PiA0KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2kgKyAxXSAmIDE1KSA8PCAyKSB8IChieXRlc1tpICsgMl0gPj4gNildOwogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaSArIDJdICYgNjNdOwogICAgICAgIH0KICAgICAgICBpZiAobGVuICUgMyA9PT0gMikgewogICAgICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAxKSArICc9JzsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAobGVuICUgMyA9PT0gMSkgewogICAgICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAyKSArICc9PSc7CiAgICAgICAgfQogICAgICAgIHJldHVybiBiYXNlNjQ7CiAgICB9OwoKICAgIGNvbnN0IGxhc3RCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGNvbnN0IHRyYW5zcGFyZW50QmxvYk1hcCA9IG5ldyBNYXAoKTsNCiAgICBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7DQogICAgICAgICAgICBpZiAoJ09mZnNjcmVlbkNhbnZhcycgaW4gZ2xvYmFsVGhpcykgew0KICAgICAgICAgICAgICAgIGlmICh0cmFuc3BhcmVudEJsb2JNYXAuaGFzKGlkKSkNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zcGFyZW50QmxvYk1hcC5nZXQoaWQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG9mZnNjcmVlbiA9IG5ldyBPZmZzY3JlZW5DYW52YXMod2lkdGgsIGhlaWdodCk7DQogICAgICAgICAgICAgICAgb2Zmc2NyZWVuLmdldENvbnRleHQoJzJkJyk7DQogICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IHlpZWxkIG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IHlpZWxkIGJsb2IuYXJyYXlCdWZmZXIoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBiYXNlNjQgPSBlbmNvZGUoYXJyYXlCdWZmZXIpOw0KICAgICAgICAgICAgICAgIHRyYW5zcGFyZW50QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJhc2U2NDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KICAgIGNvbnN0IHdvcmtlciA9IHNlbGY7DQogICAgd29ya2VyLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7DQogICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7DQogICAgICAgICAgICBpZiAoJ09mZnNjcmVlbkNhbnZhcycgaW4gZ2xvYmFsVGhpcykgew0KICAgICAgICAgICAgICAgIGNvbnN0IHsgaWQsIGJpdG1hcCwgd2lkdGgsIGhlaWdodCwgZHgsIGR5LCBkdywgZGgsIGRhdGFVUkxPcHRpb25zIH0gPSBlLmRhdGE7DQogICAgICAgICAgICAgICAgY29uc3QgdHJhbnNwYXJlbnRCYXNlNjQgPSBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG9mZnNjcmVlbiA9IG5ldyBPZmZzY3JlZW5DYW52YXMod2lkdGgsIGhlaWdodCk7DQogICAgICAgICAgICAgICAgY29uc3QgY3R4ID0gb2Zmc2NyZWVuLmdldENvbnRleHQoJzJkJyk7DQogICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShiaXRtYXAsIDAsIDAsIHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGJpdG1hcC5jbG9zZSgpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJsb2IgPSB5aWVsZCBvZmZzY3JlZW4uY29udmVydFRvQmxvYihkYXRhVVJMT3B0aW9ucyk7DQogICAgICAgICAgICAgICAgY29uc3QgdHlwZSA9IGJsb2IudHlwZTsNCiAgICAgICAgICAgICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IHlpZWxkIGJsb2IuYXJyYXlCdWZmZXIoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBiYXNlNjQgPSBlbmNvZGUoYXJyYXlCdWZmZXIpOw0KICAgICAgICAgICAgICAgIGlmICghbGFzdEJsb2JNYXAuaGFzKGlkKSAmJiAoeWllbGQgdHJhbnNwYXJlbnRCYXNlNjQpID09PSBiYXNlNjQpIHsNCiAgICAgICAgICAgICAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChsYXN0QmxvYk1hcC5nZXQoaWQpID09PSBiYXNlNjQpDQogICAgICAgICAgICAgICAgICAgIHJldHVybiB3b3JrZXIucG9zdE1lc3NhZ2UoeyBpZCB9KTsNCiAgICAgICAgICAgICAgICB3b3JrZXIucG9zdE1lc3NhZ2Uoew0KICAgICAgICAgICAgICAgICAgICBpZCwNCiAgICAgICAgICAgICAgICAgICAgdHlwZSwNCiAgICAgICAgICAgICAgICAgICAgYmFzZTY0LA0KICAgICAgICAgICAgICAgICAgICB3aWR0aCwNCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0LA0KICAgICAgICAgICAgICAgICAgICBkeCwNCiAgICAgICAgICAgICAgICAgICAgZHksDQogICAgICAgICAgICAgICAgICAgIGR3LA0KICAgICAgICAgICAgICAgICAgICBkaCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=",null,!1);var zt=class{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(c,d)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(c)||this.pendingCanvasMutations.set(c,[]),this.pendingCanvasMutations.get(c).push(d)};let{sampling:r="all",win:i,blockClass:n,blockSelector:s,recordCanvas:o,recordVideos:a,dataURLOptions:l}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,this.logger=e.logger,o&&r==="all"&&this.initCanvasMutationObserver(i,n,s),o&&typeof r=="number"&&this.initCanvasFPSObserver(a,r,i,n,s,{dataURLOptions:l},e.resizeFactor,e.maxSnapshotDimension)}debug(e,...r){if(!this.logger)return;let i=`[highlight-${e.tagName.toLowerCase()}]`;e.tagName.toLowerCase()==="canvas"&&(i+=` [ctx:${e.__context}]`),this.logger.debug(i,e,...r)}initCanvasFPSObserver(e,r,i,n,s,o,a,l){let c=_r(i,n,s),d=new Map,u=new zi;u.onmessage=y=>{let{id:E}=y.data;if(d.set(E,!1),!("base64"in y.data))return;let{base64:S,type:A,dx:C,dy:T,dw:b,dh:x}=y.data;this.mutationCb({id:E,type:pe["2D"],commands:[{property:"clearRect",args:[C,T,b,x]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:S}],type:A}]},C,T,b,x]}]})};let h=1e3/r,f=0,p,g=()=>{let y=[];return i.document.querySelectorAll("canvas").forEach(E=>{te(E,n,s,!0)||(this.debug(E,"discovered canvas"),y.push(E))}),y},v=()=>{let y=[];return e&&i.document.querySelectorAll("video").forEach(E=>{E.src!==""&&E.src.indexOf("blob:")===-1||te(E,n,s,!0)||y.push(E)}),y},m=y=>le(this,void 0,void 0,function*(){if(f&&y-f<h){p=requestAnimationFrame(m);return}f=y;let E=[];E.push(...g().map(S=>le(this,void 0,void 0,function*(){var A;this.debug(S,"starting snapshotting");let C=this.mirror.getId(S);if(d.get(C)){this.debug(S,"snapshotting already in progress for",C);return}d.set(C,!0);try{if(["webgl","webgl2"].includes(S.__context)){let P=S.getContext(S.__context);((A=P?.getContextAttributes())===null||A===void 0?void 0:A.preserveDrawingBuffer)===!1&&P?.clear(P.COLOR_BUFFER_BIT)}if(S.width===0||S.height===0){this.debug(S,"not yet ready",{width:S.width,height:S.height});return}let T=a||1;if(l){let P=Math.max(S.width,S.height);T=Math.min(T,l/P)}let b=S.width*T,x=S.height*T,L=yield createImageBitmap(S,{resizeWidth:b,resizeHeight:x});this.debug(S,"created image bitmap"),u.postMessage({id:C,bitmap:L,width:b,height:x,dx:0,dy:0,dw:S.width,dh:S.height,dataURLOptions:o.dataURLOptions},[L]),this.debug(S,"sent message")}catch(T){this.debug(S,"failed to snapshot",T)}finally{d.set(C,!1)}}))),E.push(...v().map(S=>le(this,void 0,void 0,function*(){this.debug(S,"starting video snapshotting");let A=this.mirror.getId(S);if(d.get(A)){this.debug(S,"video snapshotting already in progress for",A);return}d.set(A,!0);try{let{width:C,height:T}=S.getBoundingClientRect(),{actualWidth:b,actualHeight:x}={actualWidth:S.videoWidth,actualHeight:S.videoHeight},L=Math.max(b,x),P=a||1;l&&(P=Math.min(P,l/L));let Z=b*P,G=x*P,V=yield createImageBitmap(S,{resizeWidth:Z,resizeHeight:G}),D=Math.max(C,T)/L,F=b*D,H=x*D,B=(C-F)/2,w=(T-H)/2;this.debug(S,"created image bitmap",{actualWidth:b,actualHeight:x,boxWidth:C,boxHeight:T,outputWidth:F,outputHeight:H,resizeWidth:Z,resizeHeight:G,scale:P,outputScale:D,offsetX:B,offsetY:w}),u.postMessage({id:A,bitmap:V,width:Z,height:G,dx:B,dy:w,dw:F,dh:H,dataURLOptions:o.dataURLOptions},[V]),this.debug(S,"send message")}catch(C){this.debug(S,"failed to snapshot",C)}finally{d.set(A,!1)}}))),yield Promise.all(E),p=requestAnimationFrame(m)});p=requestAnimationFrame(m),this.resetObservers=()=>{c(),cancelAnimationFrame(p)}}initCanvasMutationObserver(e,r,i){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();let n=_r(e,r,i),s=Gi(this.processMutation.bind(this),e,r,i),o=Yi(this.processMutation.bind(this),e,r,i,this.mirror);this.resetObservers=()=>{n(),s(),o()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){let e=r=>{this.rafStamps.latestId=r,requestAnimationFrame(e)};requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,r)=>{let i=this.mirror.getId(r);this.flushPendingCanvasMutationFor(r,i)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,r){if(this.frozen||this.locked)return;let i=this.pendingCanvasMutations.get(e);if(!i||r===-1)return;let n=i.map(o=>Pi(o,["type"])),{type:s}=i[0];this.mutationCb({id:r,type:s,commands:n}),this.pendingCanvasMutations.delete(e)}};var Kt=class{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new Xe,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,r){"_cssText"in r.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:r.id,attributes:r.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,r){if(e.length===0)return;let i={id:r,styleIds:[]},n=[];for(let s of e){let o;if(this.styleMirror.has(s))o=this.styleMirror.getId(s);else{o=this.styleMirror.add(s);let a=Array.from(s.rules||CSSRule);n.push({styleId:o,rules:a.map((l,c)=>({rule:hr(l),index:c}))})}i.styleIds.push(o)}n.length>0&&(i.styles=n),this.adoptedStyleSheetCb(i)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}};var jt=class{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(e,r){let i=this.nodeMap.get(e);return i&&Array.from(i).some(n=>n!==r)}add(e,r){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(r))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}};function ne(t){return Object.assign(Object.assign({},t),{timestamp:Date.now()})}var ie,Xt,Dr,qt=!1,be=_t();function We(t={}){var e,r,i,n,s;let{emit:o,checkoutEveryNms:a,checkoutEveryNth:l,blockClass:c="highlight-block",blockSelector:d=null,ignoreClass:u="highlight-ignore",maskTextClass:h="highlight-mask",maskTextSelector:f=null,inlineStylesheet:p=!0,maskAllInputs:g,maskInputOptions:v,slimDOMOptions:m,maskInputFn:y,maskTextFn:E=dt,hooks:S,packFn:A,sampling:C={},mousemoveWait:T,recordCanvas:b=!1,recordCrossOriginIframes:x=!1,recordAfter:L=t.recordAfter==="DOMContentLoaded"?t.recordAfter:"load",userTriggeredOnInput:P=!1,collectFonts:Z=!1,inlineImages:G=!1,plugins:V,keepIframeSrcFn:D=()=>!1,enableStrictPrivacy:F=!1,ignoreCSSAttributes:H=new Set([]),errorHandler:B,logger:w}=t,I=Object.assign(Object.assign({},t.dataURLOptions),(r=(e=t.sampling)===null||e===void 0?void 0:e.canvas)===null||r===void 0?void 0:r.dataURLOptions);ki(B);let M=x?window.parent===window:!0,k=!1;if(!M)try{window.parent.document&&(k=!1)}catch{k=!0}if(M&&!o)throw new Error("emit function is required");T!==void 0&&C.mousemove===void 0&&(C.mousemove=T),be.reset();let _=g===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:v!==void 0?v:{password:!0},X=m===!0||m==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:m==="all",headMetaDescKeywords:m==="all"}:m||{};mt();let q,ce=0,ve=U=>{for(let Ce of V||[])Ce.eventProcessor&&(U=Ce.eventProcessor(U));return A&&!k&&(U=A(U)),U};ie=(U,Ce)=>{var $;if(!(($=Ue[0])===null||$===void 0)&&$.isFrozen()&&U.type!==R.FullSnapshot&&!(U.type===R.IncrementalSnapshot&&U.data.source===N.Mutation)&&Ue.forEach(de=>de.unfreeze()),M)o?.(ve(U),Ce);else if(k){let de={type:"rrweb",event:ve(U),origin:window.location.origin,isCheckout:Ce};window.parent.postMessage(de,"*")}if(U.type===R.FullSnapshot)q=U,ce=0;else if(U.type===R.IncrementalSnapshot){if(U.data.source===N.Mutation&&U.data.isAttachIframe)return;ce++;let de=l&&ce>=l,Ye=a&&U.timestamp-q.timestamp>a;(de||Ye)&&Xt(!0)}};let fe=U=>{ie(ne({type:R.IncrementalSnapshot,data:Object.assign({source:N.Mutation},U)}))},xe=U=>ie(ne({type:R.IncrementalSnapshot,data:Object.assign({source:N.Scroll},U)})),Le=U=>ie(ne({type:R.IncrementalSnapshot,data:Object.assign({source:N.CanvasMutation},U)})),Fe=U=>ie(ne({type:R.IncrementalSnapshot,data:Object.assign({source:N.AdoptedStyleSheet},U)})),oe=new Kt({mutationCb:fe,adoptedStyleSheetCb:Fe}),ye=new Gt({mirror:be,mutationCb:fe,stylesheetManager:oe,recordCrossOriginIframes:x,wrappedEmit:ie});for(let U of V||[])U.getMirror&&U.getMirror({nodeMirror:be,crossOriginIframeMirror:ye.crossOriginIframeMirror,crossOriginIframeStyleMirror:ye.crossOriginIframeStyleMirror});let Te=new jt;Dr=new zt({recordCanvas:b,recordVideos:G,mutationCb:Le,win:window,blockClass:c,blockSelector:d,mirror:be,sampling:(i=C?.canvas)===null||i===void 0?void 0:i.fps,dataURLOptions:I,resizeFactor:(n=C?.canvas)===null||n===void 0?void 0:n.resizeFactor,maxSnapshotDimension:(s=C?.canvas)===null||s===void 0?void 0:s.maxSnapshotDimension,logger:w});let Ie=new Ht({mutationCb:fe,scrollCb:xe,bypassOptions:{blockClass:c,blockSelector:d,maskTextClass:h,maskTextSelector:f,inlineStylesheet:p,maskInputOptions:_,dataURLOptions:I,maskTextFn:E,maskInputFn:y,recordCanvas:b,inlineImages:G,enableStrictPrivacy:F,sampling:C,slimDOMOptions:X,iframeManager:ye,stylesheetManager:oe,canvasManager:Dr,keepIframeSrcFn:D,processedNodeManager:Te},mirror:be});Xt=(U=!1)=>{ie(ne({type:R.Meta,data:{href:window.location.href,width:ft(),height:ht()}}),U),oe.reset(),Ie.init(),Ue.forEach($=>$.lock());let Ce=Ci(document,{mirror:be,blockClass:c,blockSelector:d,maskTextClass:h,maskTextSelector:f,inlineStylesheet:p,maskAllInputs:_,maskTextFn:E,slimDOM:X,dataURLOptions:I,recordCanvas:b,inlineImages:G,enableStrictPrivacy:F,onSerialize:$=>{_e($,be)&&ye.addIframe($),gt($,be)&&oe.trackLinkElement($),Se($)&&Ie.addShadowRoot($.shadowRoot,document)},onIframeLoad:($,de)=>{ye.attachIframe($,de),Ie.observeAttachShadow($)},onStylesheetLoad:($,de)=>{oe.attachLinkElement($,de)},keepIframeSrcFn:D});if(!Ce)return console.warn("Failed to snapshot the document");ie(ne({type:R.FullSnapshot,data:{node:Ce,initialOffset:ut(window)}}),U),Ue.forEach($=>$.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&oe.adoptStyleSheets(document.adoptedStyleSheets,be.getId(document))};try{let U=[],Ce=de=>{var Ye;return W(Fi)({mutationCb:fe,mousemoveCb:(ee,lr)=>ie(ne({type:R.IncrementalSnapshot,data:{source:lr,positions:ee}})),mouseInteractionCb:ee=>ie(ne({type:R.IncrementalSnapshot,data:Object.assign({source:N.MouseInteraction},ee)})),scrollCb:xe,viewportResizeCb:ee=>ie(ne({type:R.IncrementalSnapshot,data:Object.assign({source:N.ViewportResize},ee)})),inputCb:ee=>ie(ne({type:R.IncrementalSnapshot,data:Object.assign({source:N.Input},ee)})),mediaInteractionCb:ee=>ie(ne({type:R.IncrementalSnapshot,data:Object.assign({source:N.MediaInteraction},ee)})),styleSheetRuleCb:ee=>ie(ne({type:R.IncrementalSnapshot,data:Object.assign({source:N.StyleSheetRule},ee)})),styleDeclarationCb:ee=>ie(ne({type:R.IncrementalSnapshot,data:Object.assign({source:N.StyleDeclaration},ee)})),canvasMutationCb:Le,fontCb:ee=>ie(ne({type:R.IncrementalSnapshot,data:Object.assign({source:N.Font},ee)})),selectionCb:ee=>{ie(ne({type:R.IncrementalSnapshot,data:Object.assign({source:N.Selection},ee)}))},blockClass:c,ignoreClass:u,maskTextClass:h,maskTextSelector:f,maskInputOptions:_,inlineStylesheet:p,sampling:C,recordCanvas:b,inlineImages:G,userTriggeredOnInput:P,collectFonts:Z,doc:de,maskInputFn:y,maskTextFn:E,keepIframeSrcFn:D,blockSelector:d,slimDOMOptions:X,dataURLOptions:I,mirror:be,iframeManager:ye,stylesheetManager:oe,shadowDomManager:Ie,processedNodeManager:Te,canvasManager:Dr,ignoreCSSAttributes:H,enableStrictPrivacy:F,plugins:((Ye=V?.filter(ee=>ee.observer))===null||Ye===void 0?void 0:Ye.map(ee=>({observer:ee.observer,options:ee.options,callback:lr=>ie(ne({type:R.Plugin,data:{plugin:ee.name,payload:lr}}))})))||[]},S)};ye.addLoadListener(de=>{try{U.push(Ce(de.contentDocument))}catch(Ye){console.warn(Ye)}});let $=()=>{Xt(),U.push(Ce(document)),qt=!0};return document.readyState==="interactive"||document.readyState==="complete"?$():(U.push(se("DOMContentLoaded",()=>{ie(ne({type:R.DomContentLoaded,data:{}})),L==="DOMContentLoaded"&&$()})),U.push(se("load",()=>{ie(ne({type:R.Load,data:{}})),L==="load"&&$()},window))),()=>{U.forEach(de=>de()),Te.destroy(),qt=!1,Oi()}}catch(U){console.warn(U)}}We.addCustomEvent=(t,e)=>{qt&&ie(ne({type:R.Custom,data:{tag:t,payload:e}}))};We.freezePage=()=>{Ue.forEach(t=>t.freeze())};We.takeFullSnapshot=t=>{if(!qt)throw new Error("please take full snapshot after start recording");Xt(t)};We.mirror=be;var Y;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(Y||(Y={}));var Os=function(){function t(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return t.prototype.getId=function(e){var r;if(!e)return-1;var i=(r=this.getMeta(e))===null||r===void 0?void 0:r.id;return i??-1},t.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},t.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},t.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},t.prototype.removeNodeFromMap=function(e){var r=this,i=this.getId(e);this.idNodeMap.delete(i),e.childNodes&&e.childNodes.forEach(function(n){return r.removeNodeFromMap(n)})},t.prototype.has=function(e){return this.idNodeMap.has(e)},t.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},t.prototype.add=function(e,r){var i=r.id;this.idNodeMap.set(i,e),this.nodeMetaMap.set(e,r)},t.prototype.replace=function(e,r){var i=this.getNode(e);if(i){var n=this.nodeMetaMap.get(i);n&&this.nodeMetaMap.set(r,n)}this.idNodeMap.set(e,r)},t.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},t}();function xs(){return new Os}function Ls(t){let e={},r=/;(?![^(]*\))/g,i=/:(.+)/,n=/\/\*.*?\*\//g;return t.replace(n,"").split(r).forEach(function(s){if(s){let o=s.split(i);o.length>1&&(e[kr(o[0].trim())]=o[1].trim())}}),e}function Ki(t){let e=[];for(let r in t){let i=t[r];if(typeof i!="string")continue;let n=Us(r);e.push(`${n}: ${i};`)}return e.join(" ")}var Fs=/-([a-z])/g,Ps=/^--[a-zA-Z0-9-]+$/,kr=t=>Ps.test(t)?t:t.replace(Fs,(e,r)=>r?r.toUpperCase():""),Bs=/\B([A-Z])/g,Us=t=>t.replace(Bs,"-$1").toLowerCase(),ue=class{constructor(...e){this.parentElement=null,this.parentNode=null,this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null,this.ELEMENT_NODE=re.ELEMENT_NODE,this.TEXT_NODE=re.TEXT_NODE}get childNodes(){let e=[],r=this.firstChild;for(;r;)e.push(r),r=r.nextSibling;return e}contains(e){if(e instanceof ue){if(e.ownerDocument!==this.ownerDocument)return!1;if(e===this)return!0}else return!1;for(;e.parentNode;){if(e.parentNode===this)return!0;e=e.parentNode}return!1}appendChild(e){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(e,r){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(e){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}};function Ws(t){return class ji extends t{constructor(...r){super(r),this.nodeType=re.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=Y.Document,this.textContent=null,this.ownerDocument=this}get documentElement(){return this.childNodes.find(r=>r.RRNodeType===Y.Element&&r.tagName==="HTML")||null}get body(){var r;return((r=this.documentElement)===null||r===void 0?void 0:r.childNodes.find(i=>i.RRNodeType===Y.Element&&i.tagName==="BODY"))||null}get head(){var r;return((r=this.documentElement)===null||r===void 0?void 0:r.childNodes.find(i=>i.RRNodeType===Y.Element&&i.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(r){let i=r.RRNodeType;if((i===Y.Element||i===Y.DocumentType)&&this.childNodes.some(s=>s.RRNodeType===i))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${i===Y.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);let n=Wr(this,r);return n.parentElement=null,n}insertBefore(r,i){let n=r.RRNodeType;if((n===Y.Element||n===Y.DocumentType)&&this.childNodes.some(o=>o.RRNodeType===n))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${n===Y.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);let s=en(this,r,i);return s.parentElement=null,s}removeChild(r){return tn(this,r)}open(){this.firstChild=null,this.lastChild=null}close(){}write(r){let i;if(r==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?i="-//W3C//DTD XHTML 1.0 Transitional//EN":r==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(i="-//W3C//DTD HTML 4.0 Transitional//EN"),i){let n=this.createDocumentType("html",i,"");this.open(),this.appendChild(n)}}createDocument(r,i,n){return new ji}createDocumentType(r,i,n){let s=new(Xi(ue))(r,i,n);return s.ownerDocument=this,s}createElement(r){let i=new(qi(ue))(r);return i.ownerDocument=this,i}createElementNS(r,i){return this.createElement(i)}createTextNode(r){let i=new(Qi(ue))(r);return i.ownerDocument=this,i}createComment(r){let i=new(Ji(ue))(r);return i.ownerDocument=this,i}createCDATASection(r){let i=new($i(ue))(r);return i.ownerDocument=this,i}toString(){return"RRDocument"}}}function Xi(t){return class extends t{constructor(r,i,n){super(),this.nodeType=re.DOCUMENT_TYPE_NODE,this.RRNodeType=Y.DocumentType,this.name=r,this.publicId=i,this.systemId=n,this.nodeName=r,this.textContent=null}toString(){return"RRDocumentType"}}}function qi(t){return class extends t{constructor(r){super(),this.nodeType=re.ELEMENT_NODE,this.RRNodeType=Y.Element,this.attributes={},this.shadowRoot=null,this.tagName=r.toUpperCase(),this.nodeName=r.toUpperCase()}get textContent(){let r="";return this.childNodes.forEach(i=>r+=i.textContent),r}set textContent(r){this.firstChild=null,this.lastChild=null,this.appendChild(this.ownerDocument.createTextNode(r))}get classList(){return new Or(this.attributes.class,r=>{this.attributes.class=r})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){let r=this.attributes.style?Ls(this.attributes.style):{},i=/\B([A-Z])/g;return r.setProperty=(n,s,o)=>{if(i.test(n))return;let a=kr(n);s?r[a]=s:delete r[a],o==="important"&&(r[a]+=" !important"),this.attributes.style=Ki(r)},r.removeProperty=n=>{if(i.test(n))return"";let s=kr(n),o=r[s]||"";return delete r[s],this.attributes.style=Ki(r),o},r}getAttribute(r){return this.attributes[r]||null}setAttribute(r,i){this.attributes[r]=i}setAttributeNS(r,i,n){this.setAttribute(i,n)}removeAttribute(r){delete this.attributes[r]}appendChild(r){return Wr(this,r)}insertBefore(r,i){return en(this,r,i)}removeChild(r){return tn(this,r)}attachShadow(r){let i=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=i,i}dispatchEvent(r){return!0}toString(){let r="";for(let i in this.attributes)r+=`${i}="${this.attributes[i]}" `;return`${this.tagName} ${r}`}}}function Vs(t){return class extends t{attachShadow(r){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}function Qi(t){return class extends t{constructor(r){super(),this.nodeType=re.TEXT_NODE,this.nodeName="#text",this.RRNodeType=Y.Text,this.data=r}get textContent(){return this.data}set textContent(r){this.data=r}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function Ji(t){return class extends t{constructor(r){super(),this.nodeType=re.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=Y.Comment,this.data=r}get textContent(){return this.data}set textContent(r){this.data=r}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function $i(t){return class extends t{constructor(r){super(),this.nodeName="#cdata-section",this.nodeType=re.CDATA_SECTION_NODE,this.RRNodeType=Y.CDATA,this.data=r}get textContent(){return this.data}set textContent(r){this.data=r}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}var Or=class{constructor(e,r){if(this.classes=[],this.add=(...i)=>{for(let n of i){let s=String(n);this.classes.indexOf(s)>=0||this.classes.push(s)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...i)=>{this.classes=this.classes.filter(n=>i.indexOf(n)===-1),this.onChange&&this.onChange(this.classes.join(" "))},e){let i=e.trim().split(/\s+/);this.classes.push(...i)}this.onChange=r}};function Wr(t,e){return e.parentNode&&e.parentNode.removeChild(e),t.lastChild?(t.lastChild.nextSibling=e,e.previousSibling=t.lastChild):(t.firstChild=e,e.previousSibling=null),t.lastChild=e,e.nextSibling=null,e.parentNode=t,e.parentElement=t,e.ownerDocument=t.ownerDocument,e}function en(t,e,r){if(!r)return Wr(t,e);if(r.parentNode!==t)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return e===r||(e.parentNode&&e.parentNode.removeChild(e),e.previousSibling=r.previousSibling,r.previousSibling=e,e.nextSibling=r,e.previousSibling?e.previousSibling.nextSibling=e:t.firstChild=e,e.parentElement=t,e.parentNode=t,e.ownerDocument=t.ownerDocument),e}function tn(t,e){if(e.parentNode!==t)throw new Error("Failed to execute 'removeChild' on 'RRNode': The RRNode to be removed is not a child of this RRNode.");return e.previousSibling?e.previousSibling.nextSibling=e.nextSibling:t.firstChild=e.nextSibling,e.nextSibling?e.nextSibling.previousSibling=e.previousSibling:t.lastChild=e.previousSibling,e.previousSibling=null,e.nextSibling=null,e.parentElement=null,e.parentNode=null,e}var re;(function(t){t[t.PLACEHOLDER=0]="PLACEHOLDER",t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",t[t.TEXT_NODE=3]="TEXT_NODE",t[t.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",t[t.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",t[t.ENTITY_NODE=6]="ENTITY_NODE",t[t.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",t[t.COMMENT_NODE=8]="COMMENT_NODE",t[t.DOCUMENT_NODE=9]="DOCUMENT_NODE",t[t.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",t[t.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})(re||(re={}));var xr={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},Gs={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"},ge=null;function Ee(t,e,r,i=e.mirror||e.ownerDocument.mirror){t=Hs(t,e,r,i);let n=t.childNodes,s=e.childNodes;(n.length>0||s.length>0)&&rn(Array.from(n),s,t,r,i),Ys(t,e,r,i)}function Hs(t,e,r,i){var n;if(r.afterAppend&&!ge&&(ge=new WeakSet,setTimeout(()=>{ge=null},0)),!Vr(t,e)){let s=Et(e,r.mirror,i);(n=t.parentNode)===null||n===void 0||n.replaceChild(s,t),t=s}switch(e.RRNodeType){case Y.Document:{if(!st(t,e,r.mirror,i)){let s=i.getMeta(e);s&&(r.mirror.removeNodeFromMap(t),t.close(),t.open(),r.mirror.add(t,s),ge?.add(t))}break}case Y.Element:{let s=t,o=e;switch(o.tagName){case"IFRAME":{let a=t.contentDocument;if(!a)break;Ee(a,e.contentDocument,r,i);break}}if(o.shadowRoot){s.shadowRoot||s.attachShadow({mode:"open"});let a=s.shadowRoot.childNodes,l=o.shadowRoot.childNodes;(a.length>0||l.length>0)&&rn(Array.from(a),l,s.shadowRoot,r,i)}break}}return t}function Ys(t,e,r,i){var n;switch(e.RRNodeType){case Y.Document:{let s=e.scrollData;s&&r.applyScroll(s,!0);break}case Y.Element:{let s=t,o=e;switch(Zs(s,o,i),o.scrollData&&r.applyScroll(o.scrollData,!0),o.inputData&&r.applyInput(o.inputData),o.tagName){case"AUDIO":case"VIDEO":{let a=t,l=o;l.paused!==void 0&&(l.paused?a.pause():a.play()),l.muted!==void 0&&(a.muted=l.muted),l.volume!==void 0&&(a.volume=l.volume),l.currentTime!==void 0&&(a.currentTime=l.currentTime),l.playbackRate!==void 0&&(a.playbackRate=l.playbackRate);break}case"CANVAS":{let a=e;if(a.rr_dataURL!==null){let l=document.createElement("img");l.onload=()=>{let c=s.getContext("2d");c&&c.drawImage(l,0,0,l.width,l.height)},l.src=a.rr_dataURL}a.canvasMutations.forEach(l=>r.applyCanvas(l.event,l.mutation,t));break}case"STYLE":{let a=s.sheet;a&&e.rules.forEach(l=>r.applyStyleSheetMutation(l,a));break}}break}case Y.Text:case Y.Comment:case Y.CDATA:{t.textContent!==e.data&&(t.textContent=e.data);break}}ge?.has(t)&&(ge.delete(t),(n=r.afterAppend)===null||n===void 0||n.call(r,t,r.mirror.getId(t)))}function Zs(t,e,r){let i=t.attributes,n=e.attributes;for(let s in n){let o=n[s],a=r.getMeta(e);if(a?.isSVG&&xr[s])t.setAttributeNS(xr[s],s,o);else if(e.tagName==="CANVAS"&&s==="rr_dataURL"){let l=document.createElement("img");l.src=o,l.onload=()=>{let c=t.getContext("2d");c&&c.drawImage(l,0,0,l.width,l.height)}}else t.setAttribute(s,o)}for(let{name:s}of Array.from(i))s in n||t.removeAttribute(s);e.scrollLeft&&(t.scrollLeft=e.scrollLeft),e.scrollTop&&(t.scrollTop=e.scrollTop)}function rn(t,e,r,i,n){let s=0,o=t.length-1,a=0,l=e.length-1,c=t[s],d=t[o],u=e[a],h=e[l],f,p;for(;s<=o&&a<=l;)if(c===void 0)c=t[++s];else if(d===void 0)d=t[--o];else if(st(c,u,i.mirror,n))Ee(c,u,i,n),c=t[++s],u=e[++a];else if(st(d,h,i.mirror,n))Ee(d,h,i,n),d=t[--o],h=e[--l];else if(st(c,h,i.mirror,n)){try{r.insertBefore(c,d.nextSibling)}catch(g){console.warn(g)}Ee(c,h,i,n),c=t[++s],h=e[--l]}else if(st(d,u,i.mirror,n)){try{r.insertBefore(d,c)}catch(g){console.warn(g)}Ee(d,u,i,n),d=t[--o],u=e[++a]}else{if(!f){f={};for(let v=s;v<=o;v++){let m=t[v];m&&i.mirror.hasNode(m)&&(f[i.mirror.getId(m)]=v)}}p=f[n.getId(u)];let g=t[p];if(p!==void 0&&g&&st(g,u,i.mirror,n)){try{r.insertBefore(g,c)}catch(v){console.warn(v)}Ee(g,u,i,n),t[p]=void 0}else{let v=Et(u,i.mirror,n);r.nodeName==="#document"&&c&&(v.nodeType===v.DOCUMENT_TYPE_NODE&&c.nodeType===c.DOCUMENT_TYPE_NODE||v.nodeType===v.ELEMENT_NODE&&c.nodeType===c.ELEMENT_NODE)&&(r.removeChild(c),i.mirror.removeNodeFromMap(c),c=t[++s]);try{r.insertBefore(v,c||null),Ee(v,u,i,n)}catch(m){console.warn(m)}}u=e[++a]}if(s>o){let g=e[l+1],v=null;for(g&&(v=i.mirror.getNode(n.getId(g)));a<=l;++a){let m=Et(e[a],i.mirror,n);try{r.insertBefore(m,v),Ee(m,e[a],i,n)}catch(y){console.warn(y)}}}else if(a>l)for(;s<=o;s++){let g=t[s];if(!(!g||g.parentNode!==r))try{r.removeChild(g),i.mirror.removeNodeFromMap(g)}catch(v){console.warn(v)}}}function Et(t,e,r){let i=r.getId(t),n=r.getMeta(t),s=null;if(i>-1&&(s=e.getNode(i)),s!==null&&Vr(s,t))return s;switch(t.RRNodeType){case Y.Document:s=new Document;break;case Y.DocumentType:s=document.implementation.createDocumentType(t.name,t.publicId,t.systemId);break;case Y.Element:{let o=t.tagName.toLowerCase();o=Gs[o]||o,n&&"isSVG"in n&&n?.isSVG?s=document.createElementNS(xr.svg,o):s=document.createElement(t.tagName);break}case Y.Text:s=document.createTextNode(t.data);break;case Y.Comment:s=document.createComment(t.data);break;case Y.CDATA:s=document.createCDATASection(t.data);break}n&&e.add(s,Object.assign({},n));try{ge?.add(s)}catch{}return s}function Vr(t,e){return t.nodeType!==e.nodeType?!1:t.nodeType!==t.ELEMENT_NODE||t.tagName.toUpperCase()===e.tagName}function st(t,e,r,i){let n=r.getId(t),s=i.getId(e);return n===-1||n!==s?!1:Vr(t,e)}var De=class extends Ws(ue){get unserializedId(){return this._unserializedId--}constructor(e){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=Qs(),this.scrollData=null,e&&(this.mirror=e)}createDocument(e,r,i){return new De}createDocumentType(e,r,i){let n=new zs(e,r,i);return n.ownerDocument=this,n}createElement(e){let r=e.toUpperCase(),i;switch(r){case"AUDIO":case"VIDEO":i=new Lr(r);break;case"IFRAME":i=new Br(r,this.mirror);break;case"CANVAS":i=new Fr(r);break;case"STYLE":i=new Pr(r);break;default:i=new Je(r);break}return i.ownerDocument=this,i}createComment(e){let r=new js(e);return r.ownerDocument=this,r}createCDATASection(e){let r=new Xs(e);return r.ownerDocument=this,r}createTextNode(e){let r=new Ks(e);return r.ownerDocument=this,r}destroyTree(){this.firstChild=null,this.lastChild=null,this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}},zs=Xi(ue),Je=class extends qi(ue){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}},Lr=class extends Vs(Je){},Fr=class extends Je{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}},Pr=class extends Je{constructor(){super(...arguments),this.rules=[]}},Br=class extends Je{constructor(e,r){super(e),this.contentDocument=new De,this.contentDocument.mirror=r}},Ks=Qi(ue),js=Ji(ue),Xs=$i(ue);function qs(t){return t instanceof HTMLFormElement?"FORM":t.tagName.toUpperCase()}function Gr(t,e,r,i){let n;switch(t.nodeType){case re.DOCUMENT_NODE:i&&i.nodeName==="IFRAME"?n=i.contentDocument:(n=e,n.compatMode=t.compatMode);break;case re.DOCUMENT_TYPE_NODE:{let o=t;n=e.createDocumentType(o.name,o.publicId,o.systemId);break}case re.ELEMENT_NODE:{let o=t,a=qs(o);n=e.createElement(a);let l=n;for(let{name:c,value:d}of Array.from(o.attributes))l.attributes[c]=d;o.scrollLeft&&(l.scrollLeft=o.scrollLeft),o.scrollTop&&(l.scrollTop=o.scrollTop);break}case re.TEXT_NODE:n=e.createTextNode(t.textContent||"");break;case re.CDATA_SECTION_NODE:n=e.createCDATASection(t.data);break;case re.COMMENT_NODE:n=e.createComment(t.textContent||"");break;case re.DOCUMENT_FRAGMENT_NODE:n=i.attachShadow({mode:"open"});break;default:return null}let s=r.getMeta(t);return e instanceof De&&(s||(s=Hr(n,e.unserializedId),r.add(t,s)),e.mirror.add(n,Object.assign({},s))),n}function nn(t,e=xs(),r=new De){function i(n,s){let o=Gr(n,r,e,s);if(o!==null)if(s?.nodeName!=="IFRAME"&&n.nodeType!==re.DOCUMENT_FRAGMENT_NODE&&(s?.appendChild(o),o.parentNode=s,o.parentElement=s),n.nodeName==="IFRAME"){let a=n.contentDocument;a&&i(a,o)}else(n.nodeType===re.DOCUMENT_NODE||n.nodeType===re.ELEMENT_NODE||n.nodeType===re.DOCUMENT_FRAGMENT_NODE)&&(n.nodeType===re.ELEMENT_NODE&&n.shadowRoot&&i(n.shadowRoot,o),n.childNodes.forEach(a=>i(a,o)))}return i(t,null),r}function Qs(){return new Ur}var Ur=class{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var r;if(!e)return-1;let i=(r=this.getMeta(e))===null||r===void 0?void 0:r.id;return i??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let r=this.getId(e);this.idNodeMap.delete(r),e.childNodes&&e.childNodes.forEach(i=>this.removeNodeFromMap(i))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,r){let i=r.id;this.idNodeMap.set(i,e),this.nodeMetaMap.set(e,r)}replace(e,r){let i=this.getNode(e);if(i){let n=this.nodeMetaMap.get(i);n&&this.nodeMetaMap.set(r,n)}this.idNodeMap.set(e,r)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function Hr(t,e){switch(t.RRNodeType){case Y.Document:return{id:e,type:t.RRNodeType,childNodes:[]};case Y.DocumentType:{let r=t;return{id:e,type:t.RRNodeType,name:r.name,publicId:r.publicId,systemId:r.systemId}}case Y.Element:return{id:e,type:t.RRNodeType,tagName:t.tagName.toLowerCase(),attributes:{},childNodes:[]};case Y.Text:return{id:e,type:t.RRNodeType,textContent:t.textContent||""};case Y.Comment:return{id:e,type:t.RRNodeType,textContent:t.textContent||""};case Y.CDATA:return{id:e,type:t.RRNodeType,textContent:""}}}var{addCustomEvent:Js}=We,{freezePage:$s}=We;var ae=Uint8Array,he=Uint16Array,Nt=Uint32Array,Jt=new ae([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$t=new ae([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Kr=new ae([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ln=function(t,e){for(var r=new he(31),i=0;i<31;++i)r[i]=e+=1<<t[i-1];for(var n=new Nt(r[30]),i=1;i<30;++i)for(var s=r[i];s<r[i+1];++s)n[s]=s-r[i]<<5|i;return[r,n]},cn=ln(Jt,2),dn=cn[0],jr=cn[1];dn[28]=258,jr[258]=28;var un=ln($t,0),eo=un[0],sn=un[1],Xr=new he(32768);for(j=0;j<32768;++j)ke=(j&43690)>>>1|(j&21845)<<1,ke=(ke&52428)>>>2|(ke&13107)<<2,ke=(ke&61680)>>>4|(ke&3855)<<4,Xr[j]=((ke&65280)>>>8|(ke&255)<<8)>>>1;var ke,j,Re=function(t,e,r){for(var i=t.length,n=0,s=new he(e);n<i;++n)++s[t[n]-1];var o=new he(e);for(n=0;n<e;++n)o[n]=o[n-1]+s[n-1]<<1;var a;if(r){a=new he(1<<e);var l=15-e;for(n=0;n<i;++n)if(t[n])for(var c=n<<4|t[n],d=e-t[n],u=o[t[n]-1]++<<d,h=u|(1<<d)-1;u<=h;++u)a[Xr[u]>>>l]=c}else for(a=new he(i),n=0;n<i;++n)a[n]=Xr[o[t[n]-1]++]>>>15-t[n];return a},Ve=new ae(288);for(j=0;j<144;++j)Ve[j]=8;var j;for(j=144;j<256;++j)Ve[j]=9;var j;for(j=256;j<280;++j)Ve[j]=7;var j;for(j=280;j<288;++j)Ve[j]=8;var j,Tt=new ae(32);for(j=0;j<32;++j)Tt[j]=5;var j,to=Re(Ve,9,0),ro=Re(Ve,9,1),io=Re(Tt,5,0),no=Re(Tt,5,1),Yr=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},Ae=function(t,e,r){var i=e/8>>0;return(t[i]|t[i+1]<<8)>>>(e&7)&r},Zr=function(t,e){var r=e/8>>0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>>(e&7)},Qr=function(t){return(t/8>>0)+(t&7&&1)},Jr=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var i=new(t instanceof he?he:t instanceof Nt?Nt:ae)(r-e);return i.set(t.subarray(e,r)),i},so=function(t,e,r){var i=t.length,n=!e||r,s=!r||r.i;r||(r={}),e||(e=new ae(i*3));var o=function(ce){var ve=e.length;if(ce>ve){var fe=new ae(Math.max(ve*2,ce));fe.set(e),e=fe}},a=r.f||0,l=r.p||0,c=r.b||0,d=r.l,u=r.d,h=r.m,f=r.n,p=i*8;do{if(!d){r.f=a=Ae(t,l,1);var g=Ae(t,l+1,3);if(l+=3,g)if(g==1)d=ro,u=no,h=9,f=5;else if(g==2){var E=Ae(t,l,31)+257,S=Ae(t,l+10,15)+4,A=E+Ae(t,l+5,31)+1;l+=14;for(var C=new ae(A),T=new ae(19),b=0;b<S;++b)T[Kr[b]]=Ae(t,l+b*3,7);l+=S*3;var x=Yr(T),L=(1<<x)-1;if(!s&&l+A*(x+7)>p)break;for(var P=Re(T,x,1),b=0;b<A;){var Z=P[Ae(t,l,L)];l+=Z&15;var v=Z>>>4;if(v<16)C[b++]=v;else{var G=0,V=0;for(v==16?(V=3+Ae(t,l,3),l+=2,G=C[b-1]):v==17?(V=3+Ae(t,l,7),l+=3):v==18&&(V=11+Ae(t,l,127),l+=7);V--;)C[b++]=G}}var D=C.subarray(0,E),F=C.subarray(E);h=Yr(D),f=Yr(F),d=Re(D,h,1),u=Re(F,f,1)}else throw"invalid block type";else{var v=Qr(l)+4,m=t[v-4]|t[v-3]<<8,y=v+m;if(y>i){if(s)throw"unexpected EOF";break}n&&o(c+m),e.set(t.subarray(v,y),c),r.b=c+=m,r.p=l=y*8;continue}if(l>p)throw"unexpected EOF"}n&&o(c+131072);for(var H=(1<<h)-1,B=(1<<f)-1,w=h+f+18;s||l+w<p;){var G=d[Zr(t,l)&H],I=G>>>4;if(l+=G&15,l>p)throw"unexpected EOF";if(!G)throw"invalid length/literal";if(I<256)e[c++]=I;else if(I==256){d=null;break}else{var M=I-254;if(I>264){var b=I-257,k=Jt[b];M=Ae(t,l,(1<<k)-1)+dn[b],l+=k}var _=u[Zr(t,l)&B],X=_>>>4;if(!_)throw"invalid distance";l+=_&15;var F=eo[X];if(X>3){var k=$t[X];F+=Zr(t,l)&(1<<k)-1,l+=k}if(l>p)throw"unexpected EOF";n&&o(c+131072);for(var q=c+M;c<q;c+=4)e[c]=e[c-F],e[c+1]=e[c+1-F],e[c+2]=e[c+2-F],e[c+3]=e[c+3-F];c=q}}r.l=d,r.p=l,r.b=c,d&&(a=1,r.m=h,r.d=u,r.n=f)}while(!a);return c==e.length?e:Jr(e,0,c)},Oe=function(t,e,r){r<<=e&7;var i=e/8>>0;t[i]|=r,t[i+1]|=r>>>8},At=function(t,e,r){r<<=e&7;var i=e/8>>0;t[i]|=r,t[i+1]|=r>>>8,t[i+2]|=r>>>16},zr=function(t,e){for(var r=[],i=0;i<t.length;++i)t[i]&&r.push({s:i,f:t[i]});var n=r.length,s=r.slice();if(!n)return[new ae(0),0];if(n==1){var o=new ae(r[0].s+1);return o[r[0].s]=1,[o,1]}r.sort(function(A,C){return A.f-C.f}),r.push({s:-1,f:25001});var a=r[0],l=r[1],c=0,d=1,u=2;for(r[0]={s:-1,f:a.f+l.f,l:a,r:l};d!=n-1;)a=r[r[c].f<r[u].f?c++:u++],l=r[c!=d&&r[c].f<r[u].f?c++:u++],r[d++]={s:-1,f:a.f+l.f,l:a,r:l};for(var h=s[0].s,i=1;i<n;++i)s[i].s>h&&(h=s[i].s);var f=new he(h+1),p=qr(r[d-1],f,0);if(p>e){var i=0,g=0,v=p-e,m=1<<v;for(s.sort(function(C,T){return f[T.s]-f[C.s]||C.f-T.f});i<n;++i){var y=s[i].s;if(f[y]>e)g+=m-(1<<p-f[y]),f[y]=e;else break}for(g>>>=v;g>0;){var E=s[i].s;f[E]<e?g-=1<<e-f[E]++-1:++i}for(;i>=0&&g;--i){var S=s[i].s;f[S]==e&&(--f[S],++g)}p=e}return[new ae(f),p]},qr=function(t,e,r){return t.s==-1?Math.max(qr(t.l,e,r+1),qr(t.r,e,r+1)):e[t.s]=r},on=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new he(++e),i=0,n=t[0],s=1,o=function(l){r[i++]=l},a=1;a<=e;++a)if(t[a]==n&&a!=e)++s;else{if(!n&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(n),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(n);s=1,n=t[a]}return[r.subarray(0,i),e]},wt=function(t,e){for(var r=0,i=0;i<e.length;++i)r+=t[i]*e[i];return r},Qt=function(t,e,r){var i=r.length,n=Qr(e+2);t[n]=i&255,t[n+1]=i>>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var s=0;s<i;++s)t[n+s+4]=r[s];return(n+4+i)*8},an=function(t,e,r,i,n,s,o,a,l,c,d){Oe(e,d++,r),++n[256];for(var u=zr(n,15),h=u[0],f=u[1],p=zr(s,15),g=p[0],v=p[1],m=on(h),y=m[0],E=m[1],S=on(g),A=S[0],C=S[1],T=new he(19),b=0;b<y.length;++b)T[y[b]&31]++;for(var b=0;b<A.length;++b)T[A[b]&31]++;for(var x=zr(T,7),L=x[0],P=x[1],Z=19;Z>4&&!L[Kr[Z-1]];--Z);var G=c+5<<3,V=wt(n,Ve)+wt(s,Tt)+o,D=wt(n,h)+wt(s,g)+o+14+3*Z+wt(T,L)+(2*T[16]+3*T[17]+7*T[18]);if(G<=V&&G<=D)return Qt(e,d,t.subarray(l,l+c));var F,H,B,w;if(Oe(e,d,1+(D<V)),d+=2,D<V){F=Re(h,f,0),H=h,B=Re(g,v,0),w=g;var I=Re(L,P,0);Oe(e,d,E-257),Oe(e,d+5,C-1),Oe(e,d+10,Z-4),d+=14;for(var b=0;b<Z;++b)Oe(e,d+3*b,L[Kr[b]]);d+=3*Z;for(var M=[y,A],k=0;k<2;++k)for(var _=M[k],b=0;b<_.length;++b){var X=_[b]&31;Oe(e,d,I[X]),d+=L[X],X>15&&(Oe(e,d,_[b]>>>5&127),d+=_[b]>>>12)}}else F=to,H=Ve,B=io,w=Tt;for(var b=0;b<a;++b)if(i[b]>255){var X=i[b]>>>18&31;At(e,d,F[X+257]),d+=H[X+257],X>7&&(Oe(e,d,i[b]>>>23&31),d+=Jt[X]);var q=i[b]&31;At(e,d,B[q]),d+=w[q],q>3&&(At(e,d,i[b]>>>5&8191),d+=$t[q])}else At(e,d,F[i[b]]),d+=H[i[b]];return At(e,d,F[256]),d+H[256]},oo=new Nt([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ao=new ae(0),lo=function(t,e,r,i,n,s){var o=t.length,a=new ae(i+o+5*(1+Math.floor(o/7e3))+n),l=a.subarray(i,a.length-n),c=0;if(!e||o<8)for(var d=0;d<=o;d+=65535){var u=d+65535;u<o?c=Qt(l,c,t.subarray(d,u)):(l[d]=s,c=Qt(l,c,t.subarray(d,o)))}else{for(var h=oo[e-1],f=h>>>13,p=h&8191,g=(1<<r)-1,v=new he(32768),m=new he(g+1),y=Math.ceil(r/3),E=2*y,S=function(Te){return(t[Te]^t[Te+1]<<y^t[Te+2]<<E)&g},A=new Nt(25e3),C=new he(288),T=new he(32),b=0,x=0,d=0,L=0,P=0,Z=0;d<o;++d){var G=S(d),V=d&32767,D=m[G];if(v[V]=D,m[G]=V,P<=d){var F=o-d;if((b>7e3||L>24576)&&F>423){c=an(t,l,0,A,C,T,x,L,Z,d-Z,c),L=b=x=0,Z=d;for(var H=0;H<286;++H)C[H]=0;for(var H=0;H<30;++H)T[H]=0}var B=2,w=0,I=p,M=V-D&32767;if(F>2&&G==S(d-M))for(var k=Math.min(f,F)-1,_=Math.min(32767,d),X=Math.min(258,F);M<=_&&--I&&V!=D;){if(t[d+B]==t[d+B-M]){for(var q=0;q<X&&t[d+q]==t[d+q-M];++q);if(q>B){if(B=q,w=M,q>k)break;for(var ce=Math.min(M,q-2),ve=0,H=0;H<ce;++H){var fe=d-M+H+32768&32767,xe=v[fe],Le=fe-xe+32768&32767;Le>ve&&(ve=Le,D=fe)}}}V=D,D=v[V],M+=V-D+32768&32767}if(w){A[L++]=268435456|jr[B]<<18|sn[w];var Fe=jr[B]&31,oe=sn[w]&31;x+=Jt[Fe]+$t[oe],++C[257+Fe],++T[oe],P=d+B,++b}else A[L++]=t[d],++C[t[d]]}}c=an(t,l,s,A,C,T,x,L,Z,d-Z,c),s||(c=Qt(l,c,ao))}return Jr(a,0,i+Qr(c)+n)},co=function(){var t=1,e=0;return{p:function(r){for(var i=t,n=e,s=r.length,o=0;o!=s;){for(var a=Math.min(o+5552,s);o<a;++o)i+=r[o],n+=i;i%=65521,n%=65521}t=i,e=n},d:function(){return(t>>>8<<16|(e&255)<<8|e>>>8)+((t&255)<<23)*2}}},uo=function(t,e,r,i,n){return lo(t,e.level==null?6:e.level,e.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):12+e.mem,r,i,!n)},ho=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},fo=function(t,e){var r=e.level,i=r==0?0:r<6?1:r==9?3:2;t[0]=120,t[1]=i<<6|(i?32-2*i:1)},po=function(t){if((t[0]&15)!=8||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(t[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function hn(t,e){e===void 0&&(e={});var r=co();r.p(t);var i=uo(t,e,2,4);return fo(i,e),ho(i,i.length-4,r.d()),i}function fn(t,e){return so((po(t),t.subarray(2,-4)),e)}function er(t,e){var r=t.length;if(!e&&typeof TextEncoder<"u")return new TextEncoder().encode(t);for(var i=new ae(t.length+(t.length>>>1)),n=0,s=function(c){i[n++]=c},o=0;o<r;++o){if(n+5>i.length){var a=new ae(n+8+(r-o<<1));a.set(i),i=a}var l=t.charCodeAt(o);l<128||e?s(l):l<2048?(s(192|l>>>6),s(128|l&63)):l>55295&&l<57344?(l=65536+(l&1023<<10)|t.charCodeAt(++o)&1023,s(240|l>>>18),s(128|l>>>12&63),s(128|l>>>6&63),s(128|l&63)):(s(224|l>>>12),s(128|l>>>6&63),s(128|l&63))}return Jr(i,0,n)}function tr(t,e){var r="";if(!e&&typeof TextDecoder<"u")return new TextDecoder().decode(t);for(var i=0;i<t.length;){var n=t[i++];n<128||e?r+=String.fromCharCode(n):n<224?r+=String.fromCharCode((n&31)<<6|t[i++]&63):n<240?r+=String.fromCharCode((n&15)<<12|(t[i++]&63)<<6|t[i++]&63):(n=((n&15)<<18|(t[i++]&63)<<12|(t[i++]&63)<<6|t[i++]&63)-65536,r+=String.fromCharCode(55296|n>>10,56320|n&1023))}return r}var Rt="v1";var mo=t=>{let e=Object.assign(Object.assign({},t),{v:Rt});return tr(hn(er(JSON.stringify(e))),!0)};var go=t=>{if(typeof t!="string")return t;try{let e=JSON.parse(t);if(e.timestamp)return e}catch{}try{let e=JSON.parse(tr(fn(er(t,!0))));if(e.v===Rt)return e;throw new Error(`These events were packed with packer ${e.v} which is incompatible with current packer ${Rt}.`)}catch(e){throw console.error(e),new Error("Unknown data format.")}};var Ge=class{constructor(e){this.fileName=e.fileName||"",this.functionName=e.functionName||"",this.lineNumber=e.lineNumber,this.columnNumber=e.columnNumber}toString(){let e=this.lineNumber||"",r=this.columnNumber||"";return this.functionName?`${this.functionName} (${this.fileName}:${e}:${r})`:`${this.fileName}:${e}:${r}`}},vo=/(^|@)\S+:\d+/,pn=/^\s*at .*(\S+:\d+|\(native\))/m,yo=/^(eval@)?(\[native code])?$/,rr={parse:function(t){if(!t)return[];if(typeof t.stacktrace<"u"||typeof t["opera#sourceloc"]<"u")return this.parseOpera(t);if(t.stack&&t.stack.match(pn))return this.parseV8OrIE(t);if(t.stack)return this.parseFFOrSafari(t);throw new Error("Cannot parse given Error object")},extractLocation:function(t){if(t.indexOf(":")===-1)return[t];let r=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(t.replace(/[()]/g,""));if(!r)throw new Error(`Cannot parse given url: ${t}`);return[r[1],r[2]||void 0,r[3]||void 0]},parseV8OrIE:function(t){return t.stack.split(`
`).filter(function(r){return!!r.match(pn)},this).map(function(r){r.indexOf("(eval ")>-1&&(r=r.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let i=r.replace(/^\s+/,"").replace(/\(eval code/g,"("),n=i.match(/ (\((.+):(\d+):(\d+)\)$)/);i=n?i.replace(n[0],""):i;let s=i.split(/\s+/).slice(1),o=this.extractLocation(n?n[1]:s.pop()),a=s.join(" ")||void 0,l=["eval","<anonymous>"].indexOf(o[0])>-1?void 0:o[0];return new Ge({functionName:a,fileName:l,lineNumber:o[1],columnNumber:o[2]})},this)},parseFFOrSafari:function(t){return t.stack.split(`
`).filter(function(r){return!r.match(yo)},this).map(function(r){if(r.indexOf(" > eval")>-1&&(r=r.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),r.indexOf("@")===-1&&r.indexOf(":")===-1)return new Ge({functionName:r});{let i=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=r.match(i),s=n&&n[1]?n[1]:void 0,o=this.extractLocation(r.replace(i,""));return new Ge({functionName:s,fileName:o[0],lineNumber:o[1],columnNumber:o[2]})}},this)},parseOpera:function(t){return!t.stacktrace||t.message.indexOf(`
`)>-1&&t.message.split(`
`).length>t.stacktrace.split(`
`).length?this.parseOpera9(t):t.stack?this.parseOpera11(t):this.parseOpera10(t)},parseOpera9:function(t){let e=/Line (\d+).*script (?:in )?(\S+)/i,r=t.message.split(`
`),i=[];for(let n=2,s=r.length;n<s;n+=2){let o=e.exec(r[n]);o&&i.push(new Ge({fileName:o[2],lineNumber:parseFloat(o[1])}))}return i},parseOpera10:function(t){let e=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=t.stacktrace.split(`
`),i=[];for(let n=0,s=r.length;n<s;n+=2){let o=e.exec(r[n]);o&&i.push(new Ge({functionName:o[3]||void 0,fileName:o[2],lineNumber:parseFloat(o[1])}))}return i},parseOpera11:function(t){return t.stack.split(`
`).filter(function(r){return!!r.match(vo)&&!r.match(/^Error created at/)},this).map(function(r){let i=r.split("@"),n=this.extractLocation(i.pop()),o=(i.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new Ge({functionName:o,fileName:n[0],lineNumber:n[1],columnNumber:n[2]})},this)}};function Io(t){if(!t||!t.outerHTML)return"";let e="";for(;t.parentElement;){let r=t.localName;if(!r)break;r=r.toLowerCase();let i=t.parentElement,n=[];if(i.children&&i.children.length>0)for(let s=0;s<i.children.length;s++){let o=i.children[s];o.localName&&o.localName.toLowerCase&&o.localName.toLowerCase()===r&&n.push(o)}n.length>1&&(r+=`:eq(${n.indexOf(t)})`),e=r+(e?">"+e:""),t=i}return e}function $r(t){return Object.prototype.toString.call(t)==="[object Object]"}function mn(t,e){if(e===0)return!0;let r=Object.keys(t);for(let i of r)if($r(t[i])&&mn(t[i],e-1))return!0;return!1}function $e(t,e){let r={numOfKeysLimit:50,depthOfLimit:4};Object.assign(r,e);let i=[],n=[];return JSON.stringify(t,function(a,l){if(i.length>0){let c=i.indexOf(this);~c?i.splice(c+1):i.push(this),~c?n.splice(c,1/0,a):n.push(a),~i.indexOf(l)&&(i[0]===l?l="[Circular ~]":l="[Circular ~."+n.slice(0,i.indexOf(l)).join(".")+"]")}else i.push(l);if(l===null)return l;if(l===void 0)return"undefined";if(s(l))return o(l);if(l instanceof Event){let c={};for(let d in l){let u=l[d];Array.isArray(u)?c[d]=Io(u.length?u[0]:null):c[d]=u}return c}else{if(l instanceof Node)return l instanceof HTMLElement?l?l.outerHTML:"":l.nodeName;if(l instanceof Error)return l.stack?l.stack+`
End of stack for Error object`:l.name+": "+l.message}return l});function s(a){return!!($r(a)&&Object.keys(a).length>r.numOfKeysLimit||typeof a=="function"||$r(a)&&mn(a,r.depthOfLimit))}function o(a){let l=a.toString();return r.stringLengthLimit&&l.length>r.stringLengthLimit&&(l=`${l.slice(0,r.stringLengthLimit)}...`),l}}var gn={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function Co(t,e,r){let i=r?Object.assign({},gn,r):gn,n=i.logger;if(!n)return()=>{};let s;typeof n=="string"?s=e[n]:s=n;let o=0,a=!1,l=[];if(i.level.includes("error")){let d=h=>{let f=h.message,p=h.error,g=rr.parse(p).map(m=>m.toString()),v=[$e(f,i.stringifyOptions)];t({level:"error",trace:g,payload:v})};e.addEventListener("error",d),l.push(()=>{e.removeEventListener("error",d)});let u=h=>{let f,p;h.reason instanceof Error?(f=h.reason,p=[$e(`Uncaught (in promise) ${f.name}: ${f.message}`,i.stringifyOptions)]):(f=new Error,p=[$e("Uncaught (in promise)",i.stringifyOptions),$e(h.reason,i.stringifyOptions)]);let g=rr.parse(f).map(v=>v.toString());t({level:"error",trace:g,payload:p})};e.addEventListener("unhandledrejection",u),l.push(()=>{e.removeEventListener("unhandledrejection",u)})}for(let d of i.level)l.push(c(s,d));return()=>{l.forEach(d=>d())};function c(d,u){return d[u]?me(d,u,h=>(...f)=>{if(h.apply(this,f),!a){a=!0;try{let p=rr.parse(new Error).map(v=>v.toString()).splice(1),g=f.map(v=>$e(v,i.stringifyOptions));o++,o<i.lengthThreshold?t({level:u,trace:p,payload:g}):o===i.lengthThreshold&&t({level:"warn",trace:[],payload:[$e("The number of log records reached the threshold.")]})}catch(p){h("rrweb logger error:",p,...f)}finally{a=!1}}}):()=>{}}}var ir="rrweb/console@1",So=t=>({name:ir,observer:Co,options:t});var nr="__rrweb_original__",bo={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],replayLogger:void 0},ei=class{constructor(e){this.config=Object.assign(bo,e)}getConsoleLogger(){let e={};for(let r of this.config.level)r==="trace"?e[r]=i=>{(console.log[nr]?console.log[nr]:console.log)(...i.payload.map(s=>JSON.parse(s)),this.formatMessage(i))}:e[r]=i=>{(console[r][nr]?console[r][nr]:console[r])(...i.payload.map(s=>JSON.parse(s)),this.formatMessage(i))};return e}formatMessage(e){if(e.trace.length===0)return"";let r=`
	at `,i=r;return i+=e.trace.join(r),i}},Eo=t=>{let e=t?.replayLogger||new ei(t).getConsoleLogger();return{handler(r,i,n){let s=null;if(r.type===R.IncrementalSnapshot&&r.data.source===N.Log?s=r.data:r.type===R.Plugin&&r.data.plugin===ir&&(s=r.data.payload),s)try{typeof e[s.level]=="function"&&e[s.level](s)}catch(o){n.replayer.config.showWarning&&console.warn(o)}}}};var vn={key:"_sid"},Ao="rrweb/sequential-id@1",wo=t=>{let e=t?Object.assign({},vn,t):vn,r=0;return{name:Ao,eventProcessor(i){return Object.assign(i,{[e.key]:++r}),i},options:e}};var yn={key:"_sid",warnOnMissingId:!0},No=t=>{let{key:e,warnOnMissingId:r}=t?Object.assign({},yn,t):yn,i=1;return{handler(n){if(e in n){let s=n[e];s!==i?console.error(`[sequential-id-plugin]: expect to get an id with value "${i}", but got "${s}"`):i++}else r&&console.warn(`[sequential-id-plugin]: failed to get id in key: "${e}"`)}}};function In(t){let e=new Uint8Array(t);for(let r=0;r<t;r++)e[r]=Math.random()*256|0;return e}function Sn(){if(typeof globalThis>"u")return null;let t={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return t.RTCPeerConnection?t:null}function K(t,e){return Object.defineProperty(t,"code",{value:e,enumerable:!0,configurable:!0}),t}function Cn(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function To(t){console.warn(t)}var we=class{constructor(e={}){if(this._map=new Map,this._id=In(4).toString("hex").slice(0,7),this._doDebug=e.debug,this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||In(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||we.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},we.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(r=>r),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:Sn(),!this._wrtc)throw K(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(r){this.destroy(K(r,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=r=>{this._onIceCandidate(r)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(r=>{this.destroy(K(r,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=r=>{this._setupData(r)},this.streams&&this.streams.forEach(r=>{this.addStream(r)}),this._pc.ontrack=r=>{this._onTrack(r)},this._debug("initial negotiation"),this._needsNegotiation()}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this.destroying){if(this.destroyed)throw K(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof e=="string")try{e=JSON.parse(e)}catch{e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(r=>{this._addIceCandidate(r)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(r=>{this.destroy(K(r,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(K(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){let r=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(r).catch(i=>{!r.address||r.address.endsWith(".local")?To("Ignoring unsupported ICE candidate."):this.destroy(K(i,"ERR_ADD_ICE_CANDIDATE"))})}send(e){if(!this.destroying){if(this.destroyed)throw K(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}addTransceiver(e,r){if(!this.destroying){if(this.destroyed)throw K(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,r),this._needsNegotiation()}catch(i){this.destroy(K(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:r}})}}addStream(e){if(!this.destroying){if(this.destroyed)throw K(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),e.getTracks().forEach(r=>{this.addTrack(r,e)})}}addTrack(e,r){if(this.destroying)return;if(this.destroyed)throw K(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");let i=this._senderMap.get(e)||new Map,n=i.get(r);if(!n)n=this._pc.addTrack(e,r),i.set(r,n),this._senderMap.set(e,i),this._needsNegotiation();else throw n.removed?K(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):K(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,r,i){if(this.destroying)return;if(this.destroyed)throw K(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");let n=this._senderMap.get(e),s=n?n.get(i):null;if(!s)throw K(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");r&&this._senderMap.set(r,n),s.replaceTrack!=null?s.replaceTrack(r):this.destroy(K(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,r){if(this.destroying)return;if(this.destroyed)throw K(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");let i=this._senderMap.get(e),n=i?i.get(r):null;if(!n)throw K(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{n.removed=!0,this._pc.removeTrack(n)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(n):this.destroy(K(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){if(!this.destroying){if(this.destroyed)throw K(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),e.getTracks().forEach(r=>{this.removeTrack(r,e)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,queueMicrotask(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw K(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(e){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),queueMicrotask(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close")}))}_setupData(e){if(!e.channel)return this.destroy(K(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=65536),this.channelName=this._channel.label,this._channel.onmessage=i=>{this._onChannelMessage(i)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=i=>{this.destroy(K(i,"ERR_DATA_CHANNEL"))};let r=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(r&&this._onChannelClose(),r=!0):r=!1},5e3)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Cn(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let r=()=>{if(this.destroyed)return;let s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})},i=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},n=s=>{this.destroy(K(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(K(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Cn(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let r=()=>{if(this.destroyed)return;let s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()},i=()=>{this.destroyed||(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},n=s=>{this.destroy(K(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(K(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(K(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;let e=this._pc.iceConnectionState,r=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,r),this.emit("iceStateChange",e,r),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(K(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(K(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){let r=i=>(Object.prototype.toString.call(i.values)==="[object Array]"&&i.values.forEach(n=>{Object.assign(i,n)}),i);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{let n=[];i.forEach(s=>{n.push(r(s))}),e(null,n)},i=>e(i)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(this.destroyed)return;let n=[];i.result().forEach(s=>{let o={};s.names().forEach(a=>{o[a]=s.stat(a)}),o.id=s.id,o.type=s.type,o.timestamp=s.timestamp,n.push(r(o))}),e(null,n)},i=>e(i)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let e=()=>{this.destroyed||this.getStats((r,i)=>{if(this.destroyed)return;r&&(i=[]);let n={},s={},o={},a=!1;i.forEach(c=>{(c.type==="remotecandidate"||c.type==="remote-candidate")&&(n[c.id]=c),(c.type==="localcandidate"||c.type==="local-candidate")&&(s[c.id]=c),(c.type==="candidatepair"||c.type==="candidate-pair")&&(o[c.id]=c)});let l=c=>{a=!0;let d=s[c.localCandidateId];d&&(d.ip||d.address)?(this.localAddress=d.ip||d.address,this.localPort=Number(d.port)):d&&d.ipAddress?(this.localAddress=d.ipAddress,this.localPort=Number(d.portNumber)):typeof c.googLocalAddress=="string"&&(d=c.googLocalAddress.split(":"),this.localAddress=d[0],this.localPort=Number(d[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let u=n[c.remoteCandidateId];u&&(u.ip||u.address)?(this.remoteAddress=u.ip||u.address,this.remotePort=Number(u.port)):u&&u.ipAddress?(this.remoteAddress=u.ipAddress,this.remotePort=Number(u.portNumber)):typeof c.googRemoteAddress=="string"&&(u=c.googRemoteAddress.split(":"),this.remoteAddress=u[0],this.remotePort=Number(u[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(c=>{c.type==="transport"&&c.selectedCandidatePairId&&l(o[c.selectedCandidatePairId]),(c.type==="googCandidatePair"&&c.googActiveConnection==="true"||(c.type==="candidatepair"||c.type==="candidate-pair")&&c.selected)&&l(c)}),!a&&(!Object.keys(o).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(d){return this.destroy(K(d,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');let c=this._cb;this._cb=null,c(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>65536||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let r=e.data;r instanceof ArrayBuffer&&(r=new Uint8Array(r)),this.emit("data",r)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);let e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(r=>{this._debug("on track"),this.emit("track",e.track,r),this._remoteTracks.push({track:e.track,stream:r}),!this._remoteStreams.some(i=>i.id===r.id)&&(this._remoteStreams.push(r),queueMicrotask(()=>{this._debug("on stream"),this.emit("stream",r)}))})}_debug(...e){this._doDebug&&(e[0]="["+this._id+"] "+e[0],console.log(...e))}on(e,r){let i=this._map;i.has(e)||i.set(e,new Set),i.get(e).add(r)}off(e,r){let i=this._map,n=i.get(e);n&&(n.delete(r),n.size===0&&i.delete(e))}once(e,r){let i=(...n)=>{this.off(e,i),r(...n)};this.on(e,i)}emit(e,...r){let i=this._map;if(i.has(e))for(let n of i.get(e))try{n(...r)}catch(s){console.error(s)}}};we.WEBRTC_SUPPORT=!!Sn();we.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};we.channelConfig={};var Ro="rrweb/canvas-webrtc@1",ti=class{constructor({signalSendCallback:e,peer:r}){this.peer=null,this.streamMap=new Map,this.incomingStreams=new Set,this.outgoingStreams=new Set,this.streamNodeMap=new Map,this.canvasWindowMap=new Map,this.windowPeerMap=new WeakMap,this.peerWindowMap=new WeakMap,this.signalSendCallback=e,window.addEventListener("message",this.windowPostMessageHandler.bind(this)),r&&(this.peer=r)}initPlugin(){return{name:Ro,getMirror:({nodeMirror:e,crossOriginIframeMirror:r})=>{this.mirror=e,this.crossOriginIframeMirror=r},options:{}}}signalReceive(e){var r;this.peer||this.setupPeer(),(r=this.peer)===null||r===void 0||r.signal(e)}signalReceiveFromCrossOriginIframe(e,r){this.setupPeer(r).signal(e)}startStream(e,r){var i,n;this.peer||this.setupPeer();let s={nodeId:e,streamId:r.id};(i=this.peer)===null||i===void 0||i.send(JSON.stringify(s)),this.outgoingStreams.has(r)||(n=this.peer)===null||n===void 0||n.addStream(r),this.outgoingStreams.add(r)}setupPeer(e){let r;if(e){let n=this.windowPeerMap.get(e);if(n)return n;r=new we({initiator:!1}),this.windowPeerMap.set(e,r),this.peerWindowMap.set(r,e)}else{if(this.peer)return this.peer;r=this.peer=new we({initiator:!0})}let i=n=>{if(!n)return this.peer=null;this.windowPeerMap.delete(n),this.peerWindowMap.delete(r)};return r.on("error",n=>{i(e),console.log("error",n)}),r.on("close",()=>{i(e),console.log("closing")}),r.on("signal",n=>{var s,o;this.inRootFrame()?r===this.peer?this.signalSendCallback(n):(s=this.peerWindowMap.get(r))===null||s===void 0||s.postMessage({type:"rrweb-canvas-webrtc",data:{type:"signal",signal:n}},"*"):(o=window.top)===null||o===void 0||o.postMessage({type:"rrweb-canvas-webrtc",data:{type:"signal",signal:n}},"*")}),r.on("connect",()=>{if(!(this.inRootFrame()&&r!==this.peer))for(let[n,s]of this.streamMap)this.startStream(n,s)}),this.inRootFrame()&&(r.on("data",n=>{try{let s=JSON.parse(n);this.streamNodeMap.set(s.streamId,s.nodeId)}catch(s){console.error("Could not parse data",s)}this.flushStreams()}),r.on("stream",n=>{this.incomingStreams.add(n),this.flushStreams()})),r}setupStream(e,r){var i;if(e===-1)return!1;let n=this.streamMap.get(r||e);if(n)return n;let s=this.mirror.getNode(e);return!s||!("captureStream"in s)?this.setupStreamInCrossOriginIframe(e,r||e):(this.inRootFrame()||(i=window.top)===null||i===void 0||i.postMessage({type:"rrweb-canvas-webrtc",data:{type:"i-have-canvas",rootId:r||e}},"*"),n=s.captureStream(),this.streamMap.set(r||e,n),this.setupPeer(),n)}flushStreams(){this.incomingStreams.forEach(e=>{let r=this.streamNodeMap.get(e.id);r&&this.startStream(r,e)})}inRootFrame(){return!!(window.top&&window.top===window)}setupStreamInCrossOriginIframe(e,r){let i=!1;return document.querySelectorAll("iframe").forEach(n=>{var s;if(i)return;let o=this.crossOriginIframeMirror.getRemoteId(n,e);o!==-1&&(i=!0,(s=n.contentWindow)===null||s===void 0||s.postMessage({type:"rrweb-canvas-webrtc",data:{type:"who-has-canvas",id:o,rootId:r}},"*"))}),i}isCrossOriginIframeMessageEventContent(e){return!!(e.data&&typeof e.data=="object"&&"type"in e.data&&"data"in e.data&&e.data.type==="rrweb-canvas-webrtc"&&e.data.data)}windowPostMessageHandler(e){if(!this.isCrossOriginIframeMessageEventContent(e))return;let{type:r}=e.data.data;if(r==="who-has-canvas"){let{id:i,rootId:n}=e.data.data;this.setupStream(i,n)}else if(r==="signal"){let{signal:i}=e.data.data,{source:n}=e;if(!n||!("self"in n))return;this.inRootFrame()?this.signalReceiveFromCrossOriginIframe(i,n):this.signalReceive(i)}else if(r==="i-have-canvas"){let{rootId:i}=e.data.data,{source:n}=e;if(!n||!("self"in n))return;this.canvasWindowMap.set(i,n)}}};var ii={};hi(ii,{default:()=>ri});function ri(t){return{all:t=t||new Map,on:function(e,r){var i=t.get(e);i?i.push(r):t.set(e,[r])},off:function(e,r){var i=t.get(e);i&&(r?i.splice(i.indexOf(r)>>>0,1):t.set(e,[]))},emit:function(e,r){var i=t.get(e);i&&i.slice().map(function(n){n(r)}),(i=t.get("*"))&&i.slice().map(function(n){n(e,r)})}}}function bn(t=window,e=document){if("scrollBehavior"in e.documentElement.style&&t.__forceSmoothScrollPolyfill__!==!0)return;let r=t.HTMLElement||t.Element,i=468,n={scroll:t.scroll||t.scrollTo,scrollBy:t.scrollBy,elementScroll:r.prototype.scroll||l,scrollIntoView:r.prototype.scrollIntoView},s=t.performance&&t.performance.now?t.performance.now.bind(t.performance):Date.now;function o(m){let y=["MSIE ","Trident/","Edge/"];return new RegExp(y.join("|")).test(m)}let a=o(t.navigator.userAgent)?1:0;function l(m,y){this.scrollLeft=m,this.scrollTop=y}function c(m){return .5*(1-Math.cos(Math.PI*m))}function d(m){if(m===null||typeof m!="object"||m.behavior===void 0||m.behavior==="auto"||m.behavior==="instant")return!0;if(typeof m=="object"&&m.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+m.behavior+" is not a valid value for enumeration ScrollBehavior.")}function u(m,y){if(y==="Y")return m.clientHeight+a<m.scrollHeight;if(y==="X")return m.clientWidth+a<m.scrollWidth}function h(m,y){let E=t.getComputedStyle(m,null)["overflow"+y];return E==="auto"||E==="scroll"}function f(m){let y=u(m,"Y")&&h(m,"Y"),E=u(m,"X")&&h(m,"X");return y||E}function p(m){for(;m!==e.body&&f(m)===!1;)m=m.parentNode||m.host;return m}function g(m){let y=s(),E,S,A,C=(y-m.startTime)/i;C=C>1?1:C,E=c(C),S=m.startX+(m.x-m.startX)*E,A=m.startY+(m.y-m.startY)*E,m.method.call(m.scrollable,S,A),(S!==m.x||A!==m.y)&&t.requestAnimationFrame(g.bind(t,m))}function v(m,y,E){let S,A,C,T,b=s();m===e.body?(S=t,A=t.scrollX||t.pageXOffset,C=t.scrollY||t.pageYOffset,T=n.scroll):(S=m,A=m.scrollLeft,C=m.scrollTop,T=l),g({scrollable:S,method:T,startTime:b,startX:A,startY:C,x:y,y:E})}t.scroll=t.scrollTo=function(){if(arguments[0]!==void 0){if(d(arguments[0])===!0){n.scroll.call(t,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:t.scrollX||t.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:t.scrollY||t.pageYOffset);return}v.call(t,e.body,arguments[0].left!==void 0?~~arguments[0].left:t.scrollX||t.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:t.scrollY||t.pageYOffset)}},t.scrollBy=function(){if(arguments[0]!==void 0){if(d(arguments[0])){n.scrollBy.call(t,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0);return}v.call(t,e.body,~~arguments[0].left+(t.scrollX||t.pageXOffset),~~arguments[0].top+(t.scrollY||t.pageYOffset))}},r.prototype.scroll=r.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(d(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");n.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop);return}let m=arguments[0].left,y=arguments[0].top;v.call(this,this,typeof m>"u"?this.scrollLeft:~~m,typeof y>"u"?this.scrollTop:~~y)},r.prototype.scrollBy=function(){if(arguments[0]!==void 0){if(d(arguments[0])===!0){n.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},r.prototype.scrollIntoView=function(){if(d(arguments[0])===!0){n.scrollIntoView.call(this,arguments[0]===void 0?!0:arguments[0]);return}let m=p(this),y=m.getBoundingClientRect(),E=this.getBoundingClientRect();m!==e.body?(v.call(this,m,m.scrollLeft+E.left-y.left,m.scrollTop+E.top-y.top),t.getComputedStyle(m).position!=="fixed"&&t.scrollBy({left:y.left,top:y.top,behavior:"smooth"})):t.scrollBy({left:E.left,top:E.top,behavior:"smooth"})}}var sr=class{constructor(e=[],r){this.timeOffset=0,this.raf=null,this.actions=e,this.speed=r.speed}addAction(e){let r=this.raf===!0;if(!this.actions.length||this.actions[this.actions.length-1].delay<=e.delay)this.actions.push(e);else{let i=this.findActionIndex(e);this.actions.splice(i,0,e)}r&&(this.raf=requestAnimationFrame(this.rafCheck.bind(this)))}addActions(e){this.actions=this.actions.concat(e)}replaceActions(e){this.actions.length=0,this.actions.splice(0,0,...e)}start(){this.timeOffset=0,this.lastTimestamp=performance.now(),this.raf=requestAnimationFrame(this.rafCheck.bind(this))}rafCheck(){let e=performance.now();for(this.timeOffset+=(e-this.lastTimestamp)*this.speed,this.lastTimestamp=e;this.actions.length;){let r=this.actions[0];if(this.timeOffset>=r.delay)this.actions.shift(),r.doAction();else break}this.actions.length>0?this.raf=requestAnimationFrame(this.rafCheck.bind(this)):this.raf=!0}clear(){this.raf&&(this.raf!==!0&&cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(e){this.speed=e}isActive(){return this.raf!==null}findActionIndex(e){let r=0,i=this.actions.length-1;for(;r<=i;){let n=Math.floor((r+i)/2);if(this.actions[n].delay<e.delay)r=n+1;else if(this.actions[n].delay>e.delay)i=n-1;else return n+1}return r}};function or(t,e){if(t.type===R.IncrementalSnapshot&&t.data.source===N.MouseMove&&t.data.positions&&t.data.positions.length){let r=t.data.positions[0].timeOffset,i=t.timestamp+r;return t.delay=i-e,i-e}return t.delay=t.timestamp-e,t.delay}function En(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i,n,s=r.call(t),o=[];try{for(;(e===void 0||e-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(a){n={error:a}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o}var ot;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(ot||(ot={}));var Rn={type:"xstate.init"};function ni(t){return t===void 0?[]:[].concat(t)}function He(t){return{type:"xstate.assign",assignment:t}}function An(t,e){return typeof(t=typeof t=="string"&&e&&e[t]?e[t]:t)=="string"?{type:t}:typeof t=="function"?{type:t.name,exec:t}:t}function ar(t){return function(e){return t===e}}function Mn(t){return typeof t=="string"?{type:t}:t}function wn(t,e){return{value:t,context:e,actions:[],changed:!1,matches:ar(t)}}function Nn(t,e,r){var i=e,n=!1;return[t.filter(function(s){if(s.type==="xstate.assign"){n=!0;var o=Object.assign({},i);return typeof s.assignment=="function"?o=s.assignment(i,r):Object.keys(s.assignment).forEach(function(a){o[a]=typeof s.assignment[a]=="function"?s.assignment[a](i,r):s.assignment[a]}),i=o,!1}return!0}),i,n]}function si(t,e){e===void 0&&(e={});var r=En(Nn(ni(t.states[t.initial].entry).map(function(o){return An(o,e.actions)}),t.context,Rn),2),i=r[0],n=r[1],s={config:t,_options:e,initialState:{value:t.initial,actions:i,context:n,matches:ar(t.initial)},transition:function(o,a){var l,c,d=typeof o=="string"?{value:o,context:t.context}:o,u=d.value,h=d.context,f=Mn(a),p=t.states[u];if(p.on){var g=ni(p.on[f.type]);try{for(var v=function(D){var F=typeof Symbol=="function"&&Symbol.iterator,H=F&&D[F],B=0;if(H)return H.call(D);if(D&&typeof D.length=="number")return{next:function(){return D&&B>=D.length&&(D=void 0),{value:D&&D[B++],done:!D}}};throw new TypeError(F?"Object is not iterable.":"Symbol.iterator is not defined.")}(g),m=v.next();!m.done;m=v.next()){var y=m.value;if(y===void 0)return wn(u,h);var E=typeof y=="string"?{target:y}:y,S=E.target,A=E.actions,C=A===void 0?[]:A,T=E.cond,b=S===void 0;if((T===void 0?function(){return!0}:T)(h,f)){var x=t.states[S??u],L=En(Nn((b?ni(C):[].concat(p.exit,C,x.entry).filter(function(D){return D})).map(function(D){return An(D,s._options.actions)}),h,f),3),P=L[0],Z=L[1],G=L[2],V=S??u;return{value:V,context:Z,actions:P,changed:S!==u||P.length>0||G,matches:ar(V)}}}}catch(D){l={error:D}}finally{try{m&&!m.done&&(c=v.return)&&c.call(v)}finally{if(l)throw l.error}}}return wn(u,h)}};return s}var Tn=function(t,e){return t.actions.forEach(function(r){var i=r.exec;return i&&i(t.context,e)})};function oi(t){var e=t.initialState,r=ot.NotStarted,i=new Set,n={_machine:t,send:function(s){r===ot.Running&&(e=t.transition(e,s),Tn(e,Mn(s)),i.forEach(function(o){return o(e)}))},subscribe:function(s){return i.add(s),s(e),{unsubscribe:function(){return i.delete(s)}}},start:function(s){if(s){var o=typeof s=="object"?s:{context:t.config.context,value:s};e={value:o.value,actions:[],context:o.context,matches:ar(o.value)}}return r=ot.Running,Tn(e,Rn),n},stop:function(){return r=ot.Stopped,i.clear(),n},get state(){return e},get status(){return r}};return n}function Mo(t,e){for(let r=t.length-1;r>=0;r--){let i=t[r];if(i.type===R.Meta&&i.timestamp<=e)return t.slice(r)}return t}function _n(t,{getCastFn:e,applyEventsSynchronously:r,emitter:i}){let n=si({id:"player",context:t,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]},REPLACE_EVENTS:{target:"playing",actions:["replaceEvents"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]},REPLACE_EVENTS:{target:"paused",actions:["replaceEvents"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:He({lastPlayedEvent:(s,o)=>o.type==="CAST_EVENT"?o.payload.event:s.lastPlayedEvent}),recordTimeOffset:He((s,o)=>{let a=s.timeOffset;return"payload"in o&&"timeOffset"in o.payload&&(a=o.payload.timeOffset),Object.assign(Object.assign({},s),{timeOffset:a,baselineTime:s.events[0].timestamp+a})}),play(s){var o;let{timer:a,events:l,baselineTime:c,lastPlayedEvent:d}=s;a.clear();for(let p of l)or(p,c);let u=Mo(l,c),h=d?.timestamp;d?.type===R.IncrementalSnapshot&&d.data.source===N.MouseMove&&(h=d.timestamp+((o=d.data.positions[0])===null||o===void 0?void 0:o.timeOffset)),c<(h||0)&&i.emit(z.PlayBack);let f=new Array;for(let p of u)if(!(h&&h<c&&(p.timestamp<=h||p===d)))if(p.timestamp<c)f.push(p);else{let g=e(p,!1);a.addAction({doAction:()=>{g()},delay:p.delay})}r(f),i.emit(z.Flush),a.start()},pause(s){s.timer.clear()},resetLastPlayedEvent:He(s=>Object.assign(Object.assign({},s),{lastPlayedEvent:null})),startLive:He({baselineTime:(s,o)=>(s.timer.start(),o.type==="TO_LIVE"&&o.payload.baselineTime?o.payload.baselineTime:Date.now())}),replaceEvents:He((s,o)=>{let{events:a,timer:l,baselineTime:c}=s;if(o.type==="REPLACE_EVENTS"){let{events:d}=o.payload;a.length=0;let u=[];for(let h of d)if(or(h,c),a.push(h),h.timestamp>=l.timeOffset+c){let f=e(h,!1);u.push({doAction:()=>{f()},delay:h.delay})}l.isActive()&&l.replaceActions(u)}return Object.assign(Object.assign({},s),{events:a})}),addEvent:He((s,o)=>{let{baselineTime:a,timer:l,events:c}=s;if(o.type==="ADD_EVENT"){let{event:d}=o.payload;or(d,a);let u=c.length-1;if(!c[u]||c[u].timestamp<=d.timestamp)c.push(d);else{let p=-1,g=0;for(;g<=u;){let v=Math.floor((g+u)/2);c[v].timestamp<=d.timestamp?g=v+1:u=v-1}p===-1&&(p=g),c.splice(p,0,d)}let h=d.timestamp<a,f=e(d,h);h?f():l.isActive()&&l.addAction({doAction:()=>{f()},delay:d.delay})}return Object.assign(Object.assign({},s),{events:c})})}});return oi(n)}function Dn(t){let e=si({id:"speed",context:t,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(r,i)=>{"payload"in i&&r.timer.setSpeed(i.payload.speed)},recordSpeed:He({normalSpeed:r=>r.timer.speed}),restoreSpeed:r=>{r.timer.setSpeed(r.normalSpeed)}}});return oi(e)}var kn=t=>["noscript { display: none !important; }",`.${t} { background: currentColor; border-radius: 5px; }`,`.${t}:hover::after {content: 'Redacted'; color: white; background: black; text-align: center; width: 100%; display: block;}`];var On=new Map;function ai(t,e){let r=On.get(t);return r||(r=new Map,On.set(t,r)),r.has(e)||r.set(e,[]),r.get(e)}function Ne(t,e,r){return i=>le(this,void 0,void 0,function*(){if(i&&typeof i=="object"&&"rr_type"in i)if(r&&(r.isUnchanged=!1),i.rr_type==="ImageBitmap"&&"args"in i){let n=yield Ne(t,e,r)(i.args);return yield createImageBitmap.apply(null,n)}else if("index"in i){if(r||e===null)return i;let{rr_type:n,index:s}=i;return ai(e,n)[s]}else if("args"in i){let{rr_type:n,args:s}=i,o=window[n];return new o(...yield Promise.all(s.map(Ne(t,e,r))))}else{if("base64"in i)return Ui(i.base64);if("src"in i){let n=t.get(i.src);if(n)return n;{let s=new Image;return s.src=i.src,t.set(i.src,s),s}}else if("data"in i&&i.rr_type==="Blob"){let n=yield Promise.all(i.data.map(Ne(t,e,r)));return new Blob(n,{type:i.type})}}else if(Array.isArray(i))return yield Promise.all(i.map(Ne(t,e,r)));return i})}function _o(t,e){try{return e===pe.WebGL?t.getContext("webgl")||t.getContext("experimental-webgl"):t.getContext("webgl2")}catch{return null}}var Do=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function ko(t,e){if(!e?.constructor)return;let{name:r}=e.constructor;if(!Do.includes(r))return;let i=ai(t,r);i.includes(e)||i.push(e)}function xn({mutation:t,target:e,type:r,imageMap:i,errorHandler:n}){return le(this,void 0,void 0,function*(){try{let s=_o(e,r);if(!s)return;if(t.setter){s[t.property]=t.args[0];return}let o=s[t.property],a=yield Promise.all(t.args.map(Ne(i,s))),l=o.apply(s,a);ko(s,l);let c=!1}catch(s){n(t,s)}})}function Ln({event:t,mutation:e,target:r,imageMap:i,errorHandler:n}){return le(this,void 0,void 0,function*(){try{let s=r.getContext("2d");if(e.setter){s[e.property]=e.args[0];return}let o=s[e.property];if(e.property==="drawImage"&&typeof e.args[0]=="string")i.get(t),o.apply(s,e.args);else{let a=yield Promise.all(e.args.map(Ne(i,s)));o.apply(s,a)}}catch(s){n(e,s)}})}function li({event:t,mutation:e,target:r,imageMap:i,canvasEventMap:n,errorHandler:s}){return le(this,void 0,void 0,function*(){try{let o=n.get(t)||e,a="commands"in o?o.commands:[o];if([pe.WebGL,pe.WebGL2].includes(e.type)){for(let l=0;l<a.length;l++){let c=a[l];yield xn({mutation:c,type:e.type,target:r,imageMap:i,errorHandler:s})}return}for(let l=0;l<a.length;l++){let c=a[l];yield Ln({event:t,mutation:c,target:r,imageMap:i,errorHandler:s})}}catch(o){s(e,o)}})}var Fn=10*1e3,Pn=5*1e3,Bn=1*1e3,Un=60*60*1e3,Oo=ri||ii,Wn="[replayer]",ci={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function di(t){return t.type==R.IncrementalSnapshot&&(t.data.source==N.TouchMove||t.data.source==N.MouseInteraction&&t.data.type==J.TouchStart)}var ui=class{get timer(){return this.service.state.context.timer}constructor(e,r){if(this.usingVirtualDom=!1,this.virtualDom=new De,this.mouseTail=null,this.tailPositions=[],this.emitter=Oo(),this.activityIntervals=[],this.legacy_missingNodeRetryMap={},this.cache=Ir(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=_t(),this.styleMirror=new Xe,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastMouseDownEvent=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=a=>{this.iframe.style.display="inherit";for(let l of[this.mouseTail,this.iframe])l&&(l.setAttribute("width",String(a.width)),l.setAttribute("height",String(a.height)))},this.applyEventsSynchronously=a=>{for(let l of a){switch(l.type){case R.DomContentLoaded:case R.Load:case R.Custom:continue;case R.FullSnapshot:case R.Meta:case R.Plugin:case R.IncrementalSnapshot:break}this.getCastFn(l,!0)()}},this.getCastFn=(a,l=!1)=>{let c;switch(a.type){case R.DomContentLoaded:case R.Load:break;case R.Custom:c=()=>{this.emitter.emit(z.CustomEvent,a)};break;case R.Meta:c=()=>this.emitter.emit(z.Resize,{width:a.data.width,height:a.data.height});break;case R.FullSnapshot:c=()=>{var u;if(this.firstFullSnapshot){if(this.firstFullSnapshot===a){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.rebuildFullSnapshot(a,l),(u=this.iframe.contentWindow)===null||u===void 0||u.scrollTo(a.data.initialOffset),this.styleMirror.reset()};break;case R.IncrementalSnapshot:c=()=>{if(this.applyIncremental(a,l),!l&&(this.handleInactivity(a.timestamp),a===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(let u of this.service.state.context.events)if(!(u.timestamp<=a.timestamp)&&this.isUserInteraction(u)){u.delay-a.delay>Fn*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=u);break}if(this.nextUserInteractionEvent){let u=this.nextUserInteractionEvent.delay-a.delay,h={speed:Math.min(Math.round(u/Pn),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:h}),this.emitter.emit(z.SkipStart,h)}}};break}return()=>{c&&c();for(let h of this.config.plugins||[])h.handler&&h.handler(a,l,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:a}});let u=this.service.state.context.events.length-1;if(!this.config.liveMode&&a===this.service.state.context.events[u]){let h=()=>{u<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(z.Finish))},f=50;a.type===R.IncrementalSnapshot&&a.data.source===N.MouseMove&&a.data.positions.length&&(f+=Math.max(0,-a.data.positions[0].timeOffset)),setTimeout(h,f)}this.emitter.emit(z.EventCast,a)}},!r?.liveMode&&e.length<2)throw new Error("Replayer need at least 2 events.");let i={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"highlight-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:ci,useVirtualDom:!0,logger:console,inactiveThreshold:.02,inactiveSkipTime:Pn};this.config=Object.assign({},i,r),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(z.Resize,this.handleResize),this.setupDom();for(let a of this.config.plugins||[])a.getMirror&&a.getMirror({nodeMirror:this.mirror});this.emitter.on(z.Flush,()=>{if(this.usingVirtualDom){let a={mirror:this.mirror,applyCanvas:(l,c,d)=>{li({event:l,mutation:c,target:d,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(l,c)=>{l.source===N.StyleSheetRule?this.applyStyleSheetRule(l,c):l.source===N.StyleDeclaration&&this.applyStyleDeclaration(l,c)},afterAppend:(l,c)=>{for(let d of this.config.plugins||[])d.onBuild&&d.onBuild(l,{id:c,replayer:this})}};if(this.iframe.contentDocument)try{Ee(this.iframe.contentDocument,this.virtualDom,a,this.virtualDom.mirror)}catch(l){console.warn(l)}if(this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(let l in this.legacy_missingNodeRetryMap)try{let c=this.legacy_missingNodeRetryMap[l],d=Et(c.node,this.mirror,this.virtualDom.mirror);Ee(d,c.node,a,this.virtualDom.mirror),c.node=d}catch(c){this.warn(c)}this.constructedStyleMutations.forEach(l=>{this.applyStyleSheetMutation(l)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(l=>{this.applyAdoptedStyleSheet(l)}),this.adoptedStyleSheets=[]}if(this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null,this.lastMouseDownEvent){let[a,l]=this.lastMouseDownEvent;a.dispatchEvent(l)}this.lastMouseDownEvent=null,this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(z.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset()});let n=new sr([],{speed:this.config.speed});this.service=_n({events:e.map(a=>r&&r.unpackFn?r.unpackFn(a):a).sort((a,l)=>a.timestamp-l.timestamp),timer:n,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(a=>{this.emitter.emit(z.StateChange,{player:a})}),this.speedService=Dn({normalSpeed:-1,timer:n}),this.speedService.start(),this.speedService.subscribe(a=>{this.emitter.emit(z.StateChange,{speed:a})});let s=this.service.state.context.events.find(a=>a.type===R.Meta),o=this.service.state.context.events.find(a=>a.type===R.FullSnapshot);if(s){let{width:a,height:l}=s.data;setTimeout(()=>{this.emitter.emit(z.Resize,{width:a,height:l})},0)}o&&setTimeout(()=>{var a;this.firstFullSnapshot||(this.firstFullSnapshot=o,this.rebuildFullSnapshot(o),(a=this.iframe.contentWindow)===null||a===void 0||a.scrollTo(o.data.initialOffset))},1),this.service.state.context.events.find(di)&&this.mouse.classList.add("touch-device")}on(e,r){return this.emitter.on(e,r),this}off(e,r){return this.emitter.off(e,r),this}setConfig(e){Object.keys(e).forEach(r=>{e[r],this.config[r]=e[r]}),this.config.skipInactive||this.backToNormal(),typeof e.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:e.speed}}),typeof e.mouseTail<"u"&&(e.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getActivityIntervals(){if(this.activityIntervals.length==0){let e=[],r=this.getMetaData(),i=[{timestamp:r.startTime},...this.service.state.context.events.filter(o=>this.isUserInteraction(o)),{timestamp:r.endTime}];for(let o=1;o<i.length;o++){let a=i[o-1],l=i[o];l.timestamp-a.timestamp>Fn?e.push({startTime:a.timestamp,endTime:l.timestamp,duration:l.timestamp-a.timestamp,active:!1}):e.push({startTime:a.timestamp,endTime:l.timestamp,duration:l.timestamp-a.timestamp,active:!0})}let n=[],s=e[0];for(let o=1;o<e.length;o++)e[o].active!=e[o-1].active&&(n.push({startTime:s.startTime,endTime:e[o-1].endTime,duration:e[o-1].endTime-s.startTime,active:e[o-1].active}),s=e[o]);s&&e.length>0&&n.push({startTime:s.startTime,endTime:e[e.length-1].endTime,duration:e[e.length-1].endTime-s.startTime,active:e[e.length-1].active}),s=n[0];for(let o=1;o<n.length;o++)(!n[o].active&&n[o].duration>this.config.inactiveThreshold*r.totalTime||!n[o-1].active&&n[o-1].duration>this.config.inactiveThreshold*r.totalTime)&&(this.activityIntervals.push({startTime:s.startTime,endTime:n[o-1].endTime,duration:n[o-1].endTime-s.startTime,active:n[o-1].active}),s=n[o]);s&&n.length>0&&this.activityIntervals.push({startTime:s.startTime,endTime:n[n.length-1].endTime,duration:n[n.length-1].endTime-s.startTime,active:n[n.length-1].active})}return this.activityIntervals}getMetaData(){let e=this.service.state.context.events[0],r=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:e.timestamp,endTime:r.timestamp,totalTime:r.timestamp-e.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){let{baselineTime:e,events:r}=this.service.state.context;return e-r[0].timestamp}getMirror(){return this.mirror}play(e=0){var r,i;this.service.state.matches("paused")?this.service.send({type:"PLAY",payload:{timeOffset:e}}):(this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:e}})),(i=(r=this.iframe.contentDocument)===null||r===void 0?void 0:r.getElementsByTagName("html")[0])===null||i===void 0||i.classList.remove("rrweb-paused"),this.emitter.emit(z.Start)}pause(e){var r,i;e===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof e=="number"&&(this.play(e),this.service.send({type:"PAUSE"})),(i=(r=this.iframe.contentDocument)===null||r===void 0?void 0:r.getElementsByTagName("html")[0])===null||i===void 0||i.classList.add("rrweb-paused"),this.emitter.emit(z.Pause)}resume(e=0){this.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(e),this.emitter.emit(z.Resume)}destroy(){this.pause(),this.config.root.removeChild(this.wrapper),this.emitter.emit(z.Destroy)}startLive(e){this.service.send({type:"TO_LIVE",payload:{baselineTime:e}})}addEvent(e){let r=this.config.unpackFn?this.config.unpackFn(e):e;di(r)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:r}}))}replaceEvents(e){for(let r of e)if(di(r)){this.mouse.classList.add("touch-device");break}this.service.send({type:"REPLACE_EVENTS",payload:{events:e}})}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=Ir()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");let e=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&e.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",e.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(bn(this.iframe.contentWindow,this.iframe.contentDocument),mt(this.iframe.contentWindow))}handleInactivity(e,r){if((e===this.inactiveEndTimestamp||r)&&(this.inactiveEndTimestamp=null,this.backToNormal()),this.config.skipInactive&&!this.inactiveEndTimestamp){for(let i of this.getActivityIntervals())if(e>=i.startTime&&e<i.endTime&&!i.active){this.inactiveEndTimestamp=i.endTime;break}if(this.inactiveEndTimestamp){let i=this.inactiveEndTimestamp-e,n={speed:i/Un*this.config.inactiveSkipTime<Bn?i/Bn:Math.round(Math.max(i,Un)/this.config.inactiveSkipTime)};this.speedService.send({type:"FAST_FORWARD",payload:n}),this.emitter.emit(z.SkipStart,n)}}}rebuildFullSnapshot(e,r=!1){if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&this.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};let i=[],n=(a,l)=>{this.collectIframeAndAttachDocument(i,a);for(let c of this.config.plugins||[])c.onBuild&&c.onBuild(a,{id:l,replayer:this})};this.usingVirtualDom&&(this.virtualDom.destroyTree(),this.usingVirtualDom=!1),this.mirror.reset(),bi(e.data.node,{doc:this.iframe.contentDocument,afterAppend:n,cache:this.cache,mirror:this.mirror}),n(this.iframe.contentDocument,e.data.node.id);for(let{mutationInQueue:a,builtNode:l}of i)this.attachDocumentToIframe(a,l),this.newDocumentQueue=this.newDocumentQueue.filter(c=>c!==a);let{documentElement:s,head:o}=this.iframe.contentDocument;this.insertStyleRules(s,o),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(z.FullsnapshotRebuilded,e),r||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(e,r){var i;let n=kn(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&n.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){let s=this.virtualDom.createElement("style");this.virtualDom.mirror.add(s,Hr(s,this.virtualDom.unserializedId)),e.insertBefore(s,r),s.rules.push({source:N.StyleSheetRule,adds:n.map((o,a)=>({rule:o,index:a}))})}else{let s=document.createElement("style");e.insertBefore(s,r);for(let o=0;o<n.length;o++)(i=s.sheet)===null||i===void 0||i.insertRule(n[o],o)}}attachDocumentToIframe(e,r){let i=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,n=[],s=(o,a)=>{this.collectIframeAndAttachDocument(n,o);let l=i.getMeta(o);if(l?.type===O.Element&&l?.tagName.toUpperCase()==="HTML"){let{documentElement:c,head:d}=r.contentDocument;this.insertStyleRules(c,d)}if(!this.usingVirtualDom)for(let c of this.config.plugins||[])c.onBuild&&c.onBuild(o,{id:a,replayer:this})};rt(e.node,{doc:r.contentDocument,mirror:i,hackCss:!0,skipChild:!1,afterAppend:s,cache:this.cache}),s(r.contentDocument,e.node.id);for(let{mutationInQueue:o,builtNode:a}of n)this.attachDocumentToIframe(o,a),this.newDocumentQueue=this.newDocumentQueue.filter(l=>l!==o)}collectIframeAndAttachDocument(e,r){if(_e(r,this.mirror)){let i=this.newDocumentQueue.find(n=>n.parentId===this.mirror.getId(r));i&&e.push({mutationInQueue:i,builtNode:r})}}waitForStylesheetLoad(){var e;let r=(e=this.iframe.contentDocument)===null||e===void 0?void 0:e.head;if(r){let i=new Set,n,s=this.service.state,o=()=>{s=this.service.state};this.emitter.on(z.Start,o),this.emitter.on(z.Pause,o);let a=()=>{this.emitter.off(z.Start,o),this.emitter.off(z.Pause,o)};r.querySelectorAll('link[rel="stylesheet"]').forEach(l=>{l.sheet||(i.add(l),l.addEventListener("load",()=>{i.delete(l),i.size===0&&n!==-1&&(s.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(z.LoadStylesheetEnd),n&&clearTimeout(n),a())}))}),i.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(z.LoadStylesheetStart),n=setTimeout(()=>{s.matches("playing")&&this.play(this.getCurrentTime()),n=-1,a()},this.config.loadTimeout))}}preloadAllImages(){return le(this,void 0,void 0,function*(){this.service.state;let e=()=>{this.service.state};this.emitter.on(z.Start,e),this.emitter.on(z.Pause,e);let r=[];for(let i of this.service.state.context.events)i.type===R.IncrementalSnapshot&&i.data.source===N.CanvasMutation&&(r.push(this.deserializeAndPreloadCanvasEvents(i.data,i)),("commands"in i.data?i.data.commands:[i.data]).forEach(s=>{this.preloadImages(s,i)}));return Promise.all(r)})}preloadImages(e,r){if(e.property==="drawImage"&&typeof e.args[0]=="string"&&!this.imageMap.has(r)){let i=document.createElement("canvas"),n=i.getContext("2d"),s=n?.createImageData(i.width,i.height);s?.data,JSON.parse(e.args[0]),n?.putImageData(s,0,0)}}deserializeAndPreloadCanvasEvents(e,r){return le(this,void 0,void 0,function*(){if(!this.canvasEventMap.has(r)){let i={isUnchanged:!0};if("commands"in e){let n=yield Promise.all(e.commands.map(s=>le(this,void 0,void 0,function*(){let o=yield Promise.all(s.args.map(Ne(this.imageMap,null,i)));return Object.assign(Object.assign({},s),{args:o})})));i.isUnchanged===!1&&this.canvasEventMap.set(r,Object.assign(Object.assign({},e),{commands:n}))}else{let n=yield Promise.all(e.args.map(Ne(this.imageMap,null,i)));i.isUnchanged===!1&&this.canvasEventMap.set(r,Object.assign(Object.assign({},e),{args:n}))}}})}applyIncremental(e,r){var i,n,s;let{data:o}=e;switch(o.source){case N.Mutation:{try{this.applyMutation(o,r)}catch(a){this.warn(`Exception in mutation ${a.message||a}`,o)}break}case N.Drag:case N.TouchMove:case N.MouseMove:if(r){let a=o.positions[o.positions.length-1];this.mousePos={x:a.x,y:a.y,id:a.id,debugData:o}}else o.positions.forEach(a=>{let l={doAction:()=>{this.moveAndHover(a.x,a.y,a.id,r,o)},delay:a.timeOffset+e.timestamp-this.service.state.context.baselineTime};this.timer.addAction(l)}),this.timer.addAction({doAction(){},delay:e.delay-((i=o.positions[0])===null||i===void 0?void 0:i.timeOffset)});break;case N.MouseInteraction:{if(o.id===-1)break;let a=new Event(J[o.type].toLowerCase()),l=this.mirror.getNode(o.id);if(!l)return this.debugNodeNotFound(o,o.id);this.emitter.emit(z.MouseInteraction,{type:o.type,target:l});let{triggerFocus:c}=this.config;switch(o.type){case J.Blur:"blur"in l&&l.blur();break;case J.Focus:c&&l.focus&&l.focus({preventScroll:!0});break;case J.Click:case J.TouchStart:case J.TouchEnd:case J.MouseDown:case J.MouseUp:r?(o.type===J.TouchStart?this.touchActive=!0:o.type===J.TouchEnd&&(this.touchActive=!1),o.type===J.MouseDown?this.lastMouseDownEvent=[l,a]:o.type===J.MouseUp&&(this.lastMouseDownEvent=null),this.mousePos={x:o.x,y:o.y,id:o.id,debugData:o}):(o.type===J.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(o.x,o.y,o.id,r,o),o.type===J.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):o.type===J.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):o.type===J.TouchEnd?this.mouse.classList.remove("touch-active"):l.dispatchEvent(a));break;case J.TouchCancel:r?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:l.dispatchEvent(a)}break}case N.Scroll:{if(o.id===-1)break;if(this.usingVirtualDom){let a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.scrollData=o;break}this.applyScroll(o,r);break}case N.ViewportResize:this.emitter.emit(z.Resize,{width:o.width,height:o.height});break;case N.Input:{if(o.id===-1)break;if(this.usingVirtualDom){let a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.inputData=o;break}this.applyInput(o);break}case N.MediaInteraction:{let a=this.usingVirtualDom?this.virtualDom.mirror.getNode(o.id):this.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);let l=a;try{o.currentTime!==void 0&&(l.currentTime=o.currentTime),o.volume!==void 0&&(l.volume=o.volume),o.muted!==void 0&&(l.muted=o.muted),o.type===1&&l.pause(),o.type===0&&l.play(),o.type===4&&(l.playbackRate=o.playbackRate)}catch(c){this.warn(`Failed to replay media interactions: ${c.message||c}`)}break}case N.StyleSheetRule:case N.StyleDeclaration:{this.usingVirtualDom?o.styleId?this.constructedStyleMutations.push(o):o.id&&((n=this.virtualDom.mirror.getNode(o.id))===null||n===void 0||n.rules.push(o)):this.applyStyleSheetMutation(o);break}case N.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){let a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.canvasMutations.push({event:e,mutation:o})}else{let a=this.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);li({event:e,mutation:o,target:a,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break}case N.Font:{try{let a=new FontFace(o.family,o.buffer?new Uint8Array(JSON.parse(o.fontSource)):o.fontSource,o.descriptors);(s=this.iframe.contentDocument)===null||s===void 0||s.fonts.add(a)}catch(a){this.warn(a)}break}case N.Selection:{if(r){this.lastSelectionData=o;break}this.applySelection(o);break}case N.AdoptedStyleSheet:{this.usingVirtualDom?this.adoptedStyleSheets.push(o):this.applyAdoptedStyleSheet(o);break}}}applyMutation(e,r){if(this.config.useVirtualDom&&!this.usingVirtualDom&&r&&(this.usingVirtualDom=!0,nn(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(let c in this.legacy_missingNodeRetryMap)try{let d=this.legacy_missingNodeRetryMap[c],u=Gr(d.node,this.virtualDom,this.mirror);u&&(d.node=u)}catch(d){this.warn(d)}let i=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;e.removes=e.removes.filter(c=>i.getNode(c.id)?!0:(this.warnNodeNotFound(e,c.id),!1)),e.removes.forEach(c=>{var d;let u=i.getNode(c.id);if(!u)return;let h=i.getNode(c.parentId);if(!h)return this.warnNodeNotFound(e,c.parentId);if(c.isShadow&&Se(h)&&(h=h.shadowRoot),i.removeNodeFromMap(u),h)try{h.removeChild(u),this.usingVirtualDom&&u.nodeName==="#text"&&h.nodeName==="STYLE"&&((d=h.rules)===null||d===void 0?void 0:d.length)>0&&(h.rules=[])}catch(f){if(f instanceof DOMException)this.warn("parent could not remove child in mutation",h,u,e);else throw f}});let n=Object.assign({},this.legacy_missingNodeRetryMap),s=[],o=c=>{let d=null;return c.nextId&&(d=i.getNode(c.nextId)),c.nextId!==null&&c.nextId!==void 0&&c.nextId!==-1&&!d},a=c=>{var d,u;if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");let h=i.getNode(c.parentId);if(!h)return c.node.type===O.Document?this.newDocumentQueue.push(c):s.push(c);c.node.isShadow&&(Se(h)||h.attachShadow({mode:"open"}),h=h.shadowRoot);let f=null,p=null;if(c.previousId&&(f=i.getNode(c.previousId)),c.nextId&&(p=i.getNode(c.nextId)),o(c))return s.push(c);if(c.node.rootId&&!i.getNode(c.node.rootId))return;let g=c.node.rootId?i.getNode(c.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(_e(h,i)){this.attachDocumentToIframe(c,h);return}let v=(E,S)=>{if(!this.usingVirtualDom)for(let A of this.config.plugins||[])A.onBuild&&A.onBuild(E,{id:S,replayer:this})},m=rt(c.node,{doc:g,mirror:i,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:v});if(c.previousId===-1||c.nextId===-1){n[c.node.id]={node:m,mutation:c};return}let y=i.getMeta(h);if(y&&y.type===O.Element&&y.tagName==="textarea"&&c.node.type===O.Text){let E=Array.isArray(h.childNodes)?h.childNodes:Array.from(h.childNodes);for(let S of E)S.nodeType===h.TEXT_NODE&&h.removeChild(S)}else if(y?.type===O.Document){let E=h;c.node.type===O.DocumentType&&((d=E.childNodes[0])===null||d===void 0?void 0:d.nodeType)===Node.DOCUMENT_TYPE_NODE&&E.removeChild(E.childNodes[0]),m.nodeName==="HTML"&&E.documentElement&&E.removeChild(E.documentElement)}if(f&&f.nextSibling&&f.nextSibling.parentNode?h.insertBefore(m,f.nextSibling):p&&p.parentNode?h.contains(p)?h.insertBefore(m,p):h.insertBefore(m,null):h.appendChild(m),v(m,c.node.id),this.usingVirtualDom&&m.nodeName==="#text"&&h.nodeName==="STYLE"&&((u=h.rules)===null||u===void 0?void 0:u.length)>0&&(h.rules=[]),_e(m,this.mirror)){let E=this.mirror.getId(m),S=this.newDocumentQueue.find(A=>A.parentId===E);S&&(this.attachDocumentToIframe(S,m),this.newDocumentQueue=this.newDocumentQueue.filter(A=>A!==S))}(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(n,h,m,c)};e.adds.forEach(c=>{a(c)});let l=Date.now();for(;s.length;){let c=br(s);if(s.length=0,Date.now()-l>500){this.warn("Timeout in the loop, please check the resolve tree data:",c);break}for(let d of c)i.getNode(d.value.parentId)?xt(d,h=>{a(h)}):this.debug("Drop resolve tree since there is no parent for the root node.",d)}Object.keys(n).length&&Object.assign(this.legacy_missingNodeRetryMap,n),Er(e.texts).forEach(c=>{var d;let u=i.getNode(c.id);if(!u)return e.removes.find(h=>h.id===c.id)?void 0:this.warnNodeNotFound(e,c.id);if(u.textContent=c.value,this.usingVirtualDom){let h=u.parentNode;((d=h?.rules)===null||d===void 0?void 0:d.length)>0&&(h.rules=[])}}),e.attributes.forEach(c=>{let d=i.getNode(c.id);if(!d)return e.removes.find(u=>u.id===c.id)?void 0:this.warnNodeNotFound(e,c.id);for(let u in c.attributes)if(typeof u=="string"){let h=c.attributes[u];if(h===null)d.removeAttribute(u);else if(typeof h=="string")try{if(u==="_cssText"&&(d.nodeName==="LINK"||d.nodeName==="STYLE"))try{let f=i.getMeta(d);Object.assign(f.attributes,c.attributes);let p=rt(f,{doc:d.ownerDocument,mirror:i,skipChild:!0,hackCss:!0,cache:this.cache}),g=d.nextSibling,v=d.parentNode;if(p&&v){v.removeChild(d),v.insertBefore(p,g),i.replace(c.id,p);break}}catch{}d.setAttribute(u,h)}catch(f){this.warn("An error occurred may due to the checkout feature.",f)}else if(u==="style"){let f=h,p=d;for(let g in f)if(f[g]===!1)p.style.removeProperty(g);else if(f[g]instanceof Array){let v=f[g];p.style.setProperty(g,v[0],v[1])}else{let v=f[g];p.style.setProperty(g,v)}}}})}applyScroll(e,r){var i,n;let s=this.mirror.getNode(e.id);if(!s)return this.debugNodeNotFound(e,e.id);let o=this.mirror.getMeta(s);if(s===this.iframe.contentDocument)(i=this.iframe.contentWindow)===null||i===void 0||i.scrollTo({top:e.y,left:e.x,behavior:r?"auto":"smooth"});else if(o?.type===O.Document)(n=s.defaultView)===null||n===void 0||n.scrollTo({top:e.y,left:e.x,behavior:r?"auto":"smooth"});else try{s.scrollTo({top:e.y,left:e.x,behavior:r?"auto":"smooth"})}catch{}}applyInput(e){let r=this.mirror.getNode(e.id);if(!r)return this.debugNodeNotFound(e,e.id);try{r.checked=e.isChecked,r.value=e.text}catch{}}applySelection(e){try{let r=new Set,i=e.ranges.map(({start:n,startOffset:s,end:o,endOffset:a})=>{let l=this.mirror.getNode(n),c=this.mirror.getNode(o);if(!l||!c)return;let d=new Range;d.setStart(l,s),d.setEnd(c,a);let u=l.ownerDocument,h=u?.getSelection();return h&&r.add(h),{range:d,selection:h}});r.forEach(n=>n.removeAllRanges()),i.forEach(n=>{var s;return n&&((s=n.selection)===null||s===void 0?void 0:s.addRange(n.range))})}catch{}}applyStyleSheetMutation(e){var r;let i=null;e.styleId?i=this.styleMirror.getStyle(e.styleId):e.id&&(i=((r=this.mirror.getNode(e.id))===null||r===void 0?void 0:r.sheet)||null),i&&(e.source===N.StyleSheetRule?this.applyStyleSheetRule(e,i):e.source===N.StyleDeclaration&&this.applyStyleDeclaration(e,i))}applyStyleSheetRule(e,r){var i,n,s,o;if((i=e.adds)===null||i===void 0||i.forEach(({rule:a,index:l})=>{try{if(Array.isArray(l)){let{positions:c,index:d}=Ft(l);Qe(r.cssRules,c).insertRule(a,d)}else{let c=l===void 0?void 0:Math.min(l,r.cssRules.length);r?.insertRule(a,c)}}catch{}}),(n=e.removes)===null||n===void 0||n.forEach(({index:a})=>{try{if(Array.isArray(a)){let{positions:l,index:c}=Ft(a);Qe(r.cssRules,l).deleteRule(c||0)}else r?.deleteRule(a)}catch{}}),e.replace)try{(s=r.replace)===null||s===void 0||s.call(r,e.replace)}catch{}if(e.replaceSync)try{(o=r.replaceSync)===null||o===void 0||o.call(r,e.replaceSync)}catch{}}applyStyleDeclaration(e,r){e.set&&Qe(r.rules,e.index).style.setProperty(e.set.property,e.set.value,e.set.priority),e.remove&&Qe(r.rules,e.index).style.removeProperty(e.remove.property)}applyAdoptedStyleSheet(e){var r;let i=this.mirror.getNode(e.id);if(!i)return;(r=e.styles)===null||r===void 0||r.forEach(a=>{var l;let c=null,d=null;if(Se(i)?d=((l=i.ownerDocument)===null||l===void 0?void 0:l.defaultView)||null:i.nodeName==="#document"&&(d=i.defaultView),!!d)try{c=new d.CSSStyleSheet,this.styleMirror.add(c,a.styleId),this.applyStyleSheetRule({source:N.StyleSheetRule,adds:a.rules},c)}catch{}});let n=10,s=0,o=(a,l)=>{let c=l.map(d=>this.styleMirror.getStyle(d)).filter(d=>d!==null);Se(a)?a.shadowRoot.adoptedStyleSheets=c:a.nodeName==="#document"&&(a.adoptedStyleSheets=c),c.length!==l.length&&s<n&&(setTimeout(()=>o(a,l),0+100*s),s++)};o(i,e.styleIds)}legacy_resolveMissingNode(e,r,i,n){let{previousId:s,nextId:o}=n,a=s&&e[s],l=o&&e[o];if(a){let{node:c,mutation:d}=a;r.insertBefore(c,i),delete e[d.node.id],delete this.legacy_missingNodeRetryMap[d.node.id],(d.previousId||d.nextId)&&this.legacy_resolveMissingNode(e,r,c,d)}if(l){let{node:c,mutation:d}=l;r.insertBefore(c,i.nextSibling),delete e[d.node.id],delete this.legacy_missingNodeRetryMap[d.node.id],(d.previousId||d.nextId)&&this.legacy_resolveMissingNode(e,r,c,d)}}moveAndHover(e,r,i,n,s){let o=this.mirror.getNode(i);if(!o)return this.debugNodeNotFound(s,i);let a=Lt(o,this.iframe),l=e*a.absoluteScale+a.x,c=r*a.absoluteScale+a.y;this.mouse.style.left=`${l}px`,this.mouse.style.top=`${c}px`,n||this.drawMouseTail({x:l,y:c}),this.hoverElements(o)}drawMouseTail(e){if(!this.mouseTail)return;let{lineCap:r,lineWidth:i,strokeStyle:n,duration:s}=this.config.mouseTail===!0?ci:Object.assign({},ci,this.config.mouseTail),o=()=>{if(!this.mouseTail)return;let a=this.mouseTail.getContext("2d");!a||!this.tailPositions.length||(a.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),a.beginPath(),a.lineWidth=i,a.lineCap=r,a.strokeStyle=n,a.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(l=>a.lineTo(l.x,l.y)),a.stroke())};this.tailPositions.push(e),o(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(a=>a!==e),o()},s/this.speedService.state.context.timer.speed)}hoverElements(e){var r;(r=this.lastHoveredRootNode||this.iframe.contentDocument)===null||r===void 0||r.querySelectorAll(".\\:hover").forEach(n=>{n.classList.remove(":hover")}),this.lastHoveredRootNode=e.getRootNode();let i=e;for(;i;)i.classList&&i.classList.add(":hover"),i=i.parentElement}isUserInteraction(e){return e.type!==R.IncrementalSnapshot?!1:e.data.source>N.Mutation&&e.data.source<=N.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(z.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(e,r){this.warn(`Node with id '${r}' not found. `,e)}warnCanvasMutationFailed(e,r){this.warn("Has error on canvas update",r,"canvas mutation:",e)}debugNodeNotFound(e,r){this.debug(`Node with id '${r}' not found. `,e)}warn(...e){this.config.showWarning&&this.config.logger.warn(Wn,...e)}debug(...e){this.config.showDebug&&this.config.logger.log(Wn,...e)}};export{R as EventType,N as IncrementalSource,J as MouseInteractions,ir as PLUGIN_NAME,ti as RRWebPluginCanvasWebRTCRecord,ui as Replayer,z as ReplayerEvents,Js as addCustomEvent,$s as freezePage,So as getRecordConsolePlugin,wo as getRecordSequentialIdPlugin,Eo as getReplayConsolePlugin,No as getReplaySequentialIdPlugin,Dt as mirror,mo as pack,We as record,go as unpack,wi as utils};
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
